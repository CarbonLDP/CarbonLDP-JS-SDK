{"version":3,"sources":["SPARQL/QueryDocument/QueryDocumentDocument.ts"],"names":[],"mappings":"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","file":"QueryDocumentDocument.js","sourcesContent":["import {\n\tBindToken,\n\tConstructToken,\n\tIRIToken,\n\tOptionalToken,\n\tPatternToken,\n\tPredicateToken,\n\tQueryToken,\n\tSelectToken,\n\tSubjectToken,\n\tValuesToken,\n\tVariableToken,\n} from \"sparqler/tokens\";\nimport { ModelDecorator } from \"../../core\";\nimport { Document } from \"../../Document\";\nimport { BasePersistedDocument } from \"../../Document/BasePersistedDocument\";\nimport { CRUDDocument } from \"../../Document/CRUDDocument\";\nimport {\n\tIllegalActionError,\n\tIllegalArgumentError,\n\tIllegalStateError\n} from \"../../Errors\";\nimport { FreeResources } from \"../../FreeResources\";\nimport {\n\tRequestOptions,\n\tRequestUtils\n} from \"../../HTTP\";\nimport {\n\tJSONLDCompacter,\n\tJSONLDParser\n} from \"../../JSONLD\";\nimport {\n\tDocumentMetadata,\n\tResponseMetadata\n} from \"../../LDP\";\nimport { Pointer } from \"../../Pointer\";\nimport {\n\tRDFDocument,\n\tRDFNode,\n\tURI\n} from \"../../RDF\";\nimport { DocumentsRegistry } from \"../../Registry\";\nimport { PersistedResource } from \"../../Resource\";\nimport {\n\tisBoolean,\n\tisDate,\n\tisFunction,\n\tisNumber,\n\tisObject,\n\tisString,\n\tPickSelfProps,\n\tpromiseMethod\n} from \"../../Utils\";\nimport {\n\tC,\n\tLDP\n} from \"../../Vocabularies\";\nimport { SPARQLService } from \"../Service\";\nimport { PartialMetadata } from \"./PartialMetadata\";\nimport { QueryContext } from \"./QueryContext\";\nimport { QueryContextBuilder } from \"./QueryContextBuilder\";\nimport { QueryContextPartial } from \"./QueryContextPartial\";\nimport { QueryDocumentBuilder } from \"./QueryDocumentBuilder\";\nimport { QueryDocumentsBuilder } from \"./QueryDocumentsBuilder\";\nimport { QueryMetadata } from \"./QueryMetadata\";\nimport {\n\tQueryProperty,\n\tQueryPropertyType\n} from \"./QueryProperty\";\nimport {\n\tareDifferentType,\n\tcreateAllPattern,\n\tcreatePropertyPatterns,\n\tcreateTypesPattern,\n\tgetAllTriples,\n\tgetPathProperty\n} from \"./Utils\";\n\n\nexport interface QueryDocumentDocument extends BasePersistedDocument {\n\tget<T extends object>( queryBuilderFn:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & Document>;\n\tget<T extends object>( requestOptions:RequestOptions, queryBuilderFn:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & Document>;\n\tget<T extends object>( uri:string, queryBuilderFn:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & Document>;\n\tget<T extends object>( uri:string, requestOptions:RequestOptions, queryBuilderFn:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & Document>;\n\n\tresolve<T extends object>( queryBuilderFn:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & Document>;\n\tresolve<T extends object>( requestOptions:RequestOptions, queryBuilderFn:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & Document>;\n\n\n\trefresh<T extends object>( requestOptions?:RequestOptions ):Promise<T & this & Document>;\n\n\tsave<T extends object>( requestOptions?:RequestOptions ):Promise<T & this & Document>;\n\n\tsaveAndRefresh<T extends object>( requestOptions?:RequestOptions ):Promise<T & this & Document>;\n\n\n\tgetChildren<T extends object>( requestOptions:RequestOptions, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\tgetChildren<T extends object>( queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\tgetChildren<T extends object>( uri:string, requestOptions:RequestOptions, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\tgetChildren<T extends object>( uri:string, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\n\tgetMembers<T extends object>( requestOptions:RequestOptions, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\tgetMembers<T extends object>( queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\tgetMembers<T extends object>( uri:string, requestOptions:RequestOptions, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\tgetMembers<T extends object>( uri:string, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\n\n\tlistChildren<T extends object>( requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\tlistChildren<T extends object>( uri:string, requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\n\tlistMembers<T extends object>( requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\tlistMembers<T extends object>( uri:string, requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n}\n\n\ntype QueryBuilderFn = Function & (( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder);\n\nconst emptyQueryBuildFn:QueryBuilderFn = _ => _;\n\n\nfunction getRegistry( repository:QueryDocumentDocument ):DocumentsRegistry {\n\tif( repository._registry ) return repository._registry;\n\tthrow new IllegalActionError( `\"${ repository.id }\" doesn't support Querying requests.` );\n}\n\n\nfunction executePatterns<T extends object>( registry:DocumentsRegistry, url:string, requestOptions:RequestOptions, queryContext:QueryContext, targetName:string, constructPatterns:PatternToken[], target?:T & QueryDocumentDocument ):Promise<(T & QueryDocumentDocument)[]> {\n\tconst metadataVar:VariableToken = queryContext.getVariable( \"metadata\" );\n\tconst construct:ConstructToken = new ConstructToken()\n\t\t.addTriple( new SubjectToken( metadataVar )\n\t\t\t.addPredicate( new PredicateToken( \"a\" )\n\t\t\t\t.addObject( queryContext.compactIRI( C.VolatileResource ) )\n\t\t\t\t.addObject( queryContext.compactIRI( C.QueryMetadata ) )\n\t\t\t)\n\t\t\t.addPredicate( new PredicateToken( queryContext.compactIRI( C.target ) )\n\t\t\t\t.addObject( queryContext.getVariable( targetName ) )\n\t\t\t)\n\t\t)\n\t\t.addPattern( new BindToken( \"BNODE()\", metadataVar ) )\n\t\t.addPattern( ...constructPatterns );\n\n\tconst query:QueryToken = new QueryToken( construct )\n\t\t.addPrologues( ...queryContext.getPrologues() );\n\n\tconst triples:SubjectToken[] = getAllTriples( constructPatterns );\n\tconstruct.addTriple( ...triples );\n\n\tRequestUtils.setRetrievalPreferences( { include: [ C.PreferResultsContext ] }, requestOptions );\n\tregistry._context.auth.addAuthentication( requestOptions );\n\n\treturn SPARQLService\n\t\t.executeRawCONSTRUCTQuery( url, query.toString(), requestOptions )\n\t\t.then( ( [ strConstruct ] ) => strConstruct )\n\t\t.then( ( jsonldString ) => {\n\t\t\treturn new JSONLDParser().parse( jsonldString );\n\t\t} )\n\t\t.then<(T & QueryDocumentDocument)[]>( ( rdfNodes:RDFNode[] ) => {\n\t\t\tconst freeNodes:RDFNode[] = RDFNode.getFreeNodes( rdfNodes );\n\t\t\tconst freeResources:FreeResources = registry._parseFreeNodes( freeNodes );\n\n\t\t\tconst targetSet:Set<string> = new Set( freeResources\n\t\t\t\t.getPointers()\n\t\t\t\t.filter( QueryMetadata.is )\n\t\t\t\t.map( x => x.target || x[ C.target ] )\n\t\t\t\t// Alternative to flatMap\n\t\t\t\t.reduce( ( targets, currentTargets ) => targets.concat( currentTargets ), [] )\n\t\t\t\t.map( x => x.id )\n\t\t\t);\n\n\t\t\tconst targetETag:string | undefined = target && target._eTag;\n\t\t\tif( target ) target._eTag = void 0;\n\n\t\t\tfreeResources\n\t\t\t\t.getPointers()\n\t\t\t\t.filter( ResponseMetadata.is )\n\t\t\t\t.map<DocumentMetadata[] | DocumentMetadata>( responseMetadata => responseMetadata.documentsMetadata || responseMetadata[ C.documentMetadata ] )\n\t\t\t\t.map<DocumentMetadata[]>( documentsMetadata => Array.isArray( documentsMetadata ) ? documentsMetadata : [ documentsMetadata ] )\n\t\t\t\t.forEach( documentsMetadata => documentsMetadata.forEach( documentMetadata => {\n\t\t\t\t\tif( ! documentMetadata ) return;\n\n\t\t\t\t\tconst relatedDocument:QueryDocumentDocument = documentMetadata.relatedDocument || documentMetadata[ C.relatedDocument ];\n\t\t\t\t\tconst eTag:string = documentMetadata.eTag || documentMetadata[ C.eTag ];\n\n\t\t\t\t\tif( ! eTag ) return;\n\t\t\t\t\trelatedDocument._resolved = true;\n\n\t\t\t\t\tif( relatedDocument._eTag === void 0 ) relatedDocument._eTag = eTag;\n\t\t\t\t\tif( relatedDocument._eTag !== eTag ) relatedDocument._eTag = null;\n\t\t\t\t} ) );\n\n\t\t\tif( targetETag && targetETag === target._eTag )\n\t\t\t\treturn [ target ];\n\n\t\t\tconst rdfDocuments:RDFDocument[] = rdfNodes\n\t\t\t\t.filter<any>( RDFDocument.is );\n\n\t\t\tconst targetDocuments:RDFDocument[] = rdfDocuments\n\t\t\t\t.filter( x => targetSet.has( x[ \"@id\" ] ) );\n\n\t\t\treturn new JSONLDCompacter( registry, targetName, queryContext )\n\t\t\t\t.compactDocuments<T & QueryDocumentDocument>( rdfDocuments, targetDocuments );\n\t\t} )\n\t\t.catch( registry._parseErrorFromResponse.bind( this ) )\n\t\t;\n}\n\nfunction executeBuilder<T extends object>( registry:DocumentsRegistry, url:string, requestOptions:RequestOptions, queryContext:QueryContextBuilder, targetProperty:QueryProperty, queryBuilderFn?:QueryBuilderFn, target?:T & QueryDocumentDocument ):Promise<(T & QueryDocumentDocument)[]> {\n\tconst Builder:typeof QueryDocumentBuilder = targetProperty.name === \"document\" ?\n\t\tQueryDocumentBuilder : QueryDocumentsBuilder;\n\tconst queryBuilder:QueryDocumentBuilder | QueryDocumentBuilder = new Builder( queryContext, targetProperty );\n\n\ttargetProperty.setType( queryBuilderFn ?\n\t\tqueryBuilderFn === emptyQueryBuildFn ?\n\t\t\tQueryPropertyType.EMPTY :\n\t\t\tQueryPropertyType.PARTIAL :\n\t\tQueryPropertyType.FULL\n\t);\n\n\tif( queryBuilderFn && queryBuilderFn.call( void 0, queryBuilder ) !== queryBuilder )\n\t\tthrow new IllegalArgumentError( \"The provided query builder was not returned\" );\n\n\tconst constructPatterns:PatternToken[] = targetProperty.getPatterns();\n\treturn executePatterns<T>( registry, url, requestOptions, queryContext, targetProperty.name, constructPatterns, target )\n\t\t.then( ( documents ) => {\n\t\t\tif( ! (queryBuilder instanceof QueryDocumentsBuilder && queryBuilder._orderData) )\n\t\t\t\treturn documents;\n\n\t\t\tconst { path, flow } = queryBuilder._orderData;\n\t\t\tconst inverter:number = flow === \"DESC\" ? - 1 : 1;\n\n\t\t\treturn documents.sort( ( a:any, b:any ) => {\n\t\t\t\ta = getPathProperty( a, path );\n\t\t\t\tb = getPathProperty( b, path );\n\n\t\t\t\tconst aValue:any = Pointer.is( a ) ? a.id : a;\n\t\t\t\tconst bValue:any = Pointer.is( b ) ? b.id : b;\n\n\t\t\t\tif( aValue === bValue ) return 0;\n\n\t\t\t\tif( aValue === void 0 ) return - 1 * inverter;\n\t\t\t\tif( bValue === void 0 ) return inverter;\n\n\t\t\t\tif( ! areDifferentType( a, b ) ) {\n\t\t\t\t\tif( Pointer.is( a ) ) {\n\t\t\t\t\t\tconst aIsBNode:boolean = URI.isBNodeID( aValue );\n\t\t\t\t\t\tconst bIsBNode:boolean = URI.isBNodeID( bValue );\n\n\t\t\t\t\t\tif( aIsBNode && ! bIsBNode ) return - 1 * inverter;\n\t\t\t\t\t\tif( bIsBNode && ! aIsBNode ) return inverter;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif( Pointer.is( a ) ) return - 1 * inverter;\n\t\t\t\t\tif( Pointer.is( b ) ) return inverter;\n\n\t\t\t\t\tif( isNumber( a ) ) return - 1 * inverter;\n\t\t\t\t\tif( isNumber( b ) ) return inverter;\n\n\t\t\t\t\tif( isDate( a ) ) return - 1 * inverter;\n\t\t\t\t\tif( isDate( b ) ) return inverter;\n\n\t\t\t\t\tif( isBoolean( a ) ) return - 1 * inverter;\n\t\t\t\t\tif( isBoolean( b ) ) return inverter;\n\n\t\t\t\t\tif( isString( a ) ) return - 1 * inverter;\n\t\t\t\t\tif( isString( b ) ) return inverter;\n\t\t\t\t}\n\n\t\t\t\tif( aValue < bValue ) return - 1 * inverter;\n\t\t\t\tif( aValue > bValue ) return inverter;\n\t\t\t} );\n\t\t} )\n\t\t;\n}\n\n\nfunction addRefreshPatterns( queryContext:QueryContextPartial, parentAdder:OptionalToken, resource:PersistedResource, parentName:string ):void {\n\tif( resource._partialMetadata.schema === PartialMetadata.ALL ) {\n\t\tparentAdder.addPattern( createAllPattern( queryContext, parentName ) );\n\t\treturn;\n\t}\n\n\tparentAdder.addPattern( createTypesPattern( queryContext, parentName ) );\n\n\tresource._partialMetadata.schema.properties.forEach( ( digestedProperty, propertyName ) => {\n\t\tconst path:string = `${ parentName }.${ propertyName }`;\n\n\t\tconst propertyPattern:OptionalToken = new OptionalToken()\n\t\t\t.addPattern( ...createPropertyPatterns(\n\t\t\t\tqueryContext,\n\t\t\t\tparentName,\n\t\t\t\tpath,\n\t\t\t\tdigestedProperty\n\t\t\t) );\n\t\tparentAdder.addPattern( propertyPattern );\n\n\t\tconst propertyValues:any[] = Array.isArray( resource[ propertyName ] ) ? resource[ propertyName ] : [ resource[ propertyName ] ];\n\t\tconst propertyFragment:PersistedResource = propertyValues\n\t\t\t.filter( PersistedResource.is )\n\t\t\t.find( fragment => fragment.isPartial() );\n\t\tif( ! propertyFragment ) return;\n\n\t\taddRefreshPatterns( queryContext, propertyPattern, propertyFragment, path );\n\t} );\n}\n\nfunction getPartial<T extends object>( registry:DocumentsRegistry, uri:string, requestOptions:RequestOptions, queryBuilderFn?:QueryBuilderFn ):Promise<T & QueryDocumentDocument> {\n\tconst queryContext:QueryContextBuilder = new QueryContextBuilder( registry._context );\n\n\tconst documentProperty:QueryProperty = queryContext\n\t\t.addProperty( \"document\" )\n\t\t.setOptional( false );\n\n\tconst propertyValue:ValuesToken = new ValuesToken().addValues( documentProperty.variable, queryContext.compactIRI( uri ) );\n\tdocumentProperty.addPattern( propertyValue );\n\n\tRequestUtils.setRetrievalPreferences( { include: [ C.PreferDocumentETags ] }, requestOptions );\n\n\tconst target:(T & Document) | undefined = registry.hasPointer( uri ) ?\n\t\tregistry.getPointer( uri ) as T & Document :\n\t\tvoid 0;\n\n\treturn executeBuilder<T>( registry, uri, requestOptions, queryContext, documentProperty, queryBuilderFn, target )\n\t\t.then( ( documents ) => documents[ 0 ] );\n}\n\nfunction refreshPartial<T extends object>( registry:DocumentsRegistry, resource:QueryDocumentDocument, requestOptions:RequestOptions ):Promise<T & QueryDocumentDocument> {\n\tconst url:string = RequestUtils.getRequestURLFor( registry, resource );\n\tconst queryContext:QueryContextPartial = new QueryContextPartial( resource, registry._context );\n\n\tconst targetName:string = \"document\";\n\tconst constructPatterns:OptionalToken = new OptionalToken()\n\t\t.addPattern( new ValuesToken()\n\t\t\t.addValues( queryContext.getVariable( targetName ), new IRIToken( url ) )\n\t\t)\n\t;\n\n\taddRefreshPatterns( queryContext, constructPatterns, resource, targetName );\n\n\tRequestUtils.setRetrievalPreferences( { include: [ C.PreferDocumentETags ] }, requestOptions );\n\n\treturn executePatterns<T>( registry, url, requestOptions, queryContext, targetName, constructPatterns.patterns, resource as any )\n\t\t.then( ( documents ) => documents[ 0 ] );\n}\n\n\nfunction executeChildrenBuilder<T extends object>( this:void, repository:QueryDocumentDocument, uri:string | undefined, requestOptions:RequestOptions, queryBuilderFn?:QueryBuilderFn ):Promise<(T & Document)[]> {\n\treturn promiseMethod( () => {\n\t\tconst registry:DocumentsRegistry = getRegistry( repository );\n\t\tconst url:string = RequestUtils.getRequestURLFor( registry, repository, uri );\n\n\t\tconst queryContext:QueryContextBuilder = new QueryContextBuilder( registry._context );\n\t\tconst childrenProperty:QueryProperty = queryContext\n\t\t\t.addProperty( \"child\" )\n\t\t\t.setOptional( false );\n\n\t\tconst selectChildren:SelectToken = new SelectToken( \"DISTINCT\" )\n\t\t\t.addVariable( childrenProperty.variable )\n\t\t\t.addPattern( new SubjectToken( queryContext.compactIRI( url ) )\n\t\t\t\t.addPredicate( new PredicateToken( queryContext.compactIRI( LDP.contains ) )\n\t\t\t\t\t.addObject( childrenProperty.variable )\n\t\t\t\t)\n\t\t\t)\n\t\t;\n\t\tchildrenProperty.addPattern( selectChildren );\n\n\t\treturn executeBuilder<T & Document>( registry, url, requestOptions, queryContext, childrenProperty, queryBuilderFn );\n\t} );\n}\n\nfunction executeMembersBuilder<T extends object>( this:void, repository:QueryDocumentDocument, uri:string | undefined, requestOptions:RequestOptions, queryBuilderFn?:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<(T & Document)[]> {\n\treturn promiseMethod( () => {\n\t\tconst registry:DocumentsRegistry = getRegistry( repository );\n\t\tconst url:string = RequestUtils.getRequestURLFor( registry, repository, uri );\n\n\t\tconst queryContext:QueryContextBuilder = new QueryContextBuilder( registry._context );\n\t\tconst membersProperty:QueryProperty = queryContext\n\t\t\t.addProperty( \"member\" )\n\t\t\t.setOptional( false );\n\n\t\tconst membershipResource:VariableToken = queryContext.getVariable( \"membershipResource\" );\n\t\tconst hasMemberRelation:VariableToken = queryContext.getVariable( \"hasMemberRelation\" );\n\t\tconst selectMembers:SelectToken = new SelectToken( \"DISTINCT\" )\n\t\t\t.addVariable( membersProperty.variable )\n\t\t\t.addPattern( new SubjectToken( queryContext.compactIRI( url ) )\n\t\t\t\t.addPredicate( new PredicateToken( queryContext.compactIRI( LDP.membershipResource ) )\n\t\t\t\t\t.addObject( membershipResource )\n\t\t\t\t)\n\t\t\t\t.addPredicate( new PredicateToken( queryContext.compactIRI( LDP.hasMemberRelation ) )\n\t\t\t\t\t.addObject( hasMemberRelation )\n\t\t\t\t)\n\t\t\t)\n\t\t\t.addPattern( new SubjectToken( membershipResource )\n\t\t\t\t.addPredicate( new PredicateToken( hasMemberRelation )\n\t\t\t\t\t.addObject( membersProperty.variable )\n\t\t\t\t)\n\t\t\t)\n\t\t;\n\t\tmembersProperty.addPattern( selectMembers );\n\n\t\treturn executeBuilder<T & Document>( registry, url, requestOptions, queryContext, membersProperty, queryBuilderFn );\n\t} );\n}\n\n\nconst PROTOTYPE:PickSelfProps<QueryDocumentDocument, BasePersistedDocument> = {\n\tget<T extends object>( this:QueryDocumentDocument, uriOrOptionsOrQueryBuilderFn:string | RequestOptions | QueryBuilderFn, optionsOrQueryBuilderFn?:RequestOptions | QueryBuilderFn, queryBuilderFn?:QueryBuilderFn ):Promise<T & Document> {\n\t\treturn promiseMethod( () => {\n\t\t\tconst registry:DocumentsRegistry = getRegistry( this );\n\n\t\t\tconst uri:string | undefined = isString( uriOrOptionsOrQueryBuilderFn ) ? uriOrOptionsOrQueryBuilderFn : void 0;\n\t\t\tconst url:string = RequestUtils.getRequestURLFor( registry, this, uri );\n\n\t\t\tconst requestOptions:RequestOptions = isObject( uriOrOptionsOrQueryBuilderFn ) ?\n\t\t\t\turiOrOptionsOrQueryBuilderFn : isObject( optionsOrQueryBuilderFn ) ? optionsOrQueryBuilderFn : {};\n\n\t\t\tqueryBuilderFn = isFunction( uriOrOptionsOrQueryBuilderFn ) ? uriOrOptionsOrQueryBuilderFn :\n\t\t\t\tisFunction( optionsOrQueryBuilderFn ) ? optionsOrQueryBuilderFn : queryBuilderFn;\n\n\t\t\treturn getPartial<T & Document>( registry, url, requestOptions, queryBuilderFn );\n\t\t} );\n\t},\n\n\tresolve<T extends object>( this:QueryDocumentDocument, optionsOrQueryBuilderFn:RequestOptions | QueryBuilderFn, queryBuilderFn?:QueryBuilderFn ):Promise<T & Document> {\n\t\treturn promiseMethod( () => {\n\t\t\tconst registry:DocumentsRegistry = getRegistry( this );\n\t\t\tconst url:string = RequestUtils.getRequestURLFor( registry, this );\n\n\t\t\tconst requestOptions:RequestOptions = isObject( optionsOrQueryBuilderFn ) ? optionsOrQueryBuilderFn : {};\n\t\t\tif( isFunction( optionsOrQueryBuilderFn ) ) queryBuilderFn = optionsOrQueryBuilderFn;\n\n\t\t\treturn getPartial<T & Document>( registry, url, requestOptions, _ => {\n\t\t\t\tif( \"types\" in this ) this.types.forEach( type => _.withType( type ) );\n\t\t\t\treturn queryBuilderFn.call( void 0, _ );\n\t\t\t} );\n\t\t} );\n\t},\n\n\n\trefresh<T extends object>( this:T & Document, requestOptions:RequestOptions = {} ):Promise<T & Document> {\n\t\treturn promiseMethod( () => {\n\t\t\tconst registry:DocumentsRegistry = getRegistry( this );\n\t\t\tif( ! this.isPartial() ) throw new IllegalArgumentError( `\"${ this.id }\" isn't a partial resource.` );\n\n\t\t\treturn refreshPartial<T & Document>( registry, this, requestOptions );\n\t\t} );\n\t},\n\n\tsave<T extends object>( this:QueryDocumentDocument, requestOptions:RequestOptions = {} ):Promise<T & Document> {\n\t\tgetRegistry( this );\n\t\tif( this.isOutdated() ) return Promise.reject( new IllegalStateError( `\"${ this.id }\" is outdated and cannot be saved.` ) );\n\n\t\treturn CRUDDocument.PROTOTYPE.save.call( this, requestOptions );\n\t},\n\n\tsaveAndRefresh<T extends object>( this:QueryDocumentDocument, requestOptions:RequestOptions = {} ):Promise<T & Document> {\n\t\treturn promiseMethod( () => {\n\t\t\tconst registry:DocumentsRegistry = getRegistry( this );\n\n\t\t\tif( ! this.isPartial() ) throw new IllegalArgumentError( `\"${ this.id }\" isn't a valid partial resource.` );\n\n\t\t\tif( ! this.isDirty() ) return refreshPartial<T & Document>( registry, this, requestOptions );\n\n\t\t\tconst cloneOptions:RequestOptions = RequestUtils.cloneOptions( requestOptions );\n\t\t\treturn this.save<T & Document>( cloneOptions )\n\t\t\t\t.then<T & Document>( doc => {\n\t\t\t\t\treturn refreshPartial( registry, doc, requestOptions );\n\t\t\t\t} );\n\t\t} );\n\t},\n\n\n\tgetChildren<T extends object>( this:QueryDocumentDocument, uriOrQueryBuilderFnOrOptions:string | QueryBuilderFn | RequestOptions, queryBuilderFnOrOptions?:QueryBuilderFn | RequestOptions, queryBuilderFn?:QueryBuilderFn ):Promise<(T & Document)[]> {\n\t\tconst iri:string | undefined = isString( uriOrQueryBuilderFnOrOptions ) ? uriOrQueryBuilderFnOrOptions : void 0;\n\n\t\tconst requestOptions:RequestOptions = isObject( uriOrQueryBuilderFnOrOptions ) ? uriOrQueryBuilderFnOrOptions :\n\t\t\tisObject( queryBuilderFnOrOptions ) ? queryBuilderFnOrOptions : {};\n\n\t\tqueryBuilderFn = isFunction( uriOrQueryBuilderFnOrOptions ) ? uriOrQueryBuilderFnOrOptions :\n\t\t\tisFunction( queryBuilderFnOrOptions ) ? queryBuilderFnOrOptions : queryBuilderFn;\n\n\t\tRequestUtils.setRetrievalPreferences( { include: [ C.PreferDocumentETags ] }, requestOptions );\n\n\t\treturn executeChildrenBuilder( this, iri, requestOptions, queryBuilderFn );\n\t},\n\n\tgetMembers<T extends object>( this:QueryDocumentDocument, uriOrQueryBuilderFnOrOptions:string | QueryBuilderFn | RequestOptions, queryBuilderFnOrOptions?:QueryBuilderFn | RequestOptions, queryBuilderFn?:QueryBuilderFn ):Promise<(T & Document)[]> {\n\t\tconst iri:string | undefined = isString( uriOrQueryBuilderFnOrOptions ) ? uriOrQueryBuilderFnOrOptions : void 0;\n\n\t\tconst requestOptions:RequestOptions = isObject( uriOrQueryBuilderFnOrOptions ) ? uriOrQueryBuilderFnOrOptions :\n\t\t\tisObject( queryBuilderFnOrOptions ) ? queryBuilderFnOrOptions : {};\n\n\t\tqueryBuilderFn = isFunction( uriOrQueryBuilderFnOrOptions ) ? uriOrQueryBuilderFnOrOptions :\n\t\t\tisFunction( queryBuilderFnOrOptions ) ? queryBuilderFnOrOptions : queryBuilderFn;\n\n\t\tRequestUtils.setRetrievalPreferences( { include: [ C.PreferDocumentETags ] }, requestOptions );\n\n\t\treturn executeMembersBuilder( this, iri, requestOptions, queryBuilderFn );\n\t},\n\n\n\tlistChildren<T extends object>( this:QueryDocumentDocument, uriOrOptions:string | RequestOptions, requestOptions?:RequestOptions ):Promise<(T & Document)[]> {\n\t\tconst uri:string | undefined = isString( uriOrOptions ) ? uriOrOptions : void 0;\n\n\t\trequestOptions = isObject( uriOrOptions ) ? uriOrOptions :\n\t\t\trequestOptions ? requestOptions : {};\n\n\t\treturn executeChildrenBuilder( this, uri, requestOptions, emptyQueryBuildFn );\n\t},\n\n\tlistMembers<T extends object>( this:QueryDocumentDocument, uriOrOptions:string | RequestOptions, requestOptions?:RequestOptions ):Promise<(T & Document)[]> {\n\t\tconst uri:string | undefined = isString( uriOrOptions ) ? uriOrOptions : void 0;\n\n\t\trequestOptions = isObject( uriOrOptions ) ? uriOrOptions :\n\t\t\trequestOptions ? requestOptions : {};\n\n\t\treturn executeMembersBuilder( this, uri, requestOptions, emptyQueryBuildFn );\n\t},\n};\n\nexport interface QueryDocumentDocumentFactory {\n\tPROTOTYPE:PickSelfProps<QueryDocumentDocument, BasePersistedDocument>;\n\n\tisDecorated( object:object ):object is QueryDocumentDocument;\n\n\tdecorate<T extends object>( object:T ):T & QueryDocumentDocument;\n}\n\nexport const QueryDocumentDocument:QueryDocumentDocumentFactory = {\n\tPROTOTYPE,\n\n\tisDecorated( object:object ):object is QueryDocumentDocument {\n\t\treturn isObject( object )\n\t\t\t&& ModelDecorator\n\t\t\t\t.hasPropertiesFrom( PROTOTYPE, object )\n\t\t\t;\n\t},\n\n\tdecorate<T extends object>( object:T ):T & QueryDocumentDocument {\n\t\tif( QueryDocumentDocument.isDecorated( object ) ) return object;\n\n\t\tconst resource:T & BasePersistedDocument = ModelDecorator\n\t\t\t.decorateMultiple( object, BasePersistedDocument );\n\n\t\treturn ModelDecorator.definePropertiesFrom( PROTOTYPE, resource );\n\t},\n};\n"]}