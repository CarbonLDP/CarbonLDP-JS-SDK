{"version":3,"sources":["SPARQL/QueryDocument/QueryDocumentsBuilder.ts"],"names":[],"mappings":"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","file":"QueryDocumentsBuilder.js","sourcesContent":["import { LimitToken, OffsetToken, OptionalToken, OrderToken, PatternToken, SelectToken } from \"sparqler/tokens\";\n\nimport * as QueryDocumentBuilder from \"./QueryDocumentBuilder\";\nimport * as QueryProperty from \"./QueryProperty\";\nimport { getLevelRegExp } from \"./Utils\";\n\nexport class Class extends QueryDocumentBuilder.Class {\n\n\torderBy( property:QueryProperty.Class ):this {\n\t\treturn this._orderBy( property );\n\t}\n\n\torderAscendantBy( property:QueryProperty.Class ):this {\n\t\treturn this._orderBy( property, \"ASC\" );\n\t}\n\n\torderDescendantBy( property:QueryProperty.Class ):this {\n\t\treturn this._orderBy( property, \"DESC\" );\n\t}\n\n\tlimit( limit:number ):this {\n\t\tconst select:SelectToken = this._document.getPatterns().find( pattern => pattern.token === \"select\" ) as SelectToken;\n\t\tif( ! select ) throw new Error( `A sub-select token has not been defined.` );\n\n\t\tconst limitIndex:number = select.modifiers.findIndex( pattern => pattern.token === \"limit\" );\n\t\tif( limitIndex !== - 1 ) select.modifiers.splice( limitIndex, 1 );\n\n\t\tselect.modifiers.push( new LimitToken( limit ) );\n\n\t\treturn this;\n\t}\n\n\toffset( offset:number ):this {\n\t\tconst select:SelectToken = this._document.getPatterns().find( pattern => pattern.token === \"select\" ) as SelectToken;\n\t\tif( ! select ) throw new Error( `A sub-select token has not been defined.` );\n\n\t\tconst offsetIndex:number = select.modifiers.findIndex( pattern => pattern.token === \"offset\" );\n\t\tif( offsetIndex !== - 1 ) select.modifiers.splice( offsetIndex, 1 );\n\n\t\tselect.modifiers.push( new OffsetToken( offset ) );\n\t\treturn this;\n\t}\n\n\tprivate _orderBy( property:QueryProperty.Class, flow?:\"ASC\" | \"DESC\" ):this {\n\t\tconst levelRegex:RegExp = getLevelRegExp( this._document.name );\n\t\tif( ! levelRegex.test( property.name ) ) throw new Error( `Property \"${ property.name }\" isn't a direct property of a member.` );\n\n\t\tconst select:SelectToken = this._document.getPatterns().find( pattern => pattern.token === \"select\" ) as SelectToken;\n\t\tif( ! select ) throw new Error( `A sub-select token has not been defined.` );\n\n\t\tconst orderIndex:number = select.modifiers.findIndex( pattern => pattern.token === \"order\" );\n\n\t\tif( orderIndex !== - 1 ) {\n\t\t\tselect.modifiers.splice( orderIndex, 1 );\n\n\t\t\tconst optionalIndex:number = select.patterns.findIndex( pattern => pattern.token === \"optional\" );\n\t\t\tselect.patterns.splice( optionalIndex, 1 );\n\t\t}\n\n\t\tselect.modifiers.unshift( new OrderToken( property.variable, flow ) );\n\n\t\tconst propertyDefinitions:OptionalToken = property.getPatterns()\n\t\t\t.find( pattern => pattern.token === \"optional\" ) as OptionalToken;\n\t\tif( ! propertyDefinitions ) throw new Error( `The property provided is not a valid property defined by the builder.` );\n\n\t\tconst propertyTriple:PatternToken = propertyDefinitions.patterns[ 0 ];\n\n\t\tselect.addPattern( new OptionalToken()\n\t\t\t.addPattern( propertyTriple )\n\t\t);\n\n\t\treturn this;\n\t}\n}\n\nexport default Class;\n\n"]}