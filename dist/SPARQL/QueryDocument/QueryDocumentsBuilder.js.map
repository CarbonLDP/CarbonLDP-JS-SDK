{"version":3,"sources":["SPARQL/QueryDocument/QueryDocumentsBuilder.ts"],"names":[],"mappings":"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","file":"QueryDocumentsBuilder.js","sourcesContent":["import { LimitToken, OffsetToken, OptionalToken, OrderToken, SelectToken, SubjectToken } from \"sparqler/tokens\";\n\nimport { IllegalArgumentError, IllegalStateError } from \"./../../Errors\";\nimport * as QueryDocumentBuilder from \"./QueryDocumentBuilder\";\nimport * as QueryProperty from \"./QueryProperty\";\n\nexport class Class extends QueryDocumentBuilder.Class {\n\n\torderBy( property:QueryProperty.Class ):this {\n\t\treturn this._orderBy( property );\n\t}\n\n\torderAscendantBy( property:QueryProperty.Class ):this {\n\t\treturn this._orderBy( property, \"ASC\" );\n\t}\n\n\torderDescendantBy( property:QueryProperty.Class ):this {\n\t\treturn this._orderBy( property, \"DESC\" );\n\t}\n\n\tlimit( limit:number ):this {\n\t\tconst select:SelectToken = this._document.getPatterns().find( pattern => pattern.token === \"select\" ) as SelectToken;\n\t\tif( ! select ) throw new IllegalStateError( `A sub-select token has not been defined.` );\n\n\t\tconst limitIndex:number = select.modifiers.findIndex( pattern => pattern.token === \"limit\" );\n\t\tif( limitIndex !== - 1 ) select.modifiers.splice( limitIndex, 1 );\n\n\t\tselect.modifiers.push( new LimitToken( limit ) );\n\n\t\treturn this;\n\t}\n\n\toffset( offset:number ):this {\n\t\tconst select:SelectToken = this._document.getPatterns().find( pattern => pattern.token === \"select\" ) as SelectToken;\n\t\tif( ! select ) throw new IllegalStateError( `A sub-select token has not been defined.` );\n\n\t\tconst offsetIndex:number = select.modifiers.findIndex( pattern => pattern.token === \"offset\" );\n\t\tif( offsetIndex !== - 1 ) select.modifiers.splice( offsetIndex, 1 );\n\n\t\tselect.modifiers.push( new OffsetToken( offset ) );\n\t\treturn this;\n\t}\n\n\tprivate _orderBy( property:QueryProperty.Class, flow?:\"ASC\" | \"DESC\" ):this {\n\t\tconst select:SelectToken = this._document.getPatterns().find( pattern => pattern.token === \"select\" ) as SelectToken;\n\t\tif( ! select ) throw new IllegalStateError( `A sub-select token has not been defined.` );\n\n\t\tconst orderIndex:number = select.modifiers.findIndex( pattern => pattern.token === \"order\" );\n\n\t\tif( orderIndex !== - 1 ) {\n\t\t\tselect.modifiers.splice( orderIndex, 1 );\n\n\t\t\tconst optionalIndex:number = select.patterns.findIndex( pattern => pattern.token === \"optional\" );\n\t\t\tselect.patterns.splice( optionalIndex, 1 );\n\t\t}\n\n\t\tselect.modifiers.unshift( new OrderToken( property.variable, flow ) );\n\n\t\tlet propertyPatternsPath:OptionalToken;\n\t\twhile( property !== this._document ) {\n\t\t\tconst propertyTriple:SubjectToken = property && property.getTriple();\n\t\t\tif( ! propertyTriple ) throw new IllegalArgumentError( `The property \"${ property.name }\" is not a valid property defined by the builder.` );\n\n\t\t\tconst propertyPattern:OptionalToken = new OptionalToken()\n\t\t\t\t.addPattern( propertyTriple );\n\n\t\t\tif( propertyPatternsPath ) propertyPattern.addPattern( propertyPatternsPath );\n\t\t\tpropertyPatternsPath = propertyPattern;\n\n\t\t\tproperty = this._context.getProperty( property.name\n\t\t\t\t.split( \".\" )\n\t\t\t\t.slice( 0, - 1 )\n\t\t\t\t.join( \".\" )\n\t\t\t);\n\t\t}\n\n\t\tselect.addPattern( propertyPatternsPath );\n\n\t\treturn this;\n\t}\n}\n\nexport default Class;\n\n"]}