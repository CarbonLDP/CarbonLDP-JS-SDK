{"version":3,"sources":["SPARQL/QueryDocument/QueryProperty.ts"],"names":[],"mappings":"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","file":"QueryProperty.js","sourcesContent":["import {\n\tOptionalToken,\n\tPatternToken,\n\tSubjectToken\n} from \"sparqler/tokens\";\n\nimport { DigestedObjectSchema } from \"../../ObjectSchema\";\nimport * as QueryContext from \"./QueryContext\";\nimport * as QueryDocumentBuilder from \"./QueryDocumentBuilder\";\nimport * as QueryVariable from \"./QueryVariable\";\nimport {\n\tcreateAllPattern,\n\tcreateGraphPattern,\n\tcreateTypesPattern\n} from \"./Utils\";\n\nexport enum PropertyType {\n\tFULL,\n\tPARTIAL,\n\tALL,\n}\n\nexport class Class {\n\treadonly name:string;\n\treadonly variable:QueryVariable.Class;\n\n\t_builder:QueryDocumentBuilder.Class;\n\n\tprivate _context:QueryContext.Class;\n\n\tprivate _optional:boolean;\n\tprivate _type?:PropertyType;\n\n\tprivate _patterns:PatternToken[];\n\tprivate _schema:DigestedObjectSchema;\n\n\tconstructor( context:QueryContext.Class, name:string ) {\n\t\tthis.name = name;\n\t\tthis.variable = context.getVariable( name );\n\n\t\tthis._optional = true;\n\n\t\tthis._context = context;\n\t\tthis._patterns = [];\n\t}\n\n\taddPattern( ...patterns:PatternToken[] ):this {\n\t\tthis._patterns.push( ...patterns );\n\t\treturn this;\n\t}\n\n\tgetPatterns():PatternToken[] {\n\t\tlet patterns:PatternToken[] = this._patterns.slice();\n\n\t\tif( this._type !== void 0 ) {\n\t\t\tconst fn:( context:QueryContext.Class, resourcePath:string ) => PatternToken =\n\t\t\t\tthis._type === PropertyType.PARTIAL ? createTypesPattern :\n\t\t\t\t\tthis._type === PropertyType.FULL ? createGraphPattern : createAllPattern;\n\n\t\t\tconst index:number = patterns.findIndex( pattern => pattern === void 0 );\n\t\t\tpatterns[ index ] = fn( this._context, this.name );\n\t\t}\n\n\t\tif( ! this._optional ) return patterns;\n\n\t\treturn [ new OptionalToken()\n\t\t\t.addPattern( ...patterns ),\n\t\t];\n\t}\n\n\tgetSchema():DigestedObjectSchema {\n\t\tif( this._schema ) return this._schema;\n\n\t\tthis._schema = new DigestedObjectSchema();\n\t\tthis._schema.vocab = this._context.expandIRI( \"\" ) || null;\n\n\t\treturn this._schema;\n\t}\n\n\tisOptional():boolean {\n\t\treturn this._optional;\n\t}\n\n\tsetOptional( optional:boolean ):this {\n\t\tthis._optional = optional;\n\t\treturn this;\n\t}\n\n\tgetType():PropertyType {\n\t\treturn this._type;\n\t}\n\n\tsetType( type:PropertyType ):this {\n\t\tif( this._type === void 0 ) this._patterns.push( void 0 );\n\t\tthis._type = type;\n\n\t\treturn this;\n\t}\n\n\tgetTriple():SubjectToken {\n\t\treturn this._patterns\n\t\t\t.find( pattern => pattern instanceof SubjectToken ) as SubjectToken;\n\t}\n\n\ttoString():string {\n\t\treturn `${ this.variable }`;\n\t}\n}\n\nexport default Class;\n"]}