{"version":3,"sources":["SPARQL/Service.ts"],"names":[],"mappings":"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","file":"Service.js","sourcesContent":["import * as Errors from \"../Errors\";\nimport {\n\tRequestOptions,\n\tRequestService,\n\tRequestUtils,\n} from \"../HTTP/Request\";\nimport { Response } from \"../HTTP/Response\";\nimport { StringParser } from \"../HTTP/StringParser\";\nimport { PointerLibrary } from \"../Pointer\";\nimport * as RDF from \"./../RDF\";\n\nimport * as RawResults from \"./RawResults\";\nimport ResultsParser from \"./RawResultsParser\";\nimport * as SELECTResults from \"./SELECTResults\";\n\n\nexport class Class {\n\tprivate static defaultOptions:RequestOptions = {};\n\tprivate static resultsParser:ResultsParser = new ResultsParser();\n\tprivate static stringParser:StringParser = new StringParser();\n\n\tstatic executeRawASKQuery( url:string, askQuery:string, options:RequestOptions = {} ):Promise<[ RawResults.Class, Response ]> {\n\t\toptions = Object.assign( options, Class.defaultOptions );\n\n\t\tRequestUtils.setAcceptHeader( \"application/sparql-results+json\", options );\n\t\tRequestUtils.setContentTypeHeader( \"application/sparql-query\", options );\n\n\t\treturn RequestService.post( url, askQuery, options, Class.resultsParser );\n\t}\n\n\tstatic executeASKQuery( url:string, askQuery:string, options:RequestOptions = {} ):Promise<[ boolean, Response ]> {\n\t\treturn Class\n\t\t\t.executeRawASKQuery( url, askQuery, options )\n\t\t\t.then<[ boolean, Response ]>( ( [ rawResults, response ]:[ RawResults.Class, Response ] ) => {\n\t\t\t\treturn [ rawResults.boolean, response ];\n\t\t\t} );\n\t}\n\n\tstatic executeRawSELECTQuery( url:string, selectQuery:string, options:RequestOptions = {} ):Promise<[ RawResults.Class, Response ]> {\n\t\toptions = Object.assign( options, Class.defaultOptions );\n\n\t\tRequestUtils.setAcceptHeader( \"application/sparql-results+json\", options );\n\t\tRequestUtils.setContentTypeHeader( \"application/sparql-query\", options );\n\n\t\treturn RequestService.post( url, selectQuery, options, Class.resultsParser );\n\t}\n\n\tstatic executeSELECTQuery<T>( url:string, selectQuery:string, pointerLibrary:PointerLibrary, options:RequestOptions = {} ):Promise<[ SELECTResults.Class<T>, Response ]> {\n\t\treturn Class\n\t\t\t.executeRawSELECTQuery( url, selectQuery, options )\n\t\t\t.then<[ SELECTResults.Class<T>, Response ]>( ( [ rawResults, response ]:[ RawResults.Class, Response ] ) => {\n\t\t\t\tlet rawBindings:RawResults.BindingObject[] = rawResults.results.bindings;\n\t\t\t\tlet bindings:T[] = [];\n\n\t\t\t\tfor( let bindingColumn of rawBindings ) {\n\t\t\t\t\tlet binding:T = {} as T;\n\t\t\t\t\tfor( let bindingRow in bindingColumn ) {\n\t\t\t\t\t\tif( ! bindingColumn.hasOwnProperty( bindingRow ) ) continue;\n\n\t\t\t\t\t\tlet bindingCell:RawResults.BindingProperty = bindingColumn[ bindingRow ];\n\t\t\t\t\t\tbinding[ bindingRow ] = Class.parseRawBindingProperty( bindingCell, pointerLibrary );\n\t\t\t\t\t}\n\t\t\t\t\tbindings.push( binding );\n\t\t\t\t}\n\n\t\t\t\tlet results:SELECTResults.Class<T> = {\n\t\t\t\t\tvars: rawResults.head.vars,\n\t\t\t\t\tbindings: bindings,\n\t\t\t\t};\n\t\t\t\treturn [ results, response ];\n\t\t\t} );\n\t}\n\n\tstatic executeRawCONSTRUCTQuery( url:string, constructQuery:string, options:RequestOptions = {} ):Promise<[ string, Response ]> {\n\t\toptions = Object.assign( options, Class.defaultOptions );\n\n\t\tif( RequestUtils.getHeader( \"Accept\", options ) === undefined ) RequestUtils.setAcceptHeader( \"application/ld+json\", options );\n\t\tRequestUtils.setContentTypeHeader( \"application/sparql-query\", options );\n\n\t\treturn RequestService.post( url, constructQuery, options, Class.stringParser );\n\t}\n\n\tstatic executeRawDESCRIBEQuery( url:string, describeQuery:string, options:RequestOptions = {} ):Promise<[ string, Response ]> {\n\t\toptions = Object.assign( options, Class.defaultOptions );\n\n\t\tif( RequestUtils.getHeader( \"Accept\", options ) === undefined ) RequestUtils.setAcceptHeader( \"application/ld+json\", options );\n\t\tRequestUtils.setContentTypeHeader( \"application/sparql-query\", options );\n\n\t\treturn RequestService.post( url, describeQuery, options, Class.stringParser );\n\t}\n\n\tstatic executeUPDATE( url:string, updateQuery:string, options:RequestOptions = {} ):Promise<Response> {\n\t\toptions = Object.assign( options, Class.defaultOptions );\n\n\t\tif( RequestUtils.getHeader( \"Accept\", options ) === undefined ) RequestUtils.setAcceptHeader( \"application/ld+json\", options );\n\t\tRequestUtils.setContentTypeHeader( \"application/sparql-update\", options );\n\n\t\treturn RequestService.post( url, updateQuery, options );\n\t}\n\n\tprivate static parseRawBindingProperty( rawBindingProperty:RawResults.BindingProperty, pointerLibrary:PointerLibrary ):any {\n\t\tswitch( rawBindingProperty.type ) {\n\t\t\tcase \"uri\":\n\t\t\t\treturn pointerLibrary.getPointer( rawBindingProperty.value );\n\t\t\tcase \"bnode\":\n\t\t\t\tthrow new Errors.NotImplementedError( \"BNodes cannot be queried directly\" );\n\t\t\tcase \"literal\":\n\t\t\t\tif( \"datatype\" in rawBindingProperty ) {\n\t\t\t\t\treturn RDF.Literal.Factory.parse( rawBindingProperty.value, rawBindingProperty.datatype );\n\t\t\t\t} else {\n\t\t\t\t\treturn RDF.Literal.Factory.parse( rawBindingProperty.value );\n\t\t\t\t}\n\t\t\tdefault:\n\t\t\t\tthrow new Errors.IllegalArgumentError( \"The bindingProperty has an unsupported type\" );\n\t\t}\n\t}\n\n}\n\nexport default Class;\n"]}