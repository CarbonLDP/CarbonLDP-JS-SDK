{"version":3,"sources":["Fragment.ts"],"names":[],"mappings":"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","file":"Fragment.js","sourcesContent":["import { TransientFragment } from \"./TransientFragment\";\nimport { ModelDecorator } from \"./core/ModelDecorator\";\nimport { ModelFactory } from \"./core/ModelFactory\";\nimport {\n\tDigestedObjectSchema,\n\tObjectSchemaUtils,\n} from \"./ObjectSchema\";\nimport { Document } from \"./Document\";\nimport { Resource } from \"./Resource\";\nimport { URI } from \"./RDF/URI\";\nimport {\n\taddTypeInResource,\n\thasTypeInResource,\n\tremoveTypeInResource,\n} from \"./Resource\";\nimport { isObject } from \"./Utils\";\n\nexport interface Fragment extends Resource, TransientFragment {\n\t_document:Document;\n\n\taddType( type:string ):void;\n\n\thasType( type:string ):boolean;\n\n\tremoveType( type:string ):void;\n}\n\n\nexport interface FragmentFactory extends ModelFactory<Fragment>, ModelDecorator<Fragment> {\n\tisDecorated( object:object ):object is Fragment;\n\n\tis( object:object ):object is Fragment;\n\n\n\tdecorate<T extends object>( object:T ):T & Fragment;\n\n\tcreate( document:Document, id?:string ):Fragment;\n\n\tcreateFrom<T extends object>( object:T, document:Document, id?:string ):T & Fragment;\n}\n\n\nfunction resolveURI( fragment:Fragment, uri:string ):string {\n\tif( URI.isAbsolute( uri ) ) return uri;\n\n\tconst schema:DigestedObjectSchema = fragment._document._documents.getGeneralSchema();\n\treturn ObjectSchemaUtils.resolveURI( uri, schema, { vocab: true } );\n}\n\nfunction addTypeInPersistedFragment( this:Fragment, type:string ):void {\n\ttype = resolveURI( this, type );\n\treturn addTypeInResource.call( this, type );\n}\n\nfunction hasTypeInPersistedFragment( this:Fragment, type:string ):void {\n\ttype = resolveURI( this, type );\n\treturn hasTypeInResource.call( this, type );\n}\n\nfunction removeTypeInPersistedFragment( this:Fragment, type:string ):void {\n\ttype = resolveURI( this, type );\n\treturn removeTypeInResource.call( this, type );\n}\n\nexport const Fragment:FragmentFactory = {\n\tisDecorated( object:object ):object is Fragment {\n\t\treturn isObject( object ) &&\n\t\t\tobject[ \"addType\" ] === addTypeInPersistedFragment &&\n\t\t\tobject[ \"hasType\" ] === hasTypeInPersistedFragment &&\n\t\t\tobject[ \"removeType\" ] === removeTypeInPersistedFragment\n\t\t\t;\n\t},\n\n\tis( object:object ):object is Fragment {\n\t\treturn TransientFragment.is( object ) &&\n\t\t\tResource.isDecorated( object ) &&\n\t\t\tFragment.isDecorated( object )\n\t\t\t;\n\t},\n\n\n\tdecorate<T extends object>( object:T ):T & Fragment {\n\t\tif( Fragment.isDecorated( object ) ) return object;\n\n\t\tTransientFragment.decorate( object );\n\t\tResource.decorate( object );\n\n\t\tconst fragment:T & Fragment = object as T & Fragment;\n\t\tObject.defineProperties( object, {\n\t\t\t\"addType\": {\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: addTypeInPersistedFragment,\n\t\t\t},\n\t\t\t\"hasType\": {\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: hasTypeInPersistedFragment,\n\t\t\t},\n\t\t\t\"removeType\": {\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: removeTypeInPersistedFragment,\n\t\t\t},\n\t\t} );\n\n\t\treturn fragment;\n\t},\n\n\tcreate( document:Document, id?:string ):Fragment {\n\t\treturn Fragment.createFrom( {}, document, id );\n\t},\n\n\tcreateFrom<T extends object>( object:T, document:Document, id?:string ):T & Fragment {\n\t\tconst fragment:T & Fragment = Fragment.decorate( object );\n\n\t\tfragment._document = document;\n\t\tif( id ) fragment.id = id;\n\n\t\treturn fragment;\n\t},\n\n};\n"]}