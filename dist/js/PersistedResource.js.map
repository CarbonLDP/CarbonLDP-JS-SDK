{"version":3,"sources":["PersistedResource.ts"],"names":[],"mappings":"AAAA,kDAAkD;;;;;;IAWlD;QACC,IAAI,QAAQ,GAAS,IAAI,CAAC;QAC1B,QAAQ,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAAE,EAAE,EAAE,QAAQ,CAAE,CAAC;IACpD,CAAC;IAED;QACC,IAAI,QAAQ,GAAS,IAAI,CAAC;QAC1B,MAAM,CAAC,CAAE,KAAK,CAAC,CAAC,CAAC,iBAAiB,CAAE,QAAQ,EAAE,QAAQ,CAAC,SAAS,CAAE,CAAC;IACpE,CAAC;;;;;;;YAED;gBAAA;gBAsCA,CAAC;gBArCO,0BAAkB,GAAzB,UAA2B,MAAa;oBACvC,MAAM,CAAC,CACN,KAAK,CAAC,kBAAkB,CAAE,MAAM,EAAE,WAAW,CAAE;wBAC/C,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,eAAe,CAAE;wBAC5C,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,SAAS,CAAE,CACtC,CAAC;gBACH,CAAC;gBAEM,gBAAQ,GAAf,UAAmC,MAAQ,EAAE,QAAoB;oBAApB,wBAAoB,GAApB,aAAoB;oBAChE,EAAE,CAAA,CAAE,OAAO,CAAC,kBAAkB,CAAE,MAAM,CAAG,CAAC;wBAAC,MAAM,CAAO,MAAM,CAAC;oBAE/D,IAAI,iBAAiB,GAAe,MAAM,CAAC;oBAE3C,MAAM,CAAC,gBAAgB,CAAE,iBAAiB,EAAE;wBAC3C,WAAW,EAAE;4BACZ,QAAQ,EAAE,IAAI;4BACd,UAAU,EAAE,KAAK;4BACjB,YAAY,EAAE,IAAI;4BAClB,KAAK,EAAE,QAAQ;yBACf;wBACD,eAAe,EAAE;4BAChB,QAAQ,EAAE,KAAK;4BACf,UAAU,EAAE,KAAK;4BACjB,YAAY,EAAE,IAAI;4BAClB,KAAK,EAAE,YAAY;yBACnB;wBAED,SAAS,EAAE;4BACV,QAAQ,EAAE,KAAK;4BACf,UAAU,EAAE,KAAK;4BACjB,YAAY,EAAE,IAAI;4BAClB,KAAK,EAAE,OAAO;yBACd;qBACD,CAAE,CAAC;oBAEJ,MAAM,CAAO,iBAAiB,CAAC;gBAChC,CAAC;gBACF,cAAC;YAAD,CAtCA,AAsCC,IAAA;YAtCD,6BAsCC,CAAA","file":"PersistedResource.js","sourcesContent":["/// <reference path=\"./../typings/typings.d.ts\" />\n\nimport * as Utils from \"./Utils\";\n\nexport interface Class {\n\t_snapshot:Object;\n\t_syncSnapshot:() => void;\n\n\tisDirty():boolean;\n}\n\nfunction syncSnapshot():void {\n\tlet resource:Class = this;\n\tresource._snapshot = Object.assign( {}, resource );\n}\n\nfunction isDirty():boolean {\n\tlet resource:Class = this;\n\treturn ! Utils.O.areShallowlyEqual( resource, resource._snapshot );\n}\n\nexport class Factory {\n\tstatic hasClassProperties( object:Object ):boolean {\n\t\treturn (\n\t\t\tUtils.hasPropertyDefined( object, \"_snapshot\" ) &&\n\t\t\tUtils.hasFunction( object, \"_syncSnapshot\" ) &&\n\t\t\tUtils.hasFunction( object, \"isDirty\" )\n\t\t);\n\t}\n\n\tstatic decorate<T extends Object>( object:T, snapshot:Object = {} ):T & Class {\n\t\tif( Factory.hasClassProperties( object ) ) return <any> object;\n\n\t\tlet persistedResource:Class = <any> object;\n\n\t\tObject.defineProperties( persistedResource, {\n\t\t\t\"_snapshot\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: snapshot,\n\t\t\t},\n\t\t\t\"_syncSnapshot\": {\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: syncSnapshot,\n\t\t\t},\n\n\t\t\t\"isDirty\": {\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: isDirty,\n\t\t\t},\n\t\t} );\n\n\t\treturn <any> persistedResource;\n\t}\n}\n\nexport default Class;\n"],"sourceRoot":"/source/"}