{"version":3,"sources":["Apps.ts"],"names":[],"mappings":"AAAA,kDAAkD;;;;;;;;;;;;;;;;;;;;;;;;YAWlD;gBAGC,cAAa,OAAe;oBAC3B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;gBACxB,CAAC;gBAED,kBAAG,GAAH,UAAK,GAAU;oBAAf,iBAcC;oBAbA,IAAI,gBAAgB,GAAU,IAAI,CAAC,mBAAmB,EAAE,CAAC;oBACzD,EAAE,CAAC,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAE,GAAG,CAAG,CAAC,CAAC,CAAC;wBACtC,EAAE,CAAC,CAAE,CAAE,KAAK,CAAC,CAAC,CAAC,UAAU,CAAE,GAAG,EAAE,gBAAgB,CAAG,CAAC;4BAAC,GAAG,GAAG,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAE,gBAAgB,EAAE,GAAG,CAAE,CAAC;wBACzG,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAE,GAAG,CAAE,CAAC;oBACnC,CAAC;oBAED,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAE,GAAG,CAAE,CAAC,IAAI,CAC5C,UAAE,EAA8D;4BAA5D,gBAAQ,EAAE,gBAAQ;wBACrB,EAAE,CAAC,CAAE,CAAE,QAAQ,CAAC,KAAK,CAAC,OAAO,CAAE,EAAE,CAAC,KAAK,CAAC,WAAW,CAAG,CAAC;4BAAC,MAAM,IAAI,KAAK,CAAE,+CAA+C,CAAE,CAAC;wBAE3H,MAAM,CAAC,IAAI,GAAG,CAAC,OAAO,CAAE,KAAI,CAAC,OAAO,EAAQ,QAAQ,CAAE,CAAC;oBACxD,CAAC,CACD,CAAC;gBACH,CAAC;gBAED,qBAAM,GAAN;oBAAA,iBAUC;oBATA,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,UAAU,CAAE,IAAI,CAAC,mBAAmB,EAAE,EAAE,KAAK,CAAE,CAAC,IAAI,CACjF,UAAE,EAA8D;4BAA5D,eAAO,EAAE,gBAAQ;wBACpB,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAE,OAAO,CAAE,CAAC;oBAC3C,CAAC,CACD,CAAC,IAAI,CACL,UAAE,EAAiE;4BAA/D,eAAO,EAAE,iBAAS;wBACrB,MAAM,CAAC,OAAO,CAAC,GAAG,CAAE,UAAE,MAAoB,IAAM,OAAA,IAAI,GAAG,CAAC,OAAO,CAAE,KAAI,CAAC,OAAO,EAAQ,MAAM,CAAE,EAA7C,CAA6C,CAAE,CAAC;oBACjG,CAAC,CACD,CAAC;gBACH,CAAC;gBAEO,kCAAmB,GAA3B;oBACC,EAAE,CAAC,CAAE,CAAE,IAAI,CAAC,OAAO,CAAC,UAAU,CAAE,yBAAyB,CAAG,CAAC;wBAAC,MAAM,IAAI,KAAK,CAAE,yCAAyC,CAAE,CAAC;oBAC3H,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAE,yBAAyB,CAAE,CAAC;gBAC7D,CAAC;gBACF,WAAC;YAAD,CAvCA,AAuCC,IAAA;YAED,oBAAe,IAAI,EAAC","file":"Apps.js","sourcesContent":["/// <reference path=\"./../typings/typings.d.ts\" />\n\nimport * as App from \"./App\";\nimport * as Document from \"./Document\";\nimport Context from \"./Context\";\nimport * as HTTP from \"./HTTP\";\nimport * as Pointer from \"./Pointer\";\nimport * as RDF from \"./RDF\";\nimport * as Utils from \"./Utils\";\nimport * as CS from \"./NS/CS\";\n\nclass Apps {\n\tprivate context:Context;\n\n\tconstructor( context:Context ) {\n\t\tthis.context = context;\n\t}\n\n\tget( uri:string ):Promise<App.Context> {\n\t\tlet appsContainerURI:string = this.getAppsContainerURI();\n\t\tif ( RDF.URI.Util.isRelative( uri ) ) {\n\t\t\tif ( ! Utils.S.startsWith( uri, appsContainerURI ) ) uri = RDF.URI.Util.resolve( appsContainerURI, uri );\n\t\t\turi = this.context.resolve( uri );\n\t\t}\n\n\t\treturn this.context.documents.get( uri ).then(\n\t\t\t( [ document, response ]:[ Document.Class, HTTP.Response.Class ] ) => {\n\t\t\t\tif ( ! document.types.indexOf( CS.Class.Application ) ) throw new Error( \"The resource fetched is not a cs:Application.\" );\n\n\t\t\t\treturn new App.Context( this.context, <any> document );\n\t\t\t}\n\t\t);\n\t}\n\n\tgetAll():Promise<App.Context[]> {\n\t\treturn this.context.documents.getMembers( this.getAppsContainerURI(), false ).then(\n\t\t\t( [ members, response ]:[ Pointer.Class[], HTTP.Response.Class ] ) => {\n\t\t\t\treturn Pointer.Util.resolveAll( members );\n\t\t\t}\n\t\t).then(\n\t\t\t( [ members, responses ]:[ Pointer.Class[], HTTP.Response.Class[] ] ) => {\n\t\t\t\treturn members.map( ( member:Pointer.Class ) => new App.Context( this.context, <any> member ) );\n\t\t\t}\n\t\t);\n\t}\n\n\tprivate getAppsContainerURI():string {\n\t\tif ( ! this.context.hasSetting( \"platform.apps.container\" ) ) throw new Error( \"The apps container URI hasn't been set.\" );\n\t\treturn this.context.getSetting( \"platform.apps.container\" );\n\t}\n}\n\nexport default Apps;\n"],"sourceRoot":"/source/"}