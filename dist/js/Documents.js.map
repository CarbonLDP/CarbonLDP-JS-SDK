{"version":3,"sources":["Documents.ts"],"names":["parse","expand","Documents","Documents.constructor","Documents.jsonldConverter","Documents.inScope","Documents.hasPointer","Documents.getPointer","Documents.get","Documents.createChild","Documents.save","Documents.delete","Documents.getRDFDocument","Documents.getPointerID","Documents.createPointer","Documents.compact","Documents.compactSingle","Documents.getExpandedObjectTypes"],"mappings":"AAAA,4CAA4C;AAE5C,IAAY,MAAM,WAAM,QAAQ,CAAC,CAAA;AAGjC,IAAY,MAAM,WAAM,UAAU,CAAC,CAAA;AACnC,IAAY,IAAI,WAAM,QAAQ,CAAC,CAAA;AAE/B,IAAY,GAAG,WAAM,OAAO,CAAC,CAAA;AAC7B,IAAY,KAAK,WAAM,SAAS,CAAC,CAAA;AAEjC,IAAY,eAAe,WAAM,mBAAmB,CAAC,CAAA;AAGrD,IAAY,eAAe,WAAM,mBAAmB,CAAC,CAAA;AACrD,IAAY,iBAAiB,WAAM,qBAAqB,CAAC,CAAA;AACzD,IAAY,OAAO,WAAM,WAAW,CAAC,CAAA;AAErC,IAAY,EAAE,WAAM,MAAM,CAAC,CAAA;AAE3B,IAAY,GAAG,WAAM,UAAU,CAAC,CAAA;AAEhC,eAAgB,KAAY;IAC3BA,IAAIA,CAACA;QACJA,MAAMA,CAACA,IAAIA,CAACA,KAAKA,CAAEA,KAAKA,CAAEA,CAACA;IAC5BA,CAAEA;IAAAA,KAAKA,CAACA,CAAEA,KAAMA,CAACA,CAACA,CAACA;QAClBA,2BAA2BA;QAC3BA,MAAMA,KAAKA,CAACA;IACbA,CAACA;AACFA,CAACA;AAED,gBAAiB,KAAiC,EAAE,OAA6B;IAChFC,MAAMA,CAACA,IAAIA,OAAOA,CAAEA,UAAEA,OAAiCA,EAAEA,MAA4BA;QACpFA,MAAMA,CAACA,MAAMA,CAAEA,KAAKA,CAACA,MAAMA,EAAEA,OAAOA,EAAEA,UAAWA,KAASA,EAAEA,QAAeA;YAC1E,EAAE,CAAC,CAAE,KAAM,CAAC,CAAC,CAAC;gBACb,mCAAmC;gBACnC,MAAM,KAAK,CAAC;YACb,CAAC;YAED,KAAK,CAAC,MAAM,GAAG,QAAQ,CAAC;YACxB,OAAO,CAAE,KAAK,CAAE,CAAC;QAClB,CAAC,CAAEA,CAACA;IACLA,CAACA,CAAEA,CAACA;AACLA,CAACA;AAED;IAQCC,mBAAaA,OAAsBA;QAAtBC,uBAAsBA,GAAtBA,cAAsBA;QAClCA,IAAIA,CAACA,OAAOA,GAAGA,OAAOA,CAACA;QAEvBA,IAAIA,CAACA,QAAQA,GAAGA,IAAIA,GAAGA,EAAyBA,CAACA;QAEjDA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,aAAcA,CAACA,CAACA,CAACA;YACvDA,IAAIA,sBAAsBA,GAAyBA,IAAIA,CAACA,OAAOA,CAACA,aAAaA,CAACA,SAASA,CAACA,eAAeA,CAACA;YACxGA,IAAIA,CAACA,gBAAgBA,GAAGA,IAAIA,eAAeA,CAACA,KAAKA,CAAEA,sBAAsBA,CAACA,kBAAkBA,CAAEA,CAACA;QAChGA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACPA,IAAIA,CAACA,gBAAgBA,GAAGA,IAAIA,eAAeA,CAACA,KAAKA,EAAEA,CAACA;QACrDA,CAACA;IACFA,CAACA;IAhBDD,sBAAIA,sCAAeA;aAAnBA,cAA8CE,MAAMA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA,CAACA,CAACA;;;OAAAF;IAoB7EA,2BAAOA,GAAPA,UAASA,WAAeA;QACvBG,IAAIA,EAAEA,GAAUA,OAAOA,CAACA,OAAOA,CAACA,EAAEA,CAAEA,WAAWA,CAAEA,GAAGA,WAAWA,CAACA,GAAGA,GAAGA,WAAWA,CAACA;QAElFA,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,SAASA,CAAEA,EAAEA,CAAGA,CAACA;YAACA,MAAMA,CAACA,KAAKA,CAACA;QAChDA,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,WAAWA,CAAEA,EAAEA,CAAGA,CAACA;YAACA,MAAMA,CAACA,KAAKA,CAACA;QAElDA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAQA,CAACA,CAACA,CAACA;YACtBA,IAAIA,OAAOA,GAAUA,IAAIA,CAACA,OAAOA,CAACA,UAAUA,EAAEA,CAACA;YAC/CA,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,UAAUA,CAAEA,EAAEA,CAAEA,IAAIA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,QAAQA,CAAEA,OAAOA,EAAEA,EAAEA,CAAGA,CAACA;gBAACA,MAAMA,CAACA,IAAIA,CAACA;QACzFA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACPA,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,UAAUA,CAAEA,EAAEA,CAAGA,CAACA;gBAACA,MAAMA,CAACA,IAAIA,CAACA;QACjDA,CAACA;QAEDA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,aAAcA,CAACA;YAACA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,aAAaA,CAACA,SAASA,CAACA,OAAOA,CAAEA,EAAEA,CAAEA,CAACA;QAEjHA,MAAMA,CAACA,KAAKA,CAACA;IACdA,CAACA;IAEDH,8BAAUA,GAAVA,UAAYA,EAASA;QACpBI,EAAEA,GAAGA,IAAIA,CAACA,YAAYA,CAAEA,EAAEA,CAAEA,CAACA;QAE7BA,EAAEA,CAAAA,CAAEA,IAAIA,CAACA,QAAQA,CAACA,GAAGA,CAAEA,EAAEA,CAAGA,CAACA;YAACA,MAAMA,CAACA,IAAIA,CAACA;QAE1CA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,aAAcA,CAACA;YAACA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,aAAaA,CAACA,SAASA,CAACA,UAAUA,CAAEA,EAAEA,CAAEA,CAACA;QAEpHA,MAAMA,CAACA,KAAKA,CAACA;IACdA,CAACA;IAEDJ,8BAAUA,GAAVA,UAAYA,EAASA;QACpBK,IAAIA,OAAOA,GAAUA,IAAIA,CAACA,YAAYA,CAAEA,EAAEA,CAAEA,CAACA;QAE7CA,EAAEA,CAAAA,CAAEA,CAAEA,OAAQA,CAACA,CAACA,CAACA;YAChBA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,aAAcA,CAACA;gBAACA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,aAAaA,CAACA,SAASA,CAACA,UAAUA,CAAEA,EAAEA,CAAEA,CAACA;YACpHA,MAAMA,IAAIA,MAAMA,CAACA,oBAAoBA,CAAEA,iDAAiDA,CAAEA,CAACA;QAC5FA,CAACA;QAEDA,IAAIA,OAAqBA,CAACA;QAC1BA,EAAEA,CAAAA,CAAEA,CAAEA,IAAIA,CAACA,QAAQA,CAACA,GAAGA,CAAEA,OAAOA,CAAGA,CAACA,CAACA,CAACA;YACrCA,OAAOA,GAAGA,IAAIA,CAACA,aAAaA,CAAEA,OAAOA,CAAEA,CAACA;YACxCA,IAAIA,CAACA,QAAQA,CAACA,GAAGA,CAAEA,OAAOA,EAAEA,OAAOA,CAAEA,CAACA;QACvCA,CAACA;QAEDA,MAAMA,CAACA,IAAIA,CAACA,QAAQA,CAACA,GAAGA,CAAEA,OAAOA,CAAEA,CAACA;IACrCA,CAACA;IAEDL,uBAAGA,GAAHA,UAAKA,GAAUA,EAAEA,cAAwCA;QAAzDM,iBAiECA;QAjEgBA,8BAAwCA,GAAxCA,mBAAwCA;QACxDA,IAAIA,SAASA,GAAUA,IAAIA,CAACA,YAAYA,CAAEA,GAAGA,CAAEA,CAACA;QAChDA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAQA,CAACA;YAACA,GAAGA,GAAGA,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAAEA,GAAGA,CAAEA,CAACA;QAExDA,EAAEA,CAAAA,CAAEA,IAAIA,CAACA,QAAQA,CAACA,GAAGA,CAAEA,SAASA,CAAGA,CAACA,CAACA,CAACA;QAEtCA,CAACA;QAEDA,EAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,EAAGA,CAACA;YAACA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,iBAAiBA,CAAEA,cAAcA,CAAEA,CAACA;QAEjHA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,CAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAC3EA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,4BAA4BA,CAAEA,GAAGA,CAACA,KAAKA,CAACA,SAASA,EAAEA,cAAcA,CAAEA,CAACA;QAEtFA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAACA,GAAGA,CAAEA,GAAGA,EAAEA,cAAcA,CAAEA,CAACA,IAAIA,CAC1DA,UAAEA,QAA4BA;YAC7BA,IAAIA,YAAYA,GAAUA,KAAKA,CAAEA,QAAQA,CAACA,IAAIA,CAAEA,CAACA;YAEjDA,MAAMA,CAACA,MAAMA,CAAEA;gBACdA,MAAMA,EAAEA,YAAYA;gBACpBA,QAAQA,EAAEA,QAAQA;aAClBA,CAAEA,CAACA;QACLA,CAACA,CACDA,CAACA,IAAIA,CACLA,UAAEA,iBAAgDA;YACjDA,IAAIA,IAAIA,GAAUA,IAAIA,CAACA,QAAQA,CAACA,IAAIA,CAACA,OAAOA,CAAEA,iBAAiBA,CAACA,QAAQA,CAAEA,CAACA;YAC3EA,EAAEA,CAAAA,CAAEA,IAAIA,KAAKA,IAAKA,CAACA;gBAACA,MAAMA,IAAIA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAAEA,sCAAsCA,EAAEA,iBAAiBA,CAACA,QAAQA,CAAEA,CAACA;YAEjIA,IAAIA,cAAcA,GAAOA,iBAAiBA,CAACA,MAAMA,CAACA;YAClDA,IAAIA,YAAYA,GAAwBA,GAAGA,CAACA,QAAQA,CAACA,IAAIA,CAACA,YAAYA,CAAEA,cAAcA,CAAEA,CAACA;YACzFA,IAAIA,WAAWA,GAAsBA,KAAIA,CAACA,cAAcA,CAAEA,YAAYA,EAAEA,iBAAiBA,CAACA,QAAQA,CAAEA,CAACA;YAErGA,IAAIA,iBAAiBA,GAAoBA,GAAGA,CAACA,QAAQA,CAACA,IAAIA,CAACA,oBAAoBA,CAAEA,WAAWA,CAAEA,CAACA;YAC/FA,EAAEA,CAAAA,CAAEA,iBAAiBA,CAACA,MAAMA,GAAGA,CAAEA,CAACA;gBAACA,MAAMA,IAAIA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAAEA,2DAA2DA,EAAEA,iBAAiBA,CAACA,QAAQA,CAAEA,CAACA;YACrKA,EAAEA,CAAAA,CAAEA,iBAAiBA,CAACA,MAAMA,KAAKA,CAAEA,CAACA;gBAACA,MAAMA,IAAIA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAAEA,uDAAuDA,EAAEA,iBAAiBA,CAACA,QAAQA,CAAEA,CAACA;YAEnKA,IAAIA,gBAAgBA,GAAkBA,iBAAiBA,CAAEA,CAACA,CAAEA,CAACA;YAC7DA,IAAIA,iBAAiBA,GAAoBA,GAAGA,CAACA,QAAQA,CAACA,IAAIA,CAACA,iBAAiBA,CAAEA,WAAWA,CAAEA,CAACA;YAC5FA,IAAIA,sBAAsBA,GAAoBA,GAAGA,CAACA,QAAQA,CAACA,IAAIA,CAACA,oBAAoBA,CAAEA,WAAWA,CAAEA,CAACA;YAEpGA,IAAIA,eAAeA,GAAiBA,KAAIA,CAACA,UAAUA,CAAEA,GAAGA,CAAEA,CAACA;YAE3DA,IAAIA,QAAQA,GAA2BA,iBAAiBA,CAACA,OAAOA,CAACA,UAAUA,CAAEA,eAAeA,EAAEA,GAAGA,EAAEA,KAAIA,CAAEA,CAACA;YAC1GA,QAAQA,CAACA,KAAKA,GAAGA,IAAIA,CAACA;YAEtBA,IAAIA,SAASA,GAAoBA,EAAEA,CAACA;YACpCA,GAAGA,CAAAA,CAA0BA,UAAiBA,EAAzCA,6BAAoBA,EAApBA,IAA0CA,CAACA;gBAA3CA,IAAIA,gBAAgBA,GAAIA,iBAAiBA,IAArBA;gBACxBA,SAASA,CAACA,IAAIA,CAAEA,QAAQA,CAACA,cAAcA,CAAEA,gBAAgBA,CAAEA,KAAKA,CAAEA,CAAEA,CAAEA,CAACA;aACvEA;YAEDA,IAAIA,cAAcA,GAAyBA,EAAEA,CAACA;YAC9CA,GAAGA,CAAAA,CAA+BA,UAAsBA,EAAnDA,kCAAyBA,EAAzBA,IAAoDA,CAACA;gBAArDA,IAAIA,qBAAqBA,GAAIA,sBAAsBA,IAA1BA;gBAC7BA,cAAcA,CAACA,IAAIA,CAAEA,QAAQA,CAACA,mBAAmBA,CAAEA,qBAAqBA,CAAEA,KAAKA,CAAEA,CAAEA,CAAEA,CAACA;aACtFA;YAEDA,KAAIA,CAACA,OAAOA,CAAEA,gBAAgBA,EAAEA,QAAQA,EAAEA,QAAQA,CAAEA,CAACA;YACrDA,KAAIA,CAACA,OAAOA,CAAEA,iBAAiBA,EAAEA,SAASA,EAAEA,QAAQA,CAAEA,CAACA;YACvDA,KAAIA,CAACA,OAAOA,CAAEA,sBAAsBA,EAAEA,cAAcA,EAAEA,QAAQA,CAAEA,CAACA;YAEjEA,4DAA4DA;YAC5DA,MAAMA,CAACA;gBACNA,MAAMA,EAAEA,QAAQA;gBAChBA,QAAQA,EAAEA,iBAAiBA,CAACA,QAAQA;aACpCA,CAACA;QACHA,CAACA,CACDA,CAACA;IACHA,CAACA;IAEDN,+BAAWA,GAAXA,UAAaA,SAAgBA,EAAEA,KAAoBA,EAAEA,cAAwCA;QAC5FO,yDAAyDA;QADLA,8BAAwCA,GAAxCA,mBAAwCA;QAG5FA,EAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,EAAGA,CAACA;YAACA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,iBAAiBA,CAAEA,cAAcA,CAAEA,CAACA;QAEjHA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,CAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAC3EA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,oBAAoBA,CAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAChFA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,4BAA4BA,CAAEA,GAAGA,CAACA,KAAKA,CAACA,SAASA,EAAEA,cAAcA,CAAEA,CAACA;QAEtFA,+CAA+CA;IAChDA,CAACA;IAEDP,wBAAIA,GAAJA,UAAMA,iBAAyCA,EAAEA,cAAwCA;QAAxCQ,8BAAwCA,GAAxCA,mBAAwCA;QACxFA,EAAEA,CAAAA,CAAEA,CAAEA,iBAAiBA,CAACA,OAAOA,EAAGA,CAACA;YAACA,MAAMA,CAACA,IAAIA,OAAOA,CAAuBA,UAAEA,OAA8CA;gBAC5HA,OAAOA,CAAEA,IAAIA,CAAEA,CAACA;YACjBA,CAACA,CAACA,CAACA;QAEHA,EAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,EAAGA,CAACA;YAACA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,iBAAiBA,CAAEA,cAAcA,CAAEA,CAACA;QAEjHA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,CAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAC3EA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,oBAAoBA,CAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAChFA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,4BAA4BA,CAAEA,GAAGA,CAACA,KAAKA,CAACA,SAASA,EAAEA,cAAcA,CAAEA,CAACA;QACtFA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,gBAAgBA,CAAEA,iBAAiBA,CAACA,KAAKA,EAAEA,cAAcA,CAAEA,CAACA;QAE9EA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAACA,GAAGA,CAAEA,iBAAiBA,CAACA,GAAGA,EAAEA,iBAAiBA,CAACA,MAAMA,EAAEA,EAAEA,cAAcA,CAAEA,CAACA;IACtGA,CAACA;IAEDR,0BAAMA,GAANA,UAAQA,iBAAyCA,EAAEA,cAAwCA;QAAxCS,8BAAwCA,GAAxCA,mBAAwCA;QAC1FA,EAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,EAAGA,CAACA;YAACA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,iBAAiBA,CAAEA,cAAcA,CAAEA,CAACA;QAEjHA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,CAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAC3EA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,4BAA4BA,CAAEA,GAAGA,CAACA,KAAKA,CAACA,SAASA,EAAEA,cAAcA,CAAEA,CAACA;QACtFA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,gBAAgBA,CAAEA,iBAAiBA,CAACA,KAAKA,EAAEA,cAAcA,CAAEA,CAACA;QAE9EA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAACA,MAAMA,CAAEA,iBAAiBA,CAACA,GAAGA,EAAEA,iBAAiBA,CAACA,MAAMA,EAAEA,EAAEA,cAAcA,CAAEA,CAACA;IACzGA,CAACA;IAEOT,kCAAcA,GAAtBA,UAAwBA,YAAiCA,EAAEA,QAA4BA;QACtFU,EAAEA,CAACA,CAAEA,YAAYA,CAACA,MAAMA,KAAKA,CAAEA,CAACA;YAACA,MAAMA,IAAIA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAAEA,2BAA2BA,EAAEA,QAAQA,CAAEA,CAACA;QACjHA,EAAEA,CAACA,CAAEA,YAAYA,CAACA,MAAMA,GAAGA,CAAEA,CAACA;YAACA,MAAMA,IAAIA,KAAKA,CAAEA,2DAA2DA,CAAEA,CAACA;QAC9GA,MAAMA,CAACA,YAAYA,CAAEA,CAACA,CAAEA,CAACA;IAC1BA,CAACA;IAEOV,gCAAYA,GAApBA,UAAsBA,GAAUA;QAC/BW,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,SAASA,CAAEA,GAAGA,CAAGA,CAACA;YAACA,MAAMA,IAAIA,MAAMA,CAACA,oBAAoBA,CAAEA,oCAAoCA,CAAEA,CAACA;QAClHA,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,WAAWA,CAAEA,GAAGA,CAAGA,CAACA;YAACA,MAAMA,IAAIA,MAAMA,CAACA,oBAAoBA,CAAEA,4CAA4CA,CAAEA,CAACA;QAE5HA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAQA,CAACA,CAACA,CAACA;YACtBA,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,UAAUA,CAAEA,GAAGA,CAAGA,CAACA,CAACA,CAACA;gBACrCA,IAAIA,OAAOA,GAAUA,IAAIA,CAACA,OAAOA,CAACA,UAAUA,EAAEA,CAACA;gBAC/CA,EAAEA,CAAAA,CAAEA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,QAAQA,CAAEA,OAAOA,EAAEA,GAAGA,CAAGA,CAACA;oBAACA,MAAMA,CAACA,IAAIA,CAACA;gBAE1DA,MAAMA,CAACA,GAAGA,CAACA,SAASA,CAAEA,OAAOA,CAACA,MAAMA,CAAEA,CAACA;YACxCA,CAACA;YAACA,IAAIA,CAACA,CAACA;gBACPA,MAAMA,CAACA,GAAGA,CAACA;YACZA,CAACA;QACFA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACPA,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,UAAUA,CAAEA,GAAGA,CAAGA,CAACA;gBAACA,MAAMA,IAAIA,MAAMA,CAACA,oBAAoBA,CAAEA,wDAAwDA,CAAEA,CAACA;YACvIA,MAAMA,CAACA,GAAGA,CAACA;QACZA,CAACA;IACFA,CAACA;IAEOX,iCAAaA,GAArBA,UAAuBA,OAAcA;QACpCY,IAAIA,GAAGA,GAAUA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,GAAGA,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAAEA,OAAOA,CAAEA,GAAGA,OAAOA,CAACA;QAC7EA,MAAMA,CAACA;YACNA,GAAGA,EAAEA,GAAGA;YACRA,OAAOA,EAAEA;gBACR,OAAO;gBACP,MAAM,CAAC,IAAI,CAAC;YACb,CAAC;SACDA,CAACA;IACHA,CAACA;IAIOZ,2BAAOA,GAAfA,UAAiBA,uBAA2BA,EAAEA,qBAAyBA,EAAEA,cAA8BA;QACtGa,EAAEA,CAAAA,CAAEA,CAAEA,KAAKA,CAACA,OAAOA,CAAEA,uBAAuBA,CAAGA,CAACA;YAACA,MAAMA,CAACA,IAAIA,CAACA,aAAaA,CAAEA,uBAAuBA,EAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAE7IA,IAAIA,eAAeA,GAAYA,uBAAuBA,CAACA;QACvDA,IAAIA,aAAaA,GAAYA,CAACA,CAAEA,qBAAqBA,GAAGA,qBAAqBA,GAAGA,EAAEA,CAACA;QACnFA,GAAGA,CAAAA,CAAEA,GAAGA,CAACA,CAACA,GAAUA,CAACA,EAAEA,QAAMA,GAAUA,eAAeA,CAACA,MAAMA,EAAEA,CAACA,GAAGA,QAAMA,EAAEA,CAACA,EAAEA,EAAGA,CAACA;YACjFA,IAAIA,cAAcA,GAAUA,eAAeA,CAAEA,CAACA,CAAEA,CAACA;YACjDA,IAAIA,YAAYA,GAAUA,aAAaA,CAAEA,CAACA,CAAEA,GAAGA,CAACA,CAAEA,aAAaA,CAAEA,CAACA,CAAEA,GAAGA,aAAaA,CAAEA,CAACA,CAAEA,GAAGA,EAAEA,CAACA;YAE/FA,IAAIA,CAACA,aAAaA,CAAEA,cAAcA,EAAEA,YAAYA,EAAEA,cAAcA,CAAEA,CAACA;QACpEA,CAACA;QAEDA,MAAMA,CAACA,aAAaA,CAACA;IACtBA,CAACA;IAEOb,iCAAaA,GAArBA,UAAuBA,cAAqBA,EAAEA,YAAmBA,EAAEA,cAA8BA;QAChGc,IAAIA,eAA+CA,CAACA;QACpDA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAQA,CAACA,CAACA,CAACA;YACtBA,IAAIA,KAAKA,GAAYA,IAAIA,CAACA,sBAAsBA,CAAEA,cAAcA,CAAEA,CAACA;YAEnEA,IAAIA,qBAAqBA,GAAqCA,EAAEA,CAACA;YACjEA,GAAGA,CAAAA,CAAcA,UAAKA,EAAjBA,iBAAQA,EAARA,IAAkBA,CAACA;gBAAnBA,IAAIA,IAAIA,GAAIA,KAAKA,IAATA;gBACZA,EAAEA,CAAAA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,eAAeA,CAAEA,IAAIA,CAAGA,CAACA;oBAACA,qBAAqBA,CAACA,IAAIA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,eAAeA,CAAEA,IAAIA,CAAEA,CAAEA,CAACA;aAC9GA;YAEDA,EAAEA,CAAAA,CAAEA,qBAAqBA,CAACA,MAAMA,KAAKA,CAAEA,CAACA,CAACA,CAACA;gBACzCA,eAAeA,GAAGA,IAAIA,CAACA,OAAOA,CAACA,cAAcA,EAAEA,CAACA;YACjDA,CAACA;YAACA,IAAIA,CAACA,CAACA;gBACPA,eAAeA,GAAGA,eAAeA,CAACA,KAAKA,CAACA,uBAAuBA,CAAEA,qBAAqBA,CAAEA,CAACA;YAC1FA,CAACA;QACFA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACPA,eAAeA,GAAGA,IAAIA,eAAeA,CAACA,eAAeA,EAAEA,CAACA;QACzDA,CAACA;QAEDA,MAAMA,CAACA,IAAIA,CAACA,eAAeA,CAACA,OAAOA,CAAEA,cAAcA,EAAEA,YAAYA,EAAEA,eAAeA,EAAEA,cAAcA,CAAEA,CAACA;IAEtGA,CAACA;IAEOd,0CAAsBA,GAA9BA,UAAgCA,cAAqBA;QACpDe,IAAIA,KAAKA,GAAYA,EAAEA,CAACA;QACxBA,EAAEA,CAAAA,CAAEA,CAAEA,cAAcA,CAAEA,EAAEA,CAACA,GAAGA,CAACA,SAASA,CAACA,IAAIA,CAAGA,CAACA;YAACA,MAAMA,CAACA,KAAKA,CAACA;QAE7DA,GAAGA,CAAAA,CAAoBA,UAAuCA,EAAvCA,KAAAA,cAAcA,CAAEA,EAAEA,CAACA,GAAGA,CAACA,SAASA,CAACA,IAAIA,CAAEA,EAAzDA,cAAcA,EAAdA,IAA0DA,CAACA;YAA3DA,IAAIA,UAAUA,SAAAA;YAClBA,EAAEA,CAAAA,CAAEA,CAAEA,UAAUA,CAAEA,KAAKA,CAAGA,CAACA;gBAACA,QAAQA,CAACA;YACrCA,KAAKA,CAACA,IAAIA,CAAEA,UAAUA,CAAEA,KAAKA,CAAEA,CAAEA,CAACA;SAClCA;QAEDA,MAAMA,CAACA,KAAKA,CAACA;IACdA,CAACA;IACFf,gBAACA;AAADA,CAnQA,AAmQCA,IAAA;AAED;kBAAe,SAAS,CAAC","file":"Documents.js","sourcesContent":["/// <reference path=\"../typings/tsd.d.ts\" />\n\nimport * as jsonld from \"jsonld\";\n\nimport Committer from \"./Committer\";\nimport * as Errors from \"./Errors\";\nimport * as HTTP from \"./HTTP\";\nimport Context from \"./Context\";\nimport * as RDF from \"./RDF\";\nimport * as Utils from \"./Utils\";\n\nimport * as ContextDigester from \"./ContextDigester\";\nimport * as Document from \"./Document\";\nimport * as Fragment from \"./Fragment\";\nimport * as JSONLDConverter from \"./JSONLDConverter\";\nimport * as PersistedDocument from \"./PersistedDocument\";\nimport * as Pointer from \"./Pointer\";\nimport * as NamedFragment from \"./NamedFragment\";\nimport * as NS from \"./NS\";\n\nimport * as LDP from \"./NS/LDP\";\n\nfunction parse( input:string ):any {\n\ttry {\n\t\treturn JSON.parse( input );\n\t} catch ( error ) {\n\t\t// TODO: Handle SyntaxError\n\t\tthrow error;\n\t}\n}\n\nfunction expand( input:HTTP.ProcessedResponse<any>, options?:jsonld.ExpandOptions ):Promise<Object> {\n\treturn new Promise( ( resolve:( result:Object ) => void, reject:( error:any ) => void ) => {\n\t\tjsonld.expand( input.result, options, function ( error:any, expanded:Object ):void {\n\t\t\tif ( error ) {\n\t\t\t\t// TODO: Handle jsonld.expand error\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\tinput.result = expanded;\n\t\t\tresolve( input );\n\t\t} );\n\t} );\n}\n\nclass Documents implements Pointer.Library, Pointer.Validator {\n\t_jsonldConverter:JSONLDConverter.Class;\n\n\tget jsonldConverter():JSONLDConverter.Class { return this._jsonldConverter; }\n\n\tprivate context:Context;\n\tprivate pointers:Map<string, Pointer.Class>;\n\n\tconstructor( context:Context = null ) {\n\t\tthis.context = context;\n\n\t\tthis.pointers = new Map<string, Pointer.Class>();\n\n\t\tif( !! this.context && !! this.context.parentContext ) {\n\t\t\tlet contextJSONLDConverter:JSONLDConverter.Class = this.context.parentContext.Documents.jsonldConverter;\n\t\t\tthis._jsonldConverter = new JSONLDConverter.Class( contextJSONLDConverter.literalSerializers );\n\t\t} else {\n\t\t\tthis._jsonldConverter = new JSONLDConverter.Class();\n\t\t}\n\t}\n\n\tinScope( pointer:Pointer.Class ):boolean;\n\tinScope( id:string ):boolean;\n\tinScope( idOrPointer:any ):boolean {\n\t\tlet id:string = Pointer.Factory.is( idOrPointer ) ? idOrPointer.uri : idOrPointer;\n\n\t\tif( RDF.URI.Util.isBNodeID( id ) ) return false;\n\t\tif( RDF.URI.Util.hasFragment( id ) ) return false;\n\n\t\tif( !! this.context ) {\n\t\t\tlet baseURI:string = this.context.getBaseURI();\n\t\t\tif( RDF.URI.Util.isAbsolute( id ) && RDF.URI.Util.isBaseOf( baseURI, id ) ) return true;\n\t\t} else {\n\t\t\tif( RDF.URI.Util.isAbsolute( id ) ) return true;\n\t\t}\n\n\t\tif( !! this.context && !! this.context.parentContext ) return this.context.parentContext.Documents.inScope( id );\n\n\t\treturn false;\n\t}\n\n\thasPointer( id:string ):boolean {\n\t\tid = this.getPointerID( id );\n\n\t\tif( this.pointers.has( id ) ) return true;\n\n\t\tif( !! this.context && !! this.context.parentContext ) return this.context.parentContext.Documents.hasPointer( id );\n\n\t\treturn false;\n\t}\n\n\tgetPointer( id:string ):Pointer.Class {\n\t\tlet localID:string = this.getPointerID( id );\n\n\t\tif( ! localID ) {\n\t\t\tif( !! this.context && !! this.context.parentContext ) return this.context.parentContext.Documents.getPointer( id );\n\t\t\tthrow new Errors.IllegalArgumentError( \"The pointer id is not supported by this module.\" );\n\t\t}\n\n\t\tlet pointer:Pointer.Class;\n\t\tif( ! this.pointers.has( localID ) ) {\n\t\t\tpointer = this.createPointer( localID );\n\t\t\tthis.pointers.set( localID, pointer );\n\t\t}\n\n\t\treturn this.pointers.get( localID );\n\t}\n\n\tget( uri:string, requestOptions:HTTP.Request.Options = {} ):Promise<HTTP.ProcessedResponse<PersistedDocument.Class>> {\n\t\tlet pointerID:string = this.getPointerID( uri );\n\t\tif( !! this.context ) uri = this.context.resolve( uri );\n\n\t\tif( this.pointers.has( pointerID ) ) {\n\t\t\t// TODO: Check if the pointer has been already resolved and refresh it\n\t\t}\n\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.RDFSource, requestOptions );\n\n\t\treturn HTTP.Request.Service.get( uri, requestOptions ).then(\n\t\t\t( response:HTTP.Response.Class ) => {\n\t\t\t\tlet parsedObject:Object = parse( response.data );\n\n\t\t\t\treturn expand( {\n\t\t\t\t\tresult: parsedObject,\n\t\t\t\t\tresponse: response,\n\t\t\t\t} );\n\t\t\t}\n\t\t).then(\n\t\t\t( processedResponse:HTTP.ProcessedResponse<Object> ) => {\n\t\t\t\tlet etag:string = HTTP.Response.Util.getETag( processedResponse.response );\n\t\t\t\tif( etag === null ) throw new HTTP.Errors.BadResponseError( \"The response doesn't contain an ETag\", processedResponse.response );\n\n\t\t\t\tlet expandedResult:any = processedResponse.result;\n\t\t\t\tlet rdfDocuments:RDF.Document.Class[] = RDF.Document.Util.getDocuments( expandedResult );\n\t\t\t\tlet rdfDocument:RDF.Document.Class = this.getRDFDocument( rdfDocuments, processedResponse.response );\n\n\t\t\t\tlet documentResources:RDF.Node.Class[] = RDF.Document.Util.getDocumentResources( rdfDocument );\n\t\t\t\tif( documentResources.length > 1 ) throw new HTTP.Errors.BadResponseError( \"The RDFDocument contains more than one document resource.\", processedResponse.response );\n\t\t\t\tif( documentResources.length === 0 ) throw new HTTP.Errors.BadResponseError( \"The RDFDocument doesn\\'t contain a document resource.\", processedResponse.response );\n\n\t\t\t\tlet documentResource:RDF.Node.Class = documentResources[ 0 ];\n\t\t\t\tlet fragmentResources:RDF.Node.Class[] = RDF.Document.Util.getBNodeResources( rdfDocument );\n\t\t\t\tlet namedFragmentResources:RDF.Node.Class[] = RDF.Document.Util.getFragmentResources( rdfDocument );\n\n\t\t\t\tlet documentPointer:Pointer.Class = this.getPointer( uri );\n\n\t\t\t\tlet document:PersistedDocument.Class = PersistedDocument.Factory.createFrom( documentPointer, uri, this );\n\t\t\t\tdocument._etag = etag;\n\n\t\t\t\tlet fragments:Fragment.Class[] = [];\n\t\t\t\tfor( let fragmentResource of fragmentResources ) {\n\t\t\t\t\tfragments.push( document.createFragment( fragmentResource[ \"@id\" ] ) );\n\t\t\t\t}\n\n\t\t\t\tlet namedFragments:NamedFragment.Class[] = [];\n\t\t\t\tfor( let namedFragmentResource of namedFragmentResources ) {\n\t\t\t\t\tnamedFragments.push( document.createNamedFragment( namedFragmentResource[ \"@id\" ] ) );\n\t\t\t\t}\n\n\t\t\t\tthis.compact( documentResource, document, document );\n\t\t\t\tthis.compact( fragmentResources, fragments, document );\n\t\t\t\tthis.compact( namedFragmentResources, namedFragments, document );\n\n\t\t\t\t// TODO: Decorate additional behavior (container, app, etc.)\n\t\t\t\treturn {\n\t\t\t\t\tresult: document,\n\t\t\t\t\tresponse: processedResponse.response,\n\t\t\t\t};\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateChild( parentURI:string, child:Document.Class, requestOptions:HTTP.Request.Options = {} ):Promise<HTTP.Response.Class> {\n\t\t// TODO: Validate that the child is not persisted already\n\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setContentTypeHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.Container, requestOptions );\n\n\t\t// return HTTP.Request.Service.post( parentURI,\n\t}\n\n\tsave( persistedDocument:PersistedDocument.Class, requestOptions:HTTP.Request.Options = {} ):Promise<HTTP.Response.Class> {\n\t\tif( ! persistedDocument.isDirty() ) return new Promise<HTTP.Response.Class>( ( resolve:( result:HTTP.Response.Class ) => void ) => {\n\t\t\tresolve( null );\n\t\t});\n\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setContentTypeHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.RDFSource, requestOptions );\n\t\tHTTP.Request.Util.setIfMatchHeader( persistedDocument._etag, requestOptions );\n\n\t\treturn HTTP.Request.Service.put( persistedDocument.uri, persistedDocument.toJSON(), requestOptions );\n\t}\n\n\tdelete( persistedDocument:PersistedDocument.Class, requestOptions:HTTP.Request.Options = {} ):Promise<HTTP.Response.Class> {\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.RDFSource, requestOptions );\n\t\tHTTP.Request.Util.setIfMatchHeader( persistedDocument._etag, requestOptions );\n\n\t\treturn HTTP.Request.Service.delete( persistedDocument.uri, persistedDocument.toJSON(), requestOptions );\n\t}\n\n\tprivate getRDFDocument( rdfDocuments:RDF.Document.Class[], response:HTTP.Response.Class ):RDF.Document.Class {\n\t\tif ( rdfDocuments.length === 0 ) throw new HTTP.Errors.BadResponseError( \"No document was returned.\", response );\n\t\tif ( rdfDocuments.length > 1 ) throw new Error( \"Unsupported: Multiple graphs are currently not supported.\" );\n\t\treturn rdfDocuments[ 0 ];\n\t}\n\n\tprivate getPointerID( uri:string ):string {\n\t\tif( RDF.URI.Util.isBNodeID( uri ) ) throw new Errors.IllegalArgumentError( \"BNodes cannot be fetched directly.\" );\n\t\tif( RDF.URI.Util.hasFragment( uri ) ) throw new Errors.IllegalArgumentError( \"Fragment URI's cannot be fetched directly.\" );\n\n\t\tif( !! this.context ) {\n\t\t\tif( RDF.URI.Util.isRelative( uri ) ) {\n\t\t\t\tlet baseURI:string = this.context.getBaseURI();\n\t\t\t\tif( ! RDF.URI.Util.isBaseOf( baseURI, uri ) ) return null;\n\n\t\t\t\treturn uri.substring( baseURI.length );\n\t\t\t} else {\n\t\t\t\treturn uri;\n\t\t\t}\n\t\t} else {\n\t\t\tif( RDF.URI.Util.isRelative( uri ) ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\treturn uri;\n\t\t}\n\t}\n\n\tprivate createPointer( localID:string ):Pointer.Class {\n\t\tlet uri:string = !! this.context ? this.context.resolve( localID ) : localID;\n\t\treturn {\n\t\t\turi: uri,\n\t\t\tresolve: function():Promise<void> {\n\t\t\t\t// TODO\n\t\t\t\treturn null;\n\t\t\t},\n\t\t};\n\t}\n\n\tprivate compact( expandedObjects:Object[], targetObjects:Object[], pointerLibrary:Pointer.Library ):Object[];\n\tprivate compact( expandedObject:Object, targetObject:Object, pointerLibrary:Pointer.Library ):Object;\n\tprivate compact( expandedObjectOrObjects:any, targetObjectOrObjects:any, pointerLibrary:Pointer.Library ):any {\n\t\tif( ! Utils.isArray( expandedObjectOrObjects ) ) return this.compactSingle( expandedObjectOrObjects, targetObjectOrObjects, pointerLibrary );\n\n\t\tlet expandedObjects:Object[] = expandedObjectOrObjects;\n\t\tlet targetObjects:Object[] = !! targetObjectOrObjects ? targetObjectOrObjects : [];\n\t\tfor( let i:number = 0, length:number = expandedObjects.length; i < length; i++ ) {\n\t\t\tlet expandedObject:Object = expandedObjects[ i ];\n\t\t\tlet targetObject:Object = targetObjects[ i ] = !! targetObjects[ i ] ? targetObjects[ i ] : {};\n\n\t\t\tthis.compactSingle( expandedObject, targetObject, pointerLibrary );\n\t\t}\n\n\t\treturn targetObjects;\n\t}\n\n\tprivate compactSingle( expandedObject:Object, targetObject:Object, pointerLibrary:Pointer.Library ):Object {\n\t\tlet digestedContext:ContextDigester.DigestedContext;\n\t\tif( !! this.context ) {\n\t\t\tlet types:string[] = this.getExpandedObjectTypes( expandedObject );\n\n\t\t\tlet typesDigestedContexts:ContextDigester.DigestedContext[] = [];\n\t\t\tfor( let type of types ) {\n\t\t\t\tif( this.context.hasClassContext( type ) ) typesDigestedContexts.push( this.context.getClassContext( type ) );\n\t\t\t}\n\n\t\t\tif( typesDigestedContexts.length === 0 ) {\n\t\t\t\tdigestedContext = this.context.getMainContext();\n\t\t\t} else {\n\t\t\t\tdigestedContext = ContextDigester.Class.combineDigestedContexts( typesDigestedContexts );\n\t\t\t}\n\t\t} else {\n\t\t\tdigestedContext = new ContextDigester.DigestedContext();\n\t\t}\n\n\t\treturn this.jsonldConverter.compact( expandedObject, targetObject, digestedContext, pointerLibrary );\n\n\t}\n\n\tprivate getExpandedObjectTypes( expandedObject:Object ):string[] {\n\t\tlet types:string[] = [];\n\t\tif( ! expandedObject[ NS.RDF.Predicate.type ] ) return types;\n\n\t\tfor( let typeObject of expandedObject[ NS.RDF.Predicate.type ] ) {\n\t\t\tif( ! typeObject[ \"@id\" ] ) continue;\n\t\t\ttypes.push( typeObject[ \"@id\" ] );\n\t\t}\n\n\t\treturn types;\n\t}\n}\n\nexport default Documents;\n"],"sourceRoot":"/source/"}