{"version":3,"sources":["Documents.ts"],"names":["parse","expand","Documents","Documents.constructor","Documents.jsonldConverter","Documents.inScope","Documents.hasPointer","Documents.getPointer","Documents.get","Documents.createChild","Documents.save","Documents.delete","Documents.getSchemaFor","Documents.executeSELECTQuery","Documents.getRDFDocument","Documents.getPointerID","Documents.createPointer","Documents.compact","Documents.compactSingle","Documents.getDigestedObjectSchemaForExpandedObject","Documents.getDigestedObjectSchemaForDocument","Documents.getDigestedObjectSchema","Documents.getExpandedObjectTypes","Documents.getDocumentTypes"],"mappings":"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","file":"Documents.js","sourcesContent":["/// <reference path=\"../typings/typings.d.ts\" />\n\nimport * as jsonld from \"jsonld\";\n\nimport Committer from \"./Committer\";\nimport * as Errors from \"./Errors\";\nimport * as HTTP from \"./HTTP\";\nimport Context from \"./Context\";\nimport * as RDF from \"./RDF\";\nimport * as Utils from \"./Utils\";\n\nimport * as Document from \"./Document\";\nimport * as Fragment from \"./Fragment\";\nimport * as JSONLDConverter from \"./JSONLDConverter\";\nimport * as PersistedDocument from \"./PersistedDocument\";\nimport * as Pointer from \"./Pointer\";\nimport * as NamedFragment from \"./NamedFragment\";\nimport * as NS from \"./NS\";\nimport * as ObjectSchema from \"./ObjectSchema\";\nimport * as LDP from \"./NS/LDP\";\nimport * as Resource from \"./Resource\";\nimport * as SPARQL from \"./SPARQL\";\n\nfunction parse( input:string ):any {\n\ttry {\n\t\treturn JSON.parse( input );\n\t} catch ( error ) {\n\t\t// TODO: Handle SyntaxError\n\t\tthrow error;\n\t}\n}\n\nfunction expand( [ result, response ]:[ Object, HTTP.Response.Class ], options?:jsonld.ExpandOptions ):Promise<[ Object, HTTP.Response.Class ]> {\n\treturn new Promise( ( resolve:( result:Object ) => void, reject:( error:any ) => void ) => {\n\t\tjsonld.expand( result, options, function ( error:any, expanded:Object ):void {\n\t\t\tif ( error ) {\n\t\t\t\t// TODO: Handle jsonld.expand error\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\tresult = expanded;\n\t\t\tresolve( [ result, response ] );\n\t\t} );\n\t} );\n}\n\nclass Documents implements Pointer.Library, Pointer.Validator, ObjectSchema.Resolver {\n\t_jsonldConverter:JSONLDConverter.Class;\n\n\tget jsonldConverter():JSONLDConverter.Class { return this._jsonldConverter; }\n\n\tprivate context:Context;\n\tprivate pointers:Map<string, Pointer.Class>;\n\n\tconstructor( context:Context = null ) {\n\t\tthis.context = context;\n\n\t\tthis.pointers = new Map<string, Pointer.Class>();\n\n\t\tif( !! this.context && !! this.context.parentContext ) {\n\t\t\tlet contextJSONLDConverter:JSONLDConverter.Class = this.context.parentContext.Documents.jsonldConverter;\n\t\t\tthis._jsonldConverter = new JSONLDConverter.Class( contextJSONLDConverter.literalSerializers );\n\t\t} else {\n\t\t\tthis._jsonldConverter = new JSONLDConverter.Class();\n\t\t}\n\t}\n\n\tinScope( pointer:Pointer.Class ):boolean;\n\tinScope( id:string ):boolean;\n\tinScope( idOrPointer:any ):boolean {\n\t\tlet id:string = Pointer.Factory.is( idOrPointer ) ? idOrPointer.id : idOrPointer;\n\n\t\tif( RDF.URI.Util.isBNodeID( id ) ) return false;\n\n\t\tif( !! this.context ) {\n\t\t\tlet baseURI:string = this.context.getBaseURI();\n\t\t\tif( RDF.URI.Util.isAbsolute( id ) && RDF.URI.Util.isBaseOf( baseURI, id ) ) return true;\n\t\t} else {\n\t\t\tif( RDF.URI.Util.isAbsolute( id ) ) return true;\n\t\t}\n\n\t\tif( !! this.context && !! this.context.parentContext ) return this.context.parentContext.Documents.inScope( id );\n\n\t\treturn false;\n\t}\n\n\thasPointer( id:string ):boolean {\n\t\tid = this.getPointerID( id );\n\n\t\tif( this.pointers.has( id ) ) return true;\n\n\t\tif( !! this.context && !! this.context.parentContext ) return this.context.parentContext.Documents.hasPointer( id );\n\n\t\treturn false;\n\t}\n\n\tgetPointer( id:string ):Pointer.Class {\n\t\tlet localID:string = this.getPointerID( id );\n\n\t\tif( ! localID ) {\n\t\t\tif( !! this.context && !! this.context.parentContext ) return this.context.parentContext.Documents.getPointer( id );\n\t\t\tthrow new Errors.IllegalArgumentError( \"The pointer id is not supported by this module.\" );\n\t\t}\n\n\t\tlet pointer:Pointer.Class;\n\t\tif( ! this.pointers.has( localID ) ) {\n\t\t\tpointer = this.createPointer( localID );\n\t\t\tthis.pointers.set( localID, pointer );\n\t\t}\n\n\t\treturn this.pointers.get( localID );\n\t}\n\n\tget( uri:string, requestOptions:HTTP.Request.Options = {} ):Promise<[ PersistedDocument.Class, HTTP.Response.Class ]> {\n\t\tlet pointerID:string = this.getPointerID( uri );\n\t\tif( !! this.context ) uri = this.context.resolve( uri );\n\n\t\tif( this.pointers.has( pointerID ) ) {\n\t\t\tlet pointer:Pointer.Class = this.getPointer( uri );\n\t\t\tif( pointer.isResolved() ) {\n\t\t\t\treturn new Promise( ( resolve:( result:[ PersistedDocument.Class, HTTP.Response.Class ]) => void, reject:( error:Error ) => void ) => {\n\t\t\t\t\tresolve( [ <any> pointer, null ] );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.RDFSource, requestOptions );\n\n\t\treturn HTTP.Request.Service.get( uri, requestOptions ).then(\n\t\t\t( response:HTTP.Response.Class ) => {\n\t\t\t\tlet parsedObject:Object = parse( response.data );\n\n\t\t\t\treturn expand( [ parsedObject, response ] );\n\t\t\t}\n\t\t).then(\n\t\t\t( [ expandedResult, response ]:[ Object, HTTP.Response.Class ] ) => {\n\t\t\t\tlet etag:string = HTTP.Response.Util.getETag( response );\n\t\t\t\tif( etag === null ) throw new HTTP.Errors.BadResponseError( \"The response doesn't contain an ETag\", response );\n\n\t\t\t\tlet rdfDocuments:RDF.Document.Class[] = RDF.Document.Util.getDocuments( expandedResult );\n\t\t\t\tlet rdfDocument:RDF.Document.Class = this.getRDFDocument( rdfDocuments, response );\n\n\t\t\t\tlet documentResources:RDF.Node.Class[] = RDF.Document.Util.getDocumentResources( rdfDocument );\n\t\t\t\tif( documentResources.length > 1 ) throw new HTTP.Errors.BadResponseError( \"The RDFDocument contains more than one document resource.\", response );\n\t\t\t\tif( documentResources.length === 0 ) throw new HTTP.Errors.BadResponseError( \"The RDFDocument doesn\\'t contain a document resource.\", response );\n\n\t\t\t\tlet documentResource:RDF.Node.Class = documentResources[ 0 ];\n\t\t\t\tlet fragmentResources:RDF.Node.Class[] = RDF.Document.Util.getBNodeResources( rdfDocument );\n\t\t\t\tlet namedFragmentResources:RDF.Node.Class[] = RDF.Document.Util.getFragmentResources( rdfDocument );\n\n\t\t\t\tlet documentPointer:Pointer.Class = this.getPointer( uri );\n\t\t\t\tdocumentPointer._resolved = true;\n\n\t\t\t\tlet document:PersistedDocument.Class = PersistedDocument.Factory.createFrom( documentPointer, uri, this );\n\t\t\t\tdocument._etag = etag;\n\n\t\t\t\tlet fragments:Fragment.Class[] = [];\n\t\t\t\tfor( let fragmentResource of fragmentResources ) {\n\t\t\t\t\tfragments.push( document.createFragment( fragmentResource[ \"@id\" ] ) );\n\t\t\t\t}\n\n\t\t\t\tlet namedFragments:NamedFragment.Class[] = [];\n\t\t\t\tfor( let namedFragmentResource of namedFragmentResources ) {\n\t\t\t\t\tnamedFragments.push( document.createNamedFragment( namedFragmentResource[ \"@id\" ] ) );\n\t\t\t\t}\n\n\t\t\t\tthis.compact( documentResource, document, document );\n\t\t\t\tthis.compact( fragmentResources, fragments, document );\n\t\t\t\tthis.compact( namedFragmentResources, namedFragments, document );\n\n\t\t\t\t// TODO: Decorate additional behavior (container, app, etc.)\n\t\t\t\treturn [ document, response ];\n\t\t\t}\n\t\t);\n\t}\n\tcreateChild( parentURI:string, slug:string, childDocument:Document.Class, requestOptions?:HTTP.Request.Options ):Promise<[ Pointer.Class, HTTP.Response.Class ]>;\n\tcreateChild( parentURI:string, childDocument:Document.Class, requestOptions?:HTTP.Request.Options ):Promise<[ Pointer.Class, HTTP.Response.Class ]>;\n\tcreateChild( parentURI:string, slugOrChildDocument:any, childDocumentOrRequestOptions:any = {}, requestOptions:HTTP.Request.Options = {} ):Promise<[ Pointer.Class, HTTP.Response.Class ]> {\n\t\tlet slug:string = Utils.isString( slugOrChildDocument ) ? slugOrChildDocument : null;\n\t\tlet childDocument:Document.Class = ! Utils.isString( slugOrChildDocument ) ? slugOrChildDocument : childDocumentOrRequestOptions;\n\t\trequestOptions = ! Utils.isString( slugOrChildDocument ) ? childDocumentOrRequestOptions : requestOptions;\n\n\t\tif( PersistedDocument.Factory.is( childDocument ) ) return Utils.P.createRejectedPromise( new Errors.IllegalArgumentError( \"The childDocument provided has been already persisted.\" ) );\n\n\t\tif( childDocument.id ) {\n\t\t\tif( ! RDF.URI.Util.isBaseOf( parentURI, childDocument.id ) ) return Utils.P.createRejectedPromise( new Errors.IllegalArgumentError( \"The childDocument's URI is not relative to the parentURI specified\" ) );\n\t\t}\n\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setContentTypeHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.Container, requestOptions );\n\n\t\tif( slug !== null ) HTTP.Request.Util.setSlug( slug, requestOptions );\n\n\t\tlet body:string = childDocument.toJSON( this, this.jsonldConverter );\n\n\t\treturn HTTP.Request.Service.post( parentURI, body, requestOptions ).then(\n\t\t\t( response:HTTP.Response.Class ) => {\n\t\t\t\tlet locationHeader:HTTP.Header.Class = response.headers.get( \"Location\" );\n\t\t\t\tif( locationHeader === null || locationHeader.values.length < 1 ) throw new HTTP.Errors.BadResponseError( \"The response is missing a Location header.\", response );\n\t\t\t\tif( locationHeader.values.length !== 1 ) throw new HTTP.Errors.BadResponseError( \"The response contains more than one Location header.\", response );\n\n\t\t\t\tlet locationURI:string = locationHeader.values[0].toString();\n\t\t\t\tlet pointer:Pointer.Class = this.getPointer( locationURI);\n\n\t\t\t\treturn [\n\t\t\t\t\tpointer,\n\t\t\t\t\tresponse,\n\t\t\t\t];\n\t\t\t}\n\t\t);\n\t}\n\n\tsave( persistedDocument:PersistedDocument.Class, requestOptions:HTTP.Request.Options = {} ):Promise<[ PersistedDocument.Class, HTTP.Response.Class ]> {\n\t\t// TODO: Check if the document isDirty\n\t\t/*\n\t\tif( ! persistedDocument.isDirty() ) return new Promise<HTTP.Response.Class>( ( resolve:( result:HTTP.Response.Class ) => void ) => {\n\t\t\tresolve( null );\n\t\t});\n\t\t*/\n\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setContentTypeHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.RDFSource, requestOptions );\n\t\tHTTP.Request.Util.setIfMatchHeader( persistedDocument._etag, requestOptions );\n\n\t\tlet body:string = persistedDocument.toJSON( this, this.jsonldConverter );\n\n\t\treturn HTTP.Request.Service.put( persistedDocument.id, body, requestOptions ).then( ( response:HTTP.Response.Class ) => {\n\t\t\treturn [ persistedDocument, response ];\n\t\t});\n\t}\n\n\tdelete( persistedDocument:PersistedDocument.Class, requestOptions:HTTP.Request.Options = {} ):Promise<HTTP.Response.Class> {\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.RDFSource, requestOptions );\n\t\tHTTP.Request.Util.setIfMatchHeader( persistedDocument._etag, requestOptions );\n\n\t\treturn HTTP.Request.Service.delete( persistedDocument.id, persistedDocument.toJSON(), requestOptions );\n\t}\n\n\tgetSchemaFor( object:Object ):ObjectSchema.DigestedObjectSchema {\n\t\tif( \"@id\" in object ) {\n\t\t\treturn this.getDigestedObjectSchemaForExpandedObject( object );\n\t\t} else {\n\t\t\treturn this.getDigestedObjectSchemaForDocument( <any> object );\n\t\t}\n\t}\n\n\texecuteSELECTQuery( documentURI:string, selectQuery:string, requestOptions:HTTP.Request.Options = {} ):Promise<[ SPARQL.Results.Class, HTTP.Response.Class ]> {\n\t\tif( ! RDF.URI.Util.isAbsolute( documentURI ) ) {\n\t\t\tif( ! this.context ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\tdocumentURI = this.context.resolve( documentURI );\n\t\t}\n\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\treturn SPARQL.Service.executeSELECTQuery( documentURI, selectQuery, requestOptions );\n\t}\n\n\tprivate getRDFDocument( rdfDocuments:RDF.Document.Class[], response:HTTP.Response.Class ):RDF.Document.Class {\n\t\tif ( rdfDocuments.length === 0 ) throw new HTTP.Errors.BadResponseError( \"No document was returned.\", response );\n\t\tif ( rdfDocuments.length > 1 ) throw new Error( \"Unsupported: Multiple graphs are currently not supported.\" );\n\t\treturn rdfDocuments[ 0 ];\n\t}\n\n\tprivate getPointerID( uri:string ):string {\n\t\tif( RDF.URI.Util.isBNodeID( uri ) ) throw new Errors.IllegalArgumentError( \"BNodes cannot be fetched directly.\" );\n\t\t// TODO: Make named fragments independently resolvable\n\t\t/*\n\t\t\tif( RDF.URI.Util.hasFragment( uri ) ) throw new Errors.IllegalArgumentError( \"Fragment URI's cannot be fetched directly.\" );\n\t\t*/\n\n\t\tif( !! this.context ) {\n\t\t\t// TODO: Check this, it may be incorrect\n\t\t\tif( RDF.URI.Util.isRelative( uri ) ) {\n\t\t\t\tlet baseURI:string = this.context.getBaseURI();\n\t\t\t\tif( ! RDF.URI.Util.isBaseOf( baseURI, uri ) ) return null;\n\n\t\t\t\treturn uri.substring( baseURI.length );\n\t\t\t} else {\n\t\t\t\treturn uri;\n\t\t\t}\n\t\t} else {\n\t\t\tif( RDF.URI.Util.isRelative( uri ) ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\treturn uri;\n\t\t}\n\t}\n\n\tprivate createPointer( localID:string ):Pointer.Class {\n\t\tlet id:string = !! this.context ? this.context.resolve( localID ) : localID;\n\t\tlet pointer:Pointer.Class = Pointer.Factory.create( id );\n\t\tObject.defineProperty( pointer, \"resolve\", {\n\t\t\twritable: false,\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: ():Promise<[ PersistedDocument.Class, HTTP.Response.Class ]> => {\n\t\t\t\treturn this.get( id );\n\t\t\t},\n\t\t});\n\n\t\treturn pointer;\n\t}\n\n\tprivate compact( expandedObjects:Object[], targetObjects:Object[], pointerLibrary:Pointer.Library ):Object[];\n\tprivate compact( expandedObject:Object, targetObject:Object, pointerLibrary:Pointer.Library ):Object;\n\tprivate compact( expandedObjectOrObjects:any, targetObjectOrObjects:any, pointerLibrary:Pointer.Library ):any {\n\t\tif( ! Utils.isArray( expandedObjectOrObjects ) ) return this.compactSingle( expandedObjectOrObjects, targetObjectOrObjects, pointerLibrary );\n\n\t\tlet expandedObjects:Object[] = expandedObjectOrObjects;\n\t\tlet targetObjects:Object[] = !! targetObjectOrObjects ? targetObjectOrObjects : [];\n\t\tfor( let i:number = 0, length:number = expandedObjects.length; i < length; i++ ) {\n\t\t\tlet expandedObject:Object = expandedObjects[ i ];\n\t\t\tlet targetObject:Object = targetObjects[ i ] = !! targetObjects[ i ] ? targetObjects[ i ] : {};\n\n\t\t\tthis.compactSingle( expandedObject, targetObject, pointerLibrary );\n\t\t}\n\n\t\treturn targetObjects;\n\t}\n\n\tprivate compactSingle( expandedObject:Object, targetObject:Object, pointerLibrary:Pointer.Library ):Object {\n\t\tlet digestedSchema:ObjectSchema.DigestedObjectSchema = this.getDigestedObjectSchemaForExpandedObject( expandedObject );\n\n\t\treturn this.jsonldConverter.compact( expandedObject, targetObject, digestedSchema, pointerLibrary );\n\t}\n\n\tprivate getDigestedObjectSchemaForExpandedObject( expandedObject:Object ):ObjectSchema.DigestedObjectSchema {\n\t\tlet types:string[] = this.getExpandedObjectTypes( expandedObject );\n\n\t\treturn this.getDigestedObjectSchema( types );\n\t}\n\n\tprivate getDigestedObjectSchemaForDocument( document:Document.Class ):ObjectSchema.DigestedObjectSchema {\n\t\tlet types:string[] = this.getDocumentTypes( document );\n\n\t\treturn this.getDigestedObjectSchema( types );\n\t}\n\n\tprivate getDigestedObjectSchema( objectTypes:string[] ):ObjectSchema.DigestedObjectSchema {\n\t\tlet digestedSchema:ObjectSchema.DigestedObjectSchema;\n\t\tif( !! this.context ) {\n\t\t\tlet typesDigestedObjectSchemas:ObjectSchema.DigestedObjectSchema[] = [ this.context.getObjectSchema() ];\n\t\t\tfor( let type of objectTypes ) {\n\t\t\t\tif( this.context.getObjectSchema( type ) ) typesDigestedObjectSchemas.push( this.context.getObjectSchema( type ) );\n\t\t\t}\n\n\t\t\tif( typesDigestedObjectSchemas.length > 1 ) {\n\t\t\t\tdigestedSchema = ObjectSchema.Digester.combineDigestedObjectSchemas( typesDigestedObjectSchemas );\n\t\t\t} else {\n\t\t\t\tdigestedSchema = typesDigestedObjectSchemas[ 0 ];\n\t\t\t}\n\t\t} else {\n\t\t\tdigestedSchema = new ObjectSchema.DigestedObjectSchema();\n\t\t}\n\n\t\treturn digestedSchema;\n\t}\n\n\tprivate getExpandedObjectTypes( expandedObject:Object ):string[] {\n\t\tif( ! expandedObject[ \"@type\" ] ) return [];\n\n\t\treturn expandedObject[ \"@type\" ];\n\t}\n\n\tprivate getDocumentTypes( document:Document.Class ):string[] {\n\t\tif( ! document.types ) return [];\n\t\treturn document.types;\n\t}\n}\n\nexport default Documents;\n"],"sourceRoot":"/source/"}