{"version":3,"sources":["Documents.ts"],"names":[],"mappings":"AAAA,gDAAgD;;;;;;IAuBhD,eAAgB,KAAY;QAC3B,IAAI,CAAC;YACJ,MAAM,CAAC,IAAI,CAAC,KAAK,CAAE,KAAK,CAAE,CAAC;QAC5B,CAAE;QAAA,KAAK,CAAC,CAAE,KAAM,CAAC,CAAC,CAAC;YAClB,2BAA2B;YAC3B,MAAM,KAAK,CAAC;QACb,CAAC;IACF,CAAC;IAED,gBAAiB,EAAoD,EAAE,OAA6B;YAAjF,cAAM,EAAE,gBAAQ;QAClC,MAAM,CAAC,IAAI,OAAO,CAAE,UAAE,OAAiC,EAAE,MAA4B;YACpF,MAAM,CAAC,MAAM,CAAE,MAAM,EAAE,OAAO,EAAE,UAAW,KAAS,EAAE,QAAe;gBACpE,EAAE,CAAC,CAAE,KAAM,CAAC,CAAC,CAAC;oBACb,mCAAmC;oBACnC,MAAM,KAAK,CAAC;gBACb,CAAC;gBAED,MAAM,GAAG,QAAQ,CAAC;gBAClB,OAAO,CAAE,CAAE,MAAM,EAAE,QAAQ,CAAE,CAAE,CAAC;YACjC,CAAC,CAAE,CAAC;QACL,CAAC,CAAE,CAAC;IACL,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAED;gBAQC,mBAAa,OAAsB;oBAAtB,uBAAsB,GAAtB,cAAsB;oBAClC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;oBAEvB,IAAI,CAAC,QAAQ,GAAG,IAAI,GAAG,EAAyB,CAAC;oBAEjD,EAAE,CAAA,CAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,CAAC,CAAE,IAAI,CAAC,OAAO,CAAC,aAAc,CAAC,CAAC,CAAC;wBACvD,IAAI,sBAAsB,GAAyB,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,SAAS,CAAC,eAAe,CAAC;wBACxG,IAAI,CAAC,gBAAgB,GAAG,IAAI,eAAe,CAAC,KAAK,CAAE,sBAAsB,CAAC,kBAAkB,CAAE,CAAC;oBAChG,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACP,IAAI,CAAC,gBAAgB,GAAG,IAAI,eAAe,CAAC,KAAK,EAAE,CAAC;oBACrD,CAAC;gBACF,CAAC;gBAhBD,sBAAI,sCAAe;yBAAnB,cAA8C,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC;;;mBAAA;gBAoB7E,2BAAO,GAAP,UAAS,WAAe;oBACvB,IAAI,EAAE,GAAU,OAAO,CAAC,OAAO,CAAC,EAAE,CAAE,WAAW,CAAE,GAAG,WAAW,CAAC,EAAE,GAAG,WAAW,CAAC;oBAEjF,EAAE,CAAA,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAE,EAAE,CAAG,CAAC;wBAAC,MAAM,CAAC,KAAK,CAAC;oBAEhD,EAAE,CAAA,CAAE,CAAC,CAAE,IAAI,CAAC,OAAQ,CAAC,CAAC,CAAC;wBACtB,IAAI,OAAO,GAAU,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC;wBAC/C,EAAE,CAAA,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAE,EAAE,CAAE,IAAI,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAE,OAAO,EAAE,EAAE,CAAG,CAAC;4BAAC,MAAM,CAAC,IAAI,CAAC;oBACzF,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACP,EAAE,CAAA,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAE,EAAE,CAAG,CAAC;4BAAC,MAAM,CAAC,IAAI,CAAC;oBACjD,CAAC;oBAED,EAAE,CAAA,CAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,CAAC,CAAE,IAAI,CAAC,OAAO,CAAC,aAAc,CAAC;wBAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,SAAS,CAAC,OAAO,CAAE,EAAE,CAAE,CAAC;oBAEjH,MAAM,CAAC,KAAK,CAAC;gBACd,CAAC;gBAED,8BAAU,GAAV,UAAY,EAAS;oBACpB,EAAE,GAAG,IAAI,CAAC,YAAY,CAAE,EAAE,CAAE,CAAC;oBAE7B,EAAE,CAAA,CAAE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAE,EAAE,CAAG,CAAC;wBAAC,MAAM,CAAC,IAAI,CAAC;oBAE1C,EAAE,CAAA,CAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,CAAC,CAAE,IAAI,CAAC,OAAO,CAAC,aAAc,CAAC;wBAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,SAAS,CAAC,UAAU,CAAE,EAAE,CAAE,CAAC;oBAEpH,MAAM,CAAC,KAAK,CAAC;gBACd,CAAC;gBAED,8BAAU,GAAV,UAAY,EAAS;oBACpB,IAAI,OAAO,GAAU,IAAI,CAAC,YAAY,CAAE,EAAE,CAAE,CAAC;oBAE7C,EAAE,CAAA,CAAE,CAAE,OAAQ,CAAC,CAAC,CAAC;wBAChB,EAAE,CAAA,CAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,CAAC,CAAE,IAAI,CAAC,OAAO,CAAC,aAAc,CAAC;4BAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,SAAS,CAAC,UAAU,CAAE,EAAE,CAAE,CAAC;wBACpH,MAAM,IAAI,MAAM,CAAC,oBAAoB,CAAE,iDAAiD,CAAE,CAAC;oBAC5F,CAAC;oBAED,IAAI,OAAqB,CAAC;oBAC1B,EAAE,CAAA,CAAE,CAAE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAE,OAAO,CAAG,CAAC,CAAC,CAAC;wBACrC,OAAO,GAAG,IAAI,CAAC,aAAa,CAAE,OAAO,CAAE,CAAC;wBACxC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAE,OAAO,EAAE,OAAO,CAAE,CAAC;oBACvC,CAAC;oBAED,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAE,OAAO,CAAE,CAAC;gBACrC,CAAC;gBAED,uBAAG,GAAH,UAAK,GAAU,EAAE,cAAwC;oBAAzD,iBA6DC;oBA7DgB,8BAAwC,GAAxC,mBAAwC;oBACxD,IAAI,SAAS,GAAU,IAAI,CAAC,YAAY,CAAE,GAAG,CAAE,CAAC;oBAChD,EAAE,CAAA,CAAE,CAAC,CAAE,IAAI,CAAC,OAAQ,CAAC;wBAAC,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAE,GAAG,CAAE,CAAC;oBAExD,EAAE,CAAA,CAAE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAE,SAAS,CAAG,CAAC,CAAC,CAAC;wBACrC,IAAI,SAAO,GAAiB,IAAI,CAAC,UAAU,CAAE,GAAG,CAAE,CAAC;wBACnD,EAAE,CAAA,CAAE,SAAO,CAAC,UAAU,EAAG,CAAC,CAAC,CAAC;4BAC3B,MAAM,CAAC,IAAI,OAAO,CAAE,UAAE,OAA0E,EAAE,MAA8B;gCAC/H,OAAO,CAAE,CAAQ,SAAO,EAAE,IAAI,CAAE,CAAE,CAAC;4BACpC,CAAC,CAAE,CAAC;wBACL,CAAC;oBACF,CAAC;oBAED,EAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAG,CAAC;wBAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAE,cAAc,CAAE,CAAC;oBAEjH,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAE,qBAAqB,EAAE,cAAc,CAAE,CAAC;oBAC3E,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,4BAA4B,CAAE,GAAG,CAAC,KAAK,CAAC,SAAS,EAAE,cAAc,CAAE,CAAC;oBAEtF,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAE,GAAG,EAAE,cAAc,CAAE,CAAC,IAAI,CAAE,UAAE,QAA4B;wBAC1F,IAAI,YAAY,GAAU,KAAK,CAAE,QAAQ,CAAC,IAAI,CAAE,CAAC;wBAEjD,MAAM,CAAC,MAAM,CAAE,CAAE,YAAY,EAAE,QAAQ,CAAE,CAAE,CAAC;oBAC7C,CAAC,CAAE,CAAC,IAAI,CAAE,UAAE,EAA4D;4BAA1D,sBAAc,EAAE,gBAAQ;wBACrC,IAAI,IAAI,GAAU,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAE,QAAQ,CAAE,CAAC;wBACzD,EAAE,CAAA,CAAE,IAAI,KAAK,IAAK,CAAC;4BAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,sCAAsC,EAAE,QAAQ,CAAE,CAAC;wBAE/G,IAAI,YAAY,GAAwB,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAE,cAAc,CAAE,CAAC;wBACzF,IAAI,WAAW,GAAsB,KAAI,CAAC,cAAc,CAAE,GAAG,EAAE,YAAY,EAAE,QAAQ,CAAE,CAAC;wBACxF,EAAE,CAAC,CAAE,WAAW,KAAK,IAAK,CAAC;4BAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,2BAA2B,EAAE,QAAQ,CAAE,CAAC;wBAE5G,IAAI,iBAAiB,GAAoB,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,oBAAoB,CAAE,WAAW,CAAE,CAAC;wBAC/F,EAAE,CAAA,CAAE,iBAAiB,CAAC,MAAM,GAAG,CAAE,CAAC;4BAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,2DAA2D,EAAE,QAAQ,CAAE,CAAC;wBACnJ,EAAE,CAAA,CAAE,iBAAiB,CAAC,MAAM,KAAK,CAAE,CAAC;4BAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,uDAAuD,EAAE,QAAQ,CAAE,CAAC;wBAEjJ,IAAI,gBAAgB,GAAkB,iBAAiB,CAAE,CAAC,CAAE,CAAC;wBAC7D,IAAI,iBAAiB,GAAoB,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAE,WAAW,CAAE,CAAC;wBAC5F,IAAI,sBAAsB,GAAoB,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,oBAAoB,CAAE,WAAW,CAAE,CAAC;wBAEpG,IAAI,eAAe,GAAiB,KAAI,CAAC,UAAU,CAAE,GAAG,CAAE,CAAC;wBAC3D,eAAe,CAAC,SAAS,GAAG,IAAI,CAAC;wBAEjC,IAAI,QAAQ,GAA2B,iBAAiB,CAAC,OAAO,CAAC,UAAU,CAAE,eAAe,EAAE,GAAG,EAAE,KAAI,CAAE,CAAC;wBAC1G,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC;wBAEtB,IAAI,SAAS,GAAoB,EAAE,CAAC;wBACpC,GAAG,CAAA,CAA0B,UAAiB,EAAjB,uCAAiB,EAAjB,+BAAiB,EAAjB,IAAkB,CAAC;4BAA3C,IAAI,gBAAgB,0BAAA;4BACxB,SAAS,CAAC,IAAI,CAAE,QAAQ,CAAC,cAAc,CAAE,gBAAgB,CAAE,KAAK,CAAE,CAAE,CAAE,CAAC;yBACvE;wBAED,IAAI,cAAc,GAAyB,EAAE,CAAC;wBAC9C,GAAG,CAAA,CAA+B,UAAsB,EAAtB,iDAAsB,EAAtB,oCAAsB,EAAtB,IAAuB,CAAC;4BAArD,IAAI,qBAAqB,+BAAA;4BAC7B,cAAc,CAAC,IAAI,CAAE,QAAQ,CAAC,mBAAmB,CAAE,qBAAqB,CAAE,KAAK,CAAE,CAAE,CAAE,CAAC;yBACtF;wBAED,KAAI,CAAC,OAAO,CAAE,gBAAgB,EAAE,QAAQ,EAAE,QAAQ,CAAE,CAAC;wBACrD,KAAI,CAAC,OAAO,CAAE,iBAAiB,EAAE,SAAS,EAAE,QAAQ,CAAE,CAAC;wBACvD,KAAI,CAAC,OAAO,CAAE,sBAAsB,EAAE,cAAc,EAAE,QAAQ,CAAE,CAAC;wBAEjE,4DAA4D;wBAC5D,MAAM,CAAC,CAAE,QAAQ,EAAE,QAAQ,CAAE,CAAC;oBAC/B,CAAC,CAAE,CAAC;gBACL,CAAC;gBAID,+BAAW,GAAX,UAAa,SAAgB,EAAE,mBAAuB,EAAE,6BAAsC,EAAE,cAAwC;oBAAxI,iBAoCC;oBApCuD,6CAAsC,GAAtC,kCAAsC;oBAAE,8BAAwC,GAAxC,mBAAwC;oBACvI,IAAI,IAAI,GAAU,KAAK,CAAC,QAAQ,CAAE,mBAAmB,CAAE,GAAG,mBAAmB,GAAG,IAAI,CAAC;oBACrF,IAAI,aAAa,GAAkB,CAAE,KAAK,CAAC,QAAQ,CAAE,mBAAmB,CAAE,GAAG,mBAAmB,GAAG,6BAA6B,CAAC;oBACjI,cAAc,GAAG,CAAE,KAAK,CAAC,QAAQ,CAAE,mBAAmB,CAAE,GAAG,6BAA6B,GAAG,cAAc,CAAC;oBAE1G,EAAE,CAAA,CAAE,iBAAiB,CAAC,OAAO,CAAC,EAAE,CAAE,aAAa,CAAG,CAAC;wBAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,qBAAqB,CAAE,IAAI,MAAM,CAAC,oBAAoB,CAAE,wDAAwD,CAAE,CAAE,CAAC;oBAExL,EAAE,CAAA,CAAE,aAAa,CAAC,EAAG,CAAC,CAAC,CAAC;wBACvB,EAAE,CAAA,CAAE,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAE,SAAS,EAAE,aAAa,CAAC,EAAE,CAAG,CAAC;4BAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,qBAAqB,CAAE,IAAI,MAAM,CAAC,oBAAoB,CAAE,oEAAoE,CAAE,CAAE,CAAC;oBAC9M,CAAC;oBAED,EAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAG,CAAC;wBAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAE,cAAc,CAAE,CAAC;oBAEjH,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAE,qBAAqB,EAAE,cAAc,CAAE,CAAC;oBAC3E,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,CAAE,qBAAqB,EAAE,cAAc,CAAE,CAAC;oBAChF,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,4BAA4B,CAAE,GAAG,CAAC,KAAK,CAAC,SAAS,EAAE,cAAc,CAAE,CAAC;oBAEtF,EAAE,CAAA,CAAE,IAAI,KAAK,IAAK,CAAC;wBAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAE,IAAI,EAAE,cAAc,CAAE,CAAC;oBAEtE,IAAI,IAAI,GAAU,aAAa,CAAC,MAAM,CAAE,IAAI,EAAE,IAAI,CAAC,eAAe,CAAE,CAAC;oBAErE,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAE,SAAS,EAAE,IAAI,EAAE,cAAc,CAAE,CAAC,IAAI,CACvE,UAAE,QAA4B;wBAC7B,IAAI,cAAc,GAAqB,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAE,UAAU,CAAE,CAAC;wBAC1E,EAAE,CAAA,CAAE,cAAc,KAAK,IAAI,IAAI,cAAc,CAAC,MAAM,CAAC,MAAM,GAAG,CAAE,CAAC;4BAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,4CAA4C,EAAE,QAAQ,CAAE,CAAC;wBACnK,EAAE,CAAA,CAAE,cAAc,CAAC,MAAM,CAAC,MAAM,KAAK,CAAE,CAAC;4BAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,sDAAsD,EAAE,QAAQ,CAAE,CAAC;wBAEpJ,IAAI,WAAW,GAAU,cAAc,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC;wBAC7D,IAAI,OAAO,GAAiB,KAAI,CAAC,UAAU,CAAE,WAAW,CAAC,CAAC;wBAE1D,MAAM,CAAC;4BACN,OAAO;4BACP,QAAQ;yBACR,CAAC;oBACH,CAAC,CACD,CAAC;gBACH,CAAC;gBAMD,8BAAU,GAAV,UAAY,GAAU,EAAE,kCAA6C,EAAE,cAAwC;oBAA/G,iBA4DC;oBA5DuB,kDAA6C,GAA7C,yCAA6C;oBAAE,8BAAwC,GAAxC,mBAAwC;oBAC9G,IAAI,kBAAkB,GAAW,KAAK,CAAC,SAAS,CAAE,kCAAkC,CAAE,GAAG,kCAAkC,GAAG,IAAI,CAAC;oBACnI,cAAc,GAAG,KAAK,CAAC,QAAQ,CAAE,kCAAkC,CAAE,IAAI,kCAAkC,KAAK,IAAI,GAAG,kCAAkC,GAAG,cAAc,CAAC;oBAE3K,EAAE,CAAA,CAAE,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAE,GAAG,CAAG,CAAC,CAAC,CAAC;wBACvC,EAAE,CAAA,CAAE,CAAE,IAAI,CAAC,OAAQ,CAAC;4BAAC,MAAM,IAAI,MAAM,CAAC,oBAAoB,CAAE,wDAAwD,CAAE,CAAC;wBACvH,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAE,GAAG,CAAE,CAAC;oBACnC,CAAC;oBAED,EAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAG,CAAC;wBAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAE,cAAc,CAAE,CAAC;oBAEjH,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAE,qBAAqB,EAAE,cAAc,CAAE,CAAC;oBAC3E,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,4BAA4B,CAAE,GAAG,CAAC,KAAK,CAAC,SAAS,EAAE,cAAc,CAAE,CAAC;oBAEtF,IAAI,6BAA6B,GAA8C;wBAC9E,OAAO,EAAE;4BACR,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,sBAAsB;4BACnC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,gBAAgB;yBAC7B;wBACD,IAAI,EAAE;4BACL,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,iBAAiB;4BAC9B,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,0BAA0B;4BACrC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,yBAAyB;yBACpC;qBACD,CAAC;oBAEF,EAAE,CAAA,CAAE,kBAAmB,CAAC,CAAC,CAAC;wBACzB,6BAA6B,CAAC,OAAO,CAAC,IAAI,CAAE,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,oCAAoC,CAAE,CAAC;oBAC/F,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACP,6BAA6B,CAAC,IAAI,CAAC,IAAI,CAAE,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,oCAAoC,CAAE,CAAC;oBAC5F,CAAC;oBAED,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAE,GAAG,EAAE,cAAc,EAAE,IAAI,GAAG,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAE,CAAC,IAAI,CAAE,UAAE,EAAwE;4BAAtE,oBAAY,EAAE,gBAAQ;wBACjH,IAAI,WAAW,GAAsB,KAAI,CAAC,cAAc,CAAE,GAAG,EAAE,YAAY,EAAE,QAAQ,CAAE,CAAC;wBACxF,EAAE,CAAC,CAAE,WAAW,KAAK,IAAK,CAAC;4BAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,2BAA2B,EAAE,QAAQ,CAAE,CAAC;wBAE5G,IAAI,gBAAgB,GAAkB,KAAI,CAAC,mBAAmB,CAAE,WAAW,EAAE,QAAQ,CAAE,CAAC;wBACxF,IAAI,qBAAqB,GAAU,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAE,gBAAgB,EAAE,EAAE,CAAC,GAAG,CAAC,SAAS,CAAC,kBAAkB,CAAE,CAAC;wBAEzH,IAAI,kBAAiC,CAAC;wBACtC,EAAE,CAAA,CAAE,gBAAgB,CAAE,KAAK,CAAE,KAAK,qBAAsB,CAAC,CAAC,CAAC;4BAC1D,kBAAkB,GAAG,gBAAgB,CAAC;wBACvC,CAAC;wBAAC,IAAI,CAAC,EAAE,CAAA,CAAE,qBAAqB,KAAK,IAAK,CAAC,CAAC,CAAC;4BAC5C,EAAE,CAAA,CAAE,gBAAgB,CAAE,OAAO,CAAE,CAAC,OAAO,CAAE,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,cAAc,CAAE,KAAK,CAAC,CAAE,CAAC,CAAC,CAAC;gCAChF,kBAAkB,GAAG,gBAAgB,CAAC;4BACvC,CAAC;4BAAC,IAAI,CAAC,CAAC;gCACP,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,oGAAoG,EAAE,QAAQ,CAAE,CAAC;4BAC1J,CAAC;wBACF,CAAC;wBAAC,IAAI,CAAC,CAAC;4BACP,IAAI,0BAA0B,GAAsB,KAAI,CAAC,cAAc,CAAE,qBAAqB,EAAE,YAAY,EAAE,QAAQ,CAAE,CAAC;4BACzH,EAAE,CAAC,CAAE,0BAA0B,KAAK,IAAK,CAAC;gCAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,mEAAmE,EAAE,QAAQ,CAAE,CAAC;4BACnK,kBAAkB,GAAG,KAAI,CAAC,mBAAmB,CAAE,0BAA0B,EAAE,QAAQ,CAAE,CAAC;wBACvF,CAAC;wBAED,IAAI,iBAAiB,GAAU,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAE,gBAAgB,EAAE,EAAE,CAAC,GAAG,CAAC,SAAS,CAAC,iBAAiB,CAAE,CAAC;wBAEpH,IAAI,cAAc,GAAmB,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,mBAAmB,CAAE,kBAAkB,EAAE,iBAAiB,EAAE,KAAI,CAAE,CAAC;wBAEvH,MAAM,CAAC,CAAE,cAAc,EAAE,QAAQ,CAAE,CAAC;oBACrC,CAAC,CAAC,CAAC;gBACJ,CAAC;gBAED,wBAAI,GAAJ,UAAM,iBAAyC,EAAE,cAAwC;oBACxF,sCAAsC;oBACtC;;;;sBAIE;oBAN8C,8BAAwC,GAAxC,mBAAwC;oBAQxF,EAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAG,CAAC;wBAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAE,cAAc,CAAE,CAAC;oBAEjH,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAE,qBAAqB,EAAE,cAAc,CAAE,CAAC;oBAC3E,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,CAAE,qBAAqB,EAAE,cAAc,CAAE,CAAC;oBAChF,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,4BAA4B,CAAE,GAAG,CAAC,KAAK,CAAC,SAAS,EAAE,cAAc,CAAE,CAAC;oBACtF,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,gBAAgB,CAAE,iBAAiB,CAAC,KAAK,EAAE,cAAc,CAAE,CAAC;oBAE9E,IAAI,IAAI,GAAU,iBAAiB,CAAC,MAAM,CAAE,IAAI,EAAE,IAAI,CAAC,eAAe,CAAE,CAAC;oBAEzE,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAE,iBAAiB,CAAC,EAAE,EAAE,IAAI,EAAE,cAAc,CAAE,CAAC,IAAI,CAAE,UAAE,QAA4B;wBACjH,MAAM,CAAC,CAAE,iBAAiB,EAAE,QAAQ,CAAE,CAAC;oBACxC,CAAC,CAAC,CAAC;gBACJ,CAAC;gBAED,0BAAM,GAAN,UAAQ,iBAAyC,EAAE,cAAwC;oBAAxC,8BAAwC,GAAxC,mBAAwC;oBAC1F,EAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAG,CAAC;wBAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAE,cAAc,CAAE,CAAC;oBAEjH,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,CAAE,qBAAqB,EAAE,cAAc,CAAE,CAAC;oBAC3E,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,4BAA4B,CAAE,GAAG,CAAC,KAAK,CAAC,SAAS,EAAE,cAAc,CAAE,CAAC;oBACtF,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,gBAAgB,CAAE,iBAAiB,CAAC,KAAK,EAAE,cAAc,CAAE,CAAC;oBAE9E,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAE,iBAAiB,CAAC,EAAE,EAAE,iBAAiB,CAAC,MAAM,EAAE,EAAE,cAAc,CAAE,CAAC;gBACxG,CAAC;gBAED,gCAAY,GAAZ,UAAc,MAAa;oBAC1B,EAAE,CAAA,CAAE,KAAK,IAAI,MAAO,CAAC,CAAC,CAAC;wBACtB,MAAM,CAAC,IAAI,CAAC,wCAAwC,CAAE,MAAM,CAAE,CAAC;oBAChE,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACP,MAAM,CAAC,IAAI,CAAC,kCAAkC,CAAQ,MAAM,CAAE,CAAC;oBAChE,CAAC;gBACF,CAAC;gBAED,sCAAkB,GAAlB,UAAoB,WAAkB,EAAE,QAAe,EAAE,cAAwC;oBAAxC,8BAAwC,GAAxC,mBAAwC;oBAChG,EAAE,CAAA,CAAE,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAE,WAAW,CAAG,CAAC,CAAC,CAAC;wBAC/C,EAAE,CAAA,CAAE,CAAE,IAAI,CAAC,OAAQ,CAAC;4BAAC,MAAM,IAAI,MAAM,CAAC,oBAAoB,CAAE,wDAAwD,CAAE,CAAC;wBACvH,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAE,WAAW,CAAE,CAAC;oBACnD,CAAC;oBAED,EAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAG,CAAC;wBAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAE,cAAc,CAAE,CAAC;oBAEjH,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,kBAAkB,CAAE,WAAW,EAAE,QAAQ,EAAE,cAAc,CAAE,CAAC;gBACnF,CAAC;gBAED,mCAAe,GAAf,UAAiB,WAAkB,EAAE,QAAe,EAAE,cAAwC;oBAAxC,8BAAwC,GAAxC,mBAAwC;oBAC7F,EAAE,CAAA,CAAE,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAE,WAAW,CAAG,CAAC,CAAC,CAAC;wBAC/C,EAAE,CAAA,CAAE,CAAE,IAAI,CAAC,OAAQ,CAAC;4BAAC,MAAM,IAAI,MAAM,CAAC,oBAAoB,CAAE,wDAAwD,CAAE,CAAC;wBACvH,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAE,WAAW,CAAE,CAAC;oBACnD,CAAC;oBAED,EAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAG,CAAC;wBAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAE,cAAc,CAAE,CAAC;oBAEjH,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,eAAe,CAAE,WAAW,EAAE,QAAQ,EAAE,cAAc,CAAE,CAAC;gBAChF,CAAC;gBAED,yCAAqB,GAArB,UAAuB,WAAkB,EAAE,WAAkB,EAAE,cAAwC;oBAAxC,8BAAwC,GAAxC,mBAAwC;oBACtG,EAAE,CAAA,CAAE,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAE,WAAW,CAAG,CAAC,CAAC,CAAC;wBAC/C,EAAE,CAAA,CAAE,CAAE,IAAI,CAAC,OAAQ,CAAC;4BAAC,MAAM,IAAI,MAAM,CAAC,oBAAoB,CAAE,wDAAwD,CAAE,CAAC;wBACvH,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAE,WAAW,CAAE,CAAC;oBACnD,CAAC;oBAED,EAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAG,CAAC;wBAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAE,cAAc,CAAE,CAAC;oBAEjH,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,qBAAqB,CAAE,WAAW,EAAE,WAAW,EAAE,cAAc,CAAE,CAAC;gBACzF,CAAC;gBAED,sCAAkB,GAAlB,UAAoB,WAAkB,EAAE,WAAkB,EAAE,cAAwC;oBAAxC,8BAAwC,GAAxC,mBAAwC;oBACnG,EAAE,CAAA,CAAE,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAE,WAAW,CAAG,CAAC,CAAC,CAAC;wBAC/C,EAAE,CAAA,CAAE,CAAE,IAAI,CAAC,OAAQ,CAAC;4BAAC,MAAM,IAAI,MAAM,CAAC,oBAAoB,CAAE,wDAAwD,CAAE,CAAC;wBACvH,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAE,WAAW,CAAE,CAAC;oBACnD,CAAC;oBAED,EAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAG,CAAC;wBAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAE,cAAc,CAAE,CAAC;oBAEjH,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,kBAAkB,CAAE,WAAW,EAAE,WAAW,EAAE,IAAI,EAAE,cAAc,CAAE,CAAC;gBAC5F,CAAC;gBAED,4CAAwB,GAAxB,UAA0B,WAAkB,EAAE,cAAqB,EAAE,cAAwC;oBAAxC,8BAAwC,GAAxC,mBAAwC;oBAC5G,EAAE,CAAA,CAAE,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAE,WAAW,CAAG,CAAC,CAAC,CAAC;wBAC/C,EAAE,CAAA,CAAE,CAAE,IAAI,CAAC,OAAQ,CAAC;4BAAC,MAAM,IAAI,MAAM,CAAC,oBAAoB,CAAE,wDAAwD,CAAE,CAAC;wBACvH,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAE,WAAW,CAAE,CAAC;oBACnD,CAAC;oBAED,EAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAG,CAAC;wBAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAE,cAAc,CAAE,CAAC;oBAEjH,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,wBAAwB,CAAE,WAAW,EAAE,cAAc,EAAE,cAAc,CAAE,CAAC;gBAC/F,CAAC;gBAED,2CAAuB,GAAvB,UAAyB,WAAkB,EAAE,cAAqB,EAAE,cAAwC;oBAAxC,8BAAwC,GAAxC,mBAAwC;oBAC3G,EAAE,CAAA,CAAE,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAE,WAAW,CAAG,CAAC,CAAC,CAAC;wBAC/C,EAAE,CAAA,CAAE,CAAE,IAAI,CAAC,OAAQ,CAAC;4BAAC,MAAM,IAAI,MAAM,CAAC,oBAAoB,CAAE,wDAAwD,CAAE,CAAC;wBACvH,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAE,WAAW,CAAE,CAAC;oBACnD,CAAC;oBAED,EAAE,CAAC,CAAE,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAG,CAAC;wBAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,iBAAiB,CAAE,cAAc,CAAE,CAAC;oBAEjH,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,uBAAuB,CAAE,WAAW,EAAE,cAAc,EAAE,cAAc,CAAE,CAAC;gBAC9F,CAAC;gBAEO,kCAAc,GAAtB,UAAwB,UAAiB,EAAE,YAAiC,EAAE,QAA4B;oBACzG,YAAY,GAAG,YAAY,CAAC,MAAM,CAAE,UAAE,WAA8B,IAAM,OAAA,WAAW,CAAE,KAAK,CAAE,KAAK,UAAU,EAAnC,CAAmC,CAAE,CAAC;oBAEhH,EAAE,CAAC,CAAE,YAAY,CAAC,MAAM,GAAG,CAAE,CAAC;wBAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,sCAAsC,EAAE,QAAQ,CAAE,CAAC;oBAE1H,MAAM,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,GAAG,YAAY,CAAE,CAAC,CAAE,GAAG,IAAI,CAAC;gBAC3D,CAAC;gBAEO,uCAAmB,GAA3B,UAA6B,WAA8B,EAAE,QAA4B;oBACxF,IAAI,iBAAiB,GAAoB,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,oBAAoB,CAAE,WAAW,CAAE,CAAC;oBAC/F,EAAE,CAAC,CAAE,iBAAiB,CAAC,MAAM,KAAK,CAAE,CAAC;wBAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,sBAAqB,WAAW,CAAE,KAAK,CAAE,2CAAyC,EAAE,QAAQ,CAAE,CAAC;oBAC7K,EAAE,CAAC,CAAE,iBAAiB,CAAC,MAAM,GAAG,CAAE,CAAC;wBAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAE,sBAAqB,WAAW,CAAE,KAAK,CAAE,gDAA8C,EAAE,QAAQ,CAAE,CAAC;oBAEhL,MAAM,CAAC,iBAAiB,CAAE,CAAC,CAAE,CAAC;gBAC/B,CAAC;gBAEO,gCAAY,GAApB,UAAsB,GAAU;oBAC/B,EAAE,CAAA,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,CAAE,GAAG,CAAG,CAAC;wBAAC,MAAM,IAAI,MAAM,CAAC,oBAAoB,CAAE,oCAAoC,CAAE,CAAC;oBAClH,sDAAsD;oBACtD;;sBAEE;oBAEF,EAAE,CAAA,CAAE,CAAC,CAAE,IAAI,CAAC,OAAQ,CAAC,CAAC,CAAC;wBACtB,wCAAwC;wBACxC,EAAE,CAAA,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAE,GAAG,CAAG,CAAC,CAAC,CAAC;4BACrC,IAAI,OAAO,GAAU,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC;4BAC/C,EAAE,CAAA,CAAE,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAE,OAAO,EAAE,GAAG,CAAG,CAAC;gCAAC,MAAM,CAAC,IAAI,CAAC;4BAE1D,MAAM,CAAC,GAAG,CAAC,SAAS,CAAE,OAAO,CAAC,MAAM,CAAE,CAAC;wBACxC,CAAC;wBAAC,IAAI,CAAC,CAAC;4BACP,MAAM,CAAC,GAAG,CAAC;wBACZ,CAAC;oBACF,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACP,EAAE,CAAA,CAAE,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAE,GAAG,CAAG,CAAC;4BAAC,MAAM,IAAI,MAAM,CAAC,oBAAoB,CAAE,wDAAwD,CAAE,CAAC;wBACvI,MAAM,CAAC,GAAG,CAAC;oBACZ,CAAC;gBACF,CAAC;gBAEO,iCAAa,GAArB,UAAuB,OAAc;oBAArC,iBAaC;oBAZA,IAAI,EAAE,GAAU,CAAC,CAAE,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,CAAE,OAAO,CAAE,GAAG,OAAO,CAAC;oBAC5E,IAAI,OAAO,GAAiB,OAAO,CAAC,OAAO,CAAC,MAAM,CAAE,EAAE,CAAE,CAAC;oBACzD,MAAM,CAAC,cAAc,CAAE,OAAO,EAAE,SAAS,EAAE;wBAC1C,QAAQ,EAAE,KAAK;wBACf,UAAU,EAAE,KAAK;wBACjB,YAAY,EAAE,IAAI;wBAClB,KAAK,EAAE;4BACN,MAAM,CAAC,KAAI,CAAC,GAAG,CAAE,EAAE,CAAE,CAAC;wBACvB,CAAC;qBACD,CAAC,CAAC;oBAEH,MAAM,CAAC,OAAO,CAAC;gBAChB,CAAC;gBAIO,2BAAO,GAAf,UAAiB,uBAA2B,EAAE,qBAAyB,EAAE,cAA8B;oBACtG,EAAE,CAAA,CAAE,CAAE,KAAK,CAAC,OAAO,CAAE,uBAAuB,CAAG,CAAC;wBAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAE,uBAAuB,EAAE,qBAAqB,EAAE,cAAc,CAAE,CAAC;oBAE7I,IAAI,eAAe,GAAY,uBAAuB,CAAC;oBACvD,IAAI,aAAa,GAAY,CAAC,CAAE,qBAAqB,GAAG,qBAAqB,GAAG,EAAE,CAAC;oBACnF,GAAG,CAAA,CAAE,IAAI,CAAC,GAAU,CAAC,EAAE,QAAM,GAAU,eAAe,CAAC,MAAM,EAAE,CAAC,GAAG,QAAM,EAAE,CAAC,EAAE,EAAG,CAAC;wBACjF,IAAI,cAAc,GAAU,eAAe,CAAE,CAAC,CAAE,CAAC;wBACjD,IAAI,YAAY,GAAU,aAAa,CAAE,CAAC,CAAE,GAAG,CAAC,CAAE,aAAa,CAAE,CAAC,CAAE,GAAG,aAAa,CAAE,CAAC,CAAE,GAAG,EAAE,CAAC;wBAE/F,IAAI,CAAC,aAAa,CAAE,cAAc,EAAE,YAAY,EAAE,cAAc,CAAE,CAAC;oBACpE,CAAC;oBAED,MAAM,CAAC,aAAa,CAAC;gBACtB,CAAC;gBAEO,iCAAa,GAArB,UAAuB,cAAqB,EAAE,YAAmB,EAAE,cAA8B;oBAChG,IAAI,cAAc,GAAqC,IAAI,CAAC,wCAAwC,CAAE,cAAc,CAAE,CAAC;oBAEvH,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,OAAO,CAAE,cAAc,EAAE,YAAY,EAAE,cAAc,EAAE,cAAc,CAAE,CAAC;gBACrG,CAAC;gBAEO,4DAAwC,GAAhD,UAAkD,cAAqB;oBACtE,IAAI,KAAK,GAAY,IAAI,CAAC,sBAAsB,CAAE,cAAc,CAAE,CAAC;oBAEnE,MAAM,CAAC,IAAI,CAAC,uBAAuB,CAAE,KAAK,CAAE,CAAC;gBAC9C,CAAC;gBAEO,sDAAkC,GAA1C,UAA4C,QAAuB;oBAClE,IAAI,KAAK,GAAY,IAAI,CAAC,gBAAgB,CAAE,QAAQ,CAAE,CAAC;oBAEvD,MAAM,CAAC,IAAI,CAAC,uBAAuB,CAAE,KAAK,CAAE,CAAC;gBAC9C,CAAC;gBAEO,2CAAuB,GAA/B,UAAiC,WAAoB;oBACpD,IAAI,cAAgD,CAAC;oBACrD,EAAE,CAAA,CAAE,CAAC,CAAE,IAAI,CAAC,OAAQ,CAAC,CAAC,CAAC;wBACtB,IAAI,0BAA0B,GAAuC,CAAE,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAE,CAAC;wBACxG,GAAG,CAAA,CAAc,UAAW,EAAX,2BAAW,EAAX,yBAAW,EAAX,IAAY,CAAC;4BAAzB,IAAI,IAAI,oBAAA;4BACZ,EAAE,CAAA,CAAE,IAAI,CAAC,OAAO,CAAC,eAAe,CAAE,IAAI,CAAG,CAAC;gCAAC,0BAA0B,CAAC,IAAI,CAAE,IAAI,CAAC,OAAO,CAAC,eAAe,CAAE,IAAI,CAAE,CAAE,CAAC;yBACnH;wBAED,EAAE,CAAA,CAAE,0BAA0B,CAAC,MAAM,GAAG,CAAE,CAAC,CAAC,CAAC;4BAC5C,cAAc,GAAG,YAAY,CAAC,QAAQ,CAAC,4BAA4B,CAAE,0BAA0B,CAAE,CAAC;wBACnG,CAAC;wBAAC,IAAI,CAAC,CAAC;4BACP,cAAc,GAAG,0BAA0B,CAAE,CAAC,CAAE,CAAC;wBAClD,CAAC;oBACF,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACP,cAAc,GAAG,IAAI,YAAY,CAAC,oBAAoB,EAAE,CAAC;oBAC1D,CAAC;oBAED,MAAM,CAAC,cAAc,CAAC;gBACvB,CAAC;gBAEO,0CAAsB,GAA9B,UAAgC,cAAqB;oBACpD,EAAE,CAAA,CAAE,CAAE,cAAc,CAAE,OAAO,CAAG,CAAC;wBAAC,MAAM,CAAC,EAAE,CAAC;oBAE5C,MAAM,CAAC,cAAc,CAAE,OAAO,CAAE,CAAC;gBAClC,CAAC;gBAEO,oCAAgB,GAAxB,UAA0B,QAAuB;oBAChD,EAAE,CAAA,CAAE,CAAE,QAAQ,CAAC,KAAM,CAAC;wBAAC,MAAM,CAAC,EAAE,CAAC;oBACjC,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC;gBACvB,CAAC;gBACF,gBAAC;YAAD,CA7cA,AA6cC,IAAA;YAED,oBAAe,SAAS,EAAC","file":"Documents.js","sourcesContent":["/// <reference path=\"../typings/typings.d.ts\" />\n\nimport * as jsonld from \"jsonld\";\n\nimport Committer from \"./Committer\";\nimport * as Errors from \"./Errors\";\nimport * as HTTP from \"./HTTP\";\nimport Context from \"./Context\";\nimport * as RDF from \"./RDF\";\nimport * as Utils from \"./Utils\";\n\nimport * as Document from \"./Document\";\nimport * as Fragment from \"./Fragment\";\nimport * as JSONLDConverter from \"./JSONLDConverter\";\nimport * as PersistedDocument from \"./PersistedDocument\";\nimport * as Pointer from \"./Pointer\";\nimport * as NamedFragment from \"./NamedFragment\";\nimport * as NS from \"./NS\";\nimport * as ObjectSchema from \"./ObjectSchema\";\nimport * as LDP from \"./NS/LDP\";\nimport * as Resource from \"./Resource\";\nimport * as SPARQL from \"./SPARQL\";\n\nfunction parse( input:string ):any {\n\ttry {\n\t\treturn JSON.parse( input );\n\t} catch ( error ) {\n\t\t// TODO: Handle SyntaxError\n\t\tthrow error;\n\t}\n}\n\nfunction expand( [ result, response ]:[ Object, HTTP.Response.Class ], options?:jsonld.ExpandOptions ):Promise<[ Object, HTTP.Response.Class ]> {\n\treturn new Promise( ( resolve:( result:Object ) => void, reject:( error:any ) => void ) => {\n\t\tjsonld.expand( result, options, function ( error:any, expanded:Object ):void {\n\t\t\tif ( error ) {\n\t\t\t\t// TODO: Handle jsonld.expand error\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\tresult = expanded;\n\t\t\tresolve( [ result, response ] );\n\t\t} );\n\t} );\n}\n\nclass Documents implements Pointer.Library, Pointer.Validator, ObjectSchema.Resolver {\n\t_jsonldConverter:JSONLDConverter.Class;\n\n\tget jsonldConverter():JSONLDConverter.Class { return this._jsonldConverter; }\n\n\tprivate context:Context;\n\tprivate pointers:Map<string, Pointer.Class>;\n\n\tconstructor( context:Context = null ) {\n\t\tthis.context = context;\n\n\t\tthis.pointers = new Map<string, Pointer.Class>();\n\n\t\tif( !! this.context && !! this.context.parentContext ) {\n\t\t\tlet contextJSONLDConverter:JSONLDConverter.Class = this.context.parentContext.documents.jsonldConverter;\n\t\t\tthis._jsonldConverter = new JSONLDConverter.Class( contextJSONLDConverter.literalSerializers );\n\t\t} else {\n\t\t\tthis._jsonldConverter = new JSONLDConverter.Class();\n\t\t}\n\t}\n\n\tinScope( pointer:Pointer.Class ):boolean;\n\tinScope( id:string ):boolean;\n\tinScope( idOrPointer:any ):boolean {\n\t\tlet id:string = Pointer.Factory.is( idOrPointer ) ? idOrPointer.id : idOrPointer;\n\n\t\tif( RDF.URI.Util.isBNodeID( id ) ) return false;\n\n\t\tif( !! this.context ) {\n\t\t\tlet baseURI:string = this.context.getBaseURI();\n\t\t\tif( RDF.URI.Util.isAbsolute( id ) && RDF.URI.Util.isBaseOf( baseURI, id ) ) return true;\n\t\t} else {\n\t\t\tif( RDF.URI.Util.isAbsolute( id ) ) return true;\n\t\t}\n\n\t\tif( !! this.context && !! this.context.parentContext ) return this.context.parentContext.documents.inScope( id );\n\n\t\treturn false;\n\t}\n\n\thasPointer( id:string ):boolean {\n\t\tid = this.getPointerID( id );\n\n\t\tif( this.pointers.has( id ) ) return true;\n\n\t\tif( !! this.context && !! this.context.parentContext ) return this.context.parentContext.documents.hasPointer( id );\n\n\t\treturn false;\n\t}\n\n\tgetPointer( id:string ):Pointer.Class {\n\t\tlet localID:string = this.getPointerID( id );\n\n\t\tif( ! localID ) {\n\t\t\tif( !! this.context && !! this.context.parentContext ) return this.context.parentContext.documents.getPointer( id );\n\t\t\tthrow new Errors.IllegalArgumentError( \"The pointer id is not supported by this module.\" );\n\t\t}\n\n\t\tlet pointer:Pointer.Class;\n\t\tif( ! this.pointers.has( localID ) ) {\n\t\t\tpointer = this.createPointer( localID );\n\t\t\tthis.pointers.set( localID, pointer );\n\t\t}\n\n\t\treturn this.pointers.get( localID );\n\t}\n\n\tget( uri:string, requestOptions:HTTP.Request.Options = {} ):Promise<[ PersistedDocument.Class, HTTP.Response.Class ]> {\n\t\tlet pointerID:string = this.getPointerID( uri );\n\t\tif( !! this.context ) uri = this.context.resolve( uri );\n\n\t\tif( this.pointers.has( pointerID ) ) {\n\t\t\tlet pointer:Pointer.Class = this.getPointer( uri );\n\t\t\tif( pointer.isResolved() ) {\n\t\t\t\treturn new Promise( ( resolve:( result:[ PersistedDocument.Class, HTTP.Response.Class ]) => void, reject:( error:Error ) => void ) => {\n\t\t\t\t\tresolve( [ <any> pointer, null ] );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.context && this.context.auth.isAuthenticated() ) this.context.auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.RDFSource, requestOptions );\n\n\t\treturn HTTP.Request.Service.get( uri, requestOptions ).then( ( response:HTTP.Response.Class ) => {\n\t\t\tlet parsedObject:Object = parse( response.data );\n\n\t\t\treturn expand( [ parsedObject, response ] );\n\t\t} ).then( ( [ expandedResult, response ]:[ Object, HTTP.Response.Class ] ) => {\n\t\t\tlet etag:string = HTTP.Response.Util.getETag( response );\n\t\t\tif( etag === null ) throw new HTTP.Errors.BadResponseError( \"The response doesn't contain an ETag\", response );\n\n\t\t\tlet rdfDocuments:RDF.Document.Class[] = RDF.Document.Util.getDocuments( expandedResult );\n\t\t\tlet rdfDocument:RDF.Document.Class = this.getRDFDocument( uri, rdfDocuments, response );\n\t\t\tif ( rdfDocument === null ) throw new HTTP.Errors.BadResponseError( \"No document was returned.\", response );\n\n\t\t\tlet documentResources:RDF.Node.Class[] = RDF.Document.Util.getDocumentResources( rdfDocument );\n\t\t\tif( documentResources.length > 1 ) throw new HTTP.Errors.BadResponseError( \"The RDFDocument contains more than one document resource.\", response );\n\t\t\tif( documentResources.length === 0 ) throw new HTTP.Errors.BadResponseError( \"The RDFDocument doesn\\'t contain a document resource.\", response );\n\n\t\t\tlet documentResource:RDF.Node.Class = documentResources[ 0 ];\n\t\t\tlet fragmentResources:RDF.Node.Class[] = RDF.Document.Util.getBNodeResources( rdfDocument );\n\t\t\tlet namedFragmentResources:RDF.Node.Class[] = RDF.Document.Util.getFragmentResources( rdfDocument );\n\n\t\t\tlet documentPointer:Pointer.Class = this.getPointer( uri );\n\t\t\tdocumentPointer._resolved = true;\n\n\t\t\tlet document:PersistedDocument.Class = PersistedDocument.Factory.createFrom( documentPointer, uri, this );\n\t\t\tdocument._etag = etag;\n\n\t\t\tlet fragments:Fragment.Class[] = [];\n\t\t\tfor( let fragmentResource of fragmentResources ) {\n\t\t\t\tfragments.push( document.createFragment( fragmentResource[ \"@id\" ] ) );\n\t\t\t}\n\n\t\t\tlet namedFragments:NamedFragment.Class[] = [];\n\t\t\tfor( let namedFragmentResource of namedFragmentResources ) {\n\t\t\t\tnamedFragments.push( document.createNamedFragment( namedFragmentResource[ \"@id\" ] ) );\n\t\t\t}\n\n\t\t\tthis.compact( documentResource, document, document );\n\t\t\tthis.compact( fragmentResources, fragments, document );\n\t\t\tthis.compact( namedFragmentResources, namedFragments, document );\n\n\t\t\t// TODO: Decorate additional behavior (container, app, etc.)\n\t\t\treturn [ document, response ];\n\t\t} );\n\t}\n\n\tcreateChild( parentURI:string, slug:string, childDocument:Document.Class, requestOptions?:HTTP.Request.Options ):Promise<[ Pointer.Class, HTTP.Response.Class ]>;\n\tcreateChild( parentURI:string, childDocument:Document.Class, requestOptions?:HTTP.Request.Options ):Promise<[ Pointer.Class, HTTP.Response.Class ]>;\n\tcreateChild( parentURI:string, slugOrChildDocument:any, childDocumentOrRequestOptions:any = {}, requestOptions:HTTP.Request.Options = {} ):Promise<[ Pointer.Class, HTTP.Response.Class ]> {\n\t\tlet slug:string = Utils.isString( slugOrChildDocument ) ? slugOrChildDocument : null;\n\t\tlet childDocument:Document.Class = ! Utils.isString( slugOrChildDocument ) ? slugOrChildDocument : childDocumentOrRequestOptions;\n\t\trequestOptions = ! Utils.isString( slugOrChildDocument ) ? childDocumentOrRequestOptions : requestOptions;\n\n\t\tif( PersistedDocument.Factory.is( childDocument ) ) return Utils.P.createRejectedPromise( new Errors.IllegalArgumentError( \"The childDocument provided has been already persisted.\" ) );\n\n\t\tif( childDocument.id ) {\n\t\t\tif( ! RDF.URI.Util.isBaseOf( parentURI, childDocument.id ) ) return Utils.P.createRejectedPromise( new Errors.IllegalArgumentError( \"The childDocument's URI is not relative to the parentURI specified\" ) );\n\t\t}\n\n\t\tif ( this.context && this.context.auth.isAuthenticated() ) this.context.auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setContentTypeHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.Container, requestOptions );\n\n\t\tif( slug !== null ) HTTP.Request.Util.setSlug( slug, requestOptions );\n\n\t\tlet body:string = childDocument.toJSON( this, this.jsonldConverter );\n\n\t\treturn HTTP.Request.Service.post( parentURI, body, requestOptions ).then(\n\t\t\t( response:HTTP.Response.Class ) => {\n\t\t\t\tlet locationHeader:HTTP.Header.Class = response.headers.get( \"Location\" );\n\t\t\t\tif( locationHeader === null || locationHeader.values.length < 1 ) throw new HTTP.Errors.BadResponseError( \"The response is missing a Location header.\", response );\n\t\t\t\tif( locationHeader.values.length !== 1 ) throw new HTTP.Errors.BadResponseError( \"The response contains more than one Location header.\", response );\n\n\t\t\t\tlet locationURI:string = locationHeader.values[0].toString();\n\t\t\t\tlet pointer:Pointer.Class = this.getPointer( locationURI);\n\n\t\t\t\treturn [\n\t\t\t\t\tpointer,\n\t\t\t\t\tresponse,\n\t\t\t\t];\n\t\t\t}\n\t\t);\n\t}\n\n\tgetMembers( uri:string, includeNonReadable:boolean, requestOptions:HTTP.Request.Options ):Promise<[ Pointer.Class[], HTTP.Response.Class ]>;\n\tgetMembers( uri:string, includeNonReadable:boolean ):Promise<[ Pointer.Class[], HTTP.Response.Class ]>;\n\tgetMembers( uri:string, requestOptions:HTTP.Request.Options ):Promise<[ Pointer.Class[], HTTP.Response.Class ]>;\n\tgetMembers( uri:string ):Promise<[ Pointer.Class[], HTTP.Response.Class ]>;\n\tgetMembers( uri:string, includeNonReadableOrRequestOptions:any = null, requestOptions:HTTP.Request.Options = {} ):Promise<[ Pointer.Class[], HTTP.Response.Class ]> {\n\t\tlet includeNonReadable:boolean = Utils.isBoolean( includeNonReadableOrRequestOptions ) ? includeNonReadableOrRequestOptions : true;\n\t\trequestOptions = Utils.isObject( includeNonReadableOrRequestOptions ) && includeNonReadableOrRequestOptions !== null ? includeNonReadableOrRequestOptions : requestOptions;\n\n\t\tif( ! RDF.URI.Util.isAbsolute( uri ) ) {\n\t\t\tif( ! this.context ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\turi = this.context.resolve( uri );\n\t\t}\n\n\t\tif ( this.context && this.context.auth.isAuthenticated() ) this.context.auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.Container, requestOptions );\n\n\t\tlet containerRetrievalPreferences:HTTP.Request.ContainerRetrievalPreferences = {\n\t\t\tinclude: [\n\t\t\t\tNS.LDP.Class.PreferMinimalContainer,\n\t\t\t\tNS.LDP.Class.PreferMembership,\n\t\t\t],\n\t\t\tomit: [\n\t\t\t\tNS.LDP.Class.PreferContainment,\n\t\t\t\tNS.C.Class.PreferContainmentResources,\n\t\t\t\tNS.C.Class.PreferMembershipResources,\n\t\t\t],\n\t\t};\n\n\t\tif( includeNonReadable ) {\n\t\t\tcontainerRetrievalPreferences.include.push( NS.C.Class.NonReadableMembershipResourceTriples );\n\t\t} else {\n\t\t\tcontainerRetrievalPreferences.omit.push( NS.C.Class.NonReadableMembershipResourceTriples );\n\t\t}\n\n\t\treturn HTTP.Request.Service.get( uri, requestOptions, new RDF.Document.Parser() ).then( ( [ rdfDocuments, response ]:[ RDF.Document.Class[], HTTP.Response.Class ] ) => {\n\t\t\tlet rdfDocument:RDF.Document.Class = this.getRDFDocument( uri, rdfDocuments, response );\n\t\t\tif ( rdfDocument === null ) throw new HTTP.Errors.BadResponseError( \"No document was returned.\", response );\n\n\t\t\tlet documentResource:RDF.Node.Class = this.getDocumentResource( rdfDocument, response );\n\t\t\tlet membershipResourceURI:string = RDF.Node.Util.getPropertyURI( documentResource, NS.LDP.Predicate.membershipResource );\n\n\t\t\tlet membershipResource:RDF.Node.Class;\n\t\t\tif( documentResource[ \"@id\" ] === membershipResourceURI ) {\n\t\t\t\tmembershipResource = documentResource;\n\t\t\t} else if( membershipResourceURI === null ) {\n\t\t\t\tif( documentResource[ \"@type\" ].indexOf( NS.LDP.Class.BasicContainer ) !== -1 ) {\n\t\t\t\t\tmembershipResource = documentResource;\n\t\t\t\t} else {\n\t\t\t\t\tthrow new HTTP.Errors.BadResponseError( \"The document is not an ldp:BasicContainer and it doesn't contain an ldp:membershipResource triple.\", response );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet membershipResourceDocument:RDF.Document.Class = this.getRDFDocument( membershipResourceURI, rdfDocuments, response );\n\t\t\t\tif ( membershipResourceDocument === null ) throw new HTTP.Errors.BadResponseError( \"The membershipResource document was not included in the response.\", response );\n\t\t\t\tmembershipResource = this.getDocumentResource( membershipResourceDocument, response );\n\t\t\t}\n\n\t\t\tlet hasMemberRelation:string = RDF.Node.Util.getPropertyURI( documentResource, NS.LDP.Predicate.hasMemberRelation );\n\n\t\t\tlet memberPointers:Pointer.Class[] = RDF.Value.Util.getPropertyPointers( membershipResource, hasMemberRelation, this );\n\n\t\t\treturn [ memberPointers, response ];\n\t\t});\n\t}\n\n\tsave( persistedDocument:PersistedDocument.Class, requestOptions:HTTP.Request.Options = {} ):Promise<[ PersistedDocument.Class, HTTP.Response.Class ]> {\n\t\t// TODO: Check if the document isDirty\n\t\t/*\n\t\tif( ! persistedDocument.isDirty() ) return new Promise<HTTP.Response.Class>( ( resolve:( result:HTTP.Response.Class ) => void ) => {\n\t\t\tresolve( null );\n\t\t});\n\t\t*/\n\n\t\tif ( this.context && this.context.auth.isAuthenticated() ) this.context.auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setContentTypeHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.RDFSource, requestOptions );\n\t\tHTTP.Request.Util.setIfMatchHeader( persistedDocument._etag, requestOptions );\n\n\t\tlet body:string = persistedDocument.toJSON( this, this.jsonldConverter );\n\n\t\treturn HTTP.Request.Service.put( persistedDocument.id, body, requestOptions ).then( ( response:HTTP.Response.Class ) => {\n\t\t\treturn [ persistedDocument, response ];\n\t\t});\n\t}\n\n\tdelete( persistedDocument:PersistedDocument.Class, requestOptions:HTTP.Request.Options = {} ):Promise<HTTP.Response.Class> {\n\t\tif ( this.context && this.context.auth.isAuthenticated() ) this.context.auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.RDFSource, requestOptions );\n\t\tHTTP.Request.Util.setIfMatchHeader( persistedDocument._etag, requestOptions );\n\n\t\treturn HTTP.Request.Service.delete( persistedDocument.id, persistedDocument.toJSON(), requestOptions );\n\t}\n\n\tgetSchemaFor( object:Object ):ObjectSchema.DigestedObjectSchema {\n\t\tif( \"@id\" in object ) {\n\t\t\treturn this.getDigestedObjectSchemaForExpandedObject( object );\n\t\t} else {\n\t\t\treturn this.getDigestedObjectSchemaForDocument( <any> object );\n\t\t}\n\t}\n\n\texecuteRawASKQuery( documentURI:string, askQuery:string, requestOptions:HTTP.Request.Options = {} ):Promise<[ SPARQL.RawResults.Class, HTTP.Response.Class ]> {\n\t\tif( ! RDF.URI.Util.isAbsolute( documentURI ) ) {\n\t\t\tif( ! this.context ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\tdocumentURI = this.context.resolve( documentURI );\n\t\t}\n\n\t\tif ( this.context && this.context.auth.isAuthenticated() ) this.context.auth.addAuthentication( requestOptions );\n\n\t\treturn SPARQL.Service.executeRawASKQuery( documentURI, askQuery, requestOptions );\n\t}\n\n\texecuteASKQuery( documentURI:string, askQuery:string, requestOptions:HTTP.Request.Options = {} ):Promise<[ boolean, HTTP.Response.Class ]> {\n\t\tif( ! RDF.URI.Util.isAbsolute( documentURI ) ) {\n\t\t\tif( ! this.context ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\tdocumentURI = this.context.resolve( documentURI );\n\t\t}\n\n\t\tif ( this.context && this.context.auth.isAuthenticated() ) this.context.auth.addAuthentication( requestOptions );\n\n\t\treturn SPARQL.Service.executeASKQuery( documentURI, askQuery, requestOptions );\n\t}\n\n\texecuteRawSELECTQuery( documentURI:string, selectQuery:string, requestOptions:HTTP.Request.Options = {} ):Promise<[ SPARQL.RawResults.Class, HTTP.Response.Class ]> {\n\t\tif( ! RDF.URI.Util.isAbsolute( documentURI ) ) {\n\t\t\tif( ! this.context ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\tdocumentURI = this.context.resolve( documentURI );\n\t\t}\n\n\t\tif ( this.context && this.context.auth.isAuthenticated() ) this.context.auth.addAuthentication( requestOptions );\n\n\t\treturn SPARQL.Service.executeRawSELECTQuery( documentURI, selectQuery, requestOptions );\n\t}\n\n\texecuteSELECTQuery( documentURI:string, selectQuery:string, requestOptions:HTTP.Request.Options = {} ):Promise<[ SPARQL.SELECTResults.Class, HTTP.Response.Class ]> {\n\t\tif( ! RDF.URI.Util.isAbsolute( documentURI ) ) {\n\t\t\tif( ! this.context ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\tdocumentURI = this.context.resolve( documentURI );\n\t\t}\n\n\t\tif ( this.context && this.context.auth.isAuthenticated() ) this.context.auth.addAuthentication( requestOptions );\n\n\t\treturn SPARQL.Service.executeSELECTQuery( documentURI, selectQuery, this, requestOptions );\n\t}\n\n\texecuteRawCONSTRUCTQuery( documentURI:string, constructQuery:string, requestOptions:HTTP.Request.Options = {} ):Promise<[ string, HTTP.Response.Class ]> {\n\t\tif( ! RDF.URI.Util.isAbsolute( documentURI ) ) {\n\t\t\tif( ! this.context ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\tdocumentURI = this.context.resolve( documentURI );\n\t\t}\n\n\t\tif ( this.context && this.context.auth.isAuthenticated() ) this.context.auth.addAuthentication( requestOptions );\n\n\t\treturn SPARQL.Service.executeRawCONSTRUCTQuery( documentURI, constructQuery, requestOptions );\n\t}\n\n\texecuteRawDESCRIBEQuery( documentURI:string, constructQuery:string, requestOptions:HTTP.Request.Options = {} ):Promise<[ string, HTTP.Response.Class ]> {\n\t\tif( ! RDF.URI.Util.isAbsolute( documentURI ) ) {\n\t\t\tif( ! this.context ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\tdocumentURI = this.context.resolve( documentURI );\n\t\t}\n\n\t\tif ( this.context && this.context.auth.isAuthenticated() ) this.context.auth.addAuthentication( requestOptions );\n\n\t\treturn SPARQL.Service.executeRawDESCRIBEQuery( documentURI, constructQuery, requestOptions );\n\t}\n\n\tprivate getRDFDocument( requestURL:string, rdfDocuments:RDF.Document.Class[], response:HTTP.Response.Class ):RDF.Document.Class {\n\t\trdfDocuments = rdfDocuments.filter( ( rdfDocument:RDF.Document.Class ) => rdfDocument[ \"@id\" ] === requestURL );\n\n\t\tif ( rdfDocuments.length > 1 ) throw new HTTP.Errors.BadResponseError( \"Several documents share the same id.\", response );\n\n\t\treturn rdfDocuments.length > 0 ? rdfDocuments[ 0 ] : null;\n\t}\n\n\tprivate getDocumentResource( rdfDocument:RDF.Document.Class, response:HTTP.Response.Class ):RDF.Node.Class {\n\t\tlet documentResources:RDF.Node.Class[] = RDF.Document.Util.getDocumentResources( rdfDocument );\n\t\tif ( documentResources.length === 0 ) throw new HTTP.Errors.BadResponseError( `The RDFDocument: ${ rdfDocument[ \"@id\" ] }, doesn't contain a document resource.`, response );\n\t\tif ( documentResources.length > 1 ) throw new HTTP.Errors.BadResponseError( `The RDFDocument: ${ rdfDocument[ \"@id\" ] }, contains more than one document resource.`, response );\n\n\t\treturn documentResources[ 0 ];\n\t}\n\n\tprivate getPointerID( uri:string ):string {\n\t\tif( RDF.URI.Util.isBNodeID( uri ) ) throw new Errors.IllegalArgumentError( \"BNodes cannot be fetched directly.\" );\n\t\t// TODO: Make named fragments independently resolvable\n\t\t/*\n\t\t\tif( RDF.URI.Util.hasFragment( uri ) ) throw new Errors.IllegalArgumentError( \"Fragment URI's cannot be fetched directly.\" );\n\t\t*/\n\n\t\tif( !! this.context ) {\n\t\t\t// TODO: Check this, it may be incorrect\n\t\t\tif( RDF.URI.Util.isRelative( uri ) ) {\n\t\t\t\tlet baseURI:string = this.context.getBaseURI();\n\t\t\t\tif( ! RDF.URI.Util.isBaseOf( baseURI, uri ) ) return null;\n\n\t\t\t\treturn uri.substring( baseURI.length );\n\t\t\t} else {\n\t\t\t\treturn uri;\n\t\t\t}\n\t\t} else {\n\t\t\tif( RDF.URI.Util.isRelative( uri ) ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\treturn uri;\n\t\t}\n\t}\n\n\tprivate createPointer( localID:string ):Pointer.Class {\n\t\tlet id:string = !! this.context ? this.context.resolve( localID ) : localID;\n\t\tlet pointer:Pointer.Class = Pointer.Factory.create( id );\n\t\tObject.defineProperty( pointer, \"resolve\", {\n\t\t\twritable: false,\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: ():Promise<[ PersistedDocument.Class, HTTP.Response.Class ]> => {\n\t\t\t\treturn this.get( id );\n\t\t\t},\n\t\t});\n\n\t\treturn pointer;\n\t}\n\n\tprivate compact( expandedObjects:Object[], targetObjects:Object[], pointerLibrary:Pointer.Library ):Object[];\n\tprivate compact( expandedObject:Object, targetObject:Object, pointerLibrary:Pointer.Library ):Object;\n\tprivate compact( expandedObjectOrObjects:any, targetObjectOrObjects:any, pointerLibrary:Pointer.Library ):any {\n\t\tif( ! Utils.isArray( expandedObjectOrObjects ) ) return this.compactSingle( expandedObjectOrObjects, targetObjectOrObjects, pointerLibrary );\n\n\t\tlet expandedObjects:Object[] = expandedObjectOrObjects;\n\t\tlet targetObjects:Object[] = !! targetObjectOrObjects ? targetObjectOrObjects : [];\n\t\tfor( let i:number = 0, length:number = expandedObjects.length; i < length; i++ ) {\n\t\t\tlet expandedObject:Object = expandedObjects[ i ];\n\t\t\tlet targetObject:Object = targetObjects[ i ] = !! targetObjects[ i ] ? targetObjects[ i ] : {};\n\n\t\t\tthis.compactSingle( expandedObject, targetObject, pointerLibrary );\n\t\t}\n\n\t\treturn targetObjects;\n\t}\n\n\tprivate compactSingle( expandedObject:Object, targetObject:Object, pointerLibrary:Pointer.Library ):Object {\n\t\tlet digestedSchema:ObjectSchema.DigestedObjectSchema = this.getDigestedObjectSchemaForExpandedObject( expandedObject );\n\n\t\treturn this.jsonldConverter.compact( expandedObject, targetObject, digestedSchema, pointerLibrary );\n\t}\n\n\tprivate getDigestedObjectSchemaForExpandedObject( expandedObject:Object ):ObjectSchema.DigestedObjectSchema {\n\t\tlet types:string[] = this.getExpandedObjectTypes( expandedObject );\n\n\t\treturn this.getDigestedObjectSchema( types );\n\t}\n\n\tprivate getDigestedObjectSchemaForDocument( document:Document.Class ):ObjectSchema.DigestedObjectSchema {\n\t\tlet types:string[] = this.getDocumentTypes( document );\n\n\t\treturn this.getDigestedObjectSchema( types );\n\t}\n\n\tprivate getDigestedObjectSchema( objectTypes:string[] ):ObjectSchema.DigestedObjectSchema {\n\t\tlet digestedSchema:ObjectSchema.DigestedObjectSchema;\n\t\tif( !! this.context ) {\n\t\t\tlet typesDigestedObjectSchemas:ObjectSchema.DigestedObjectSchema[] = [ this.context.getObjectSchema() ];\n\t\t\tfor( let type of objectTypes ) {\n\t\t\t\tif( this.context.getObjectSchema( type ) ) typesDigestedObjectSchemas.push( this.context.getObjectSchema( type ) );\n\t\t\t}\n\n\t\t\tif( typesDigestedObjectSchemas.length > 1 ) {\n\t\t\t\tdigestedSchema = ObjectSchema.Digester.combineDigestedObjectSchemas( typesDigestedObjectSchemas );\n\t\t\t} else {\n\t\t\t\tdigestedSchema = typesDigestedObjectSchemas[ 0 ];\n\t\t\t}\n\t\t} else {\n\t\t\tdigestedSchema = new ObjectSchema.DigestedObjectSchema();\n\t\t}\n\n\t\treturn digestedSchema;\n\t}\n\n\tprivate getExpandedObjectTypes( expandedObject:Object ):string[] {\n\t\tif( ! expandedObject[ \"@type\" ] ) return [];\n\n\t\treturn expandedObject[ \"@type\" ];\n\t}\n\n\tprivate getDocumentTypes( document:Document.Class ):string[] {\n\t\tif( ! document.types ) return [];\n\t\treturn document.types;\n\t}\n}\n\nexport default Documents;\n"],"sourceRoot":"/source/"}