{"version":3,"sources":["Documents.ts"],"names":["parse","expand","Documents","Documents.constructor","Documents.jsonldConverter","Documents.inScope","Documents.hasPointer","Documents.getPointer","Documents.get","Documents.createChild","Documents.save","Documents.delete","Documents.getSchemaFor","Documents.executeSELECTQuery","Documents.getRDFDocument","Documents.getPointerID","Documents.createPointer","Documents.compact","Documents.compactSingle","Documents.getDigestedObjectSchemaForExpandedObject","Documents.getDigestedObjectSchemaForDocument","Documents.getDigestedObjectSchema","Documents.getExpandedObjectTypes","Documents.getDocumentTypes"],"mappings":"AAAA,4CAA4C;AAE5C,IAAY,MAAM,WAAM,QAAQ,CAAC,CAAA;AAGjC,IAAY,MAAM,WAAM,UAAU,CAAC,CAAA;AACnC,IAAY,IAAI,WAAM,QAAQ,CAAC,CAAA;AAE/B,IAAY,GAAG,WAAM,OAAO,CAAC,CAAA;AAC7B,IAAY,KAAK,WAAM,SAAS,CAAC,CAAA;AAIjC,IAAY,eAAe,WAAM,mBAAmB,CAAC,CAAA;AACrD,IAAY,iBAAiB,WAAM,qBAAqB,CAAC,CAAA;AACzD,IAAY,OAAO,WAAM,WAAW,CAAC,CAAA;AAGrC,IAAY,YAAY,WAAM,gBAAgB,CAAC,CAAA;AAC/C,IAAY,GAAG,WAAM,UAAU,CAAC,CAAA;AAEhC,IAAY,MAAM,WAAM,UAAU,CAAC,CAAA;AAEnC,eAAgB,KAAY;IAC3BA,IAAIA,CAACA;QACJA,MAAMA,CAACA,IAAIA,CAACA,KAAKA,CAAEA,KAAKA,CAAEA,CAACA;IAC5BA,CAAEA;IAAAA,KAAKA,CAACA,CAAEA,KAAMA,CAACA,CAACA,CAACA;QAClBA,2BAA2BA;QAC3BA,MAAMA,KAAKA,CAACA;IACbA,CAACA;AACFA,CAACA;AAED,gBAAiB,EAAoD,EAAE,OAA6B;QAAjFC,MAAMA,UAAEA,QAAQA;IAClCA,MAAMA,CAACA,IAAIA,OAAOA,CAAEA,UAAEA,OAAiCA,EAAEA,MAA4BA;QACpFA,MAAMA,CAACA,MAAMA,CAAEA,MAAMA,EAAEA,OAAOA,EAAEA,UAAWA,KAASA,EAAEA,QAAeA;YACpE,EAAE,CAAC,CAAE,KAAM,CAAC,CAAC,CAAC;gBACb,mCAAmC;gBACnC,MAAM,KAAK,CAAC;YACb,CAAC;YAED,MAAM,GAAG,QAAQ,CAAC;YAClB,OAAO,CAAE,CAAE,MAAM,EAAE,QAAQ,CAAE,CAAE,CAAC;QACjC,CAAC,CAAEA,CAACA;IACLA,CAACA,CAAEA,CAACA;AACLA,CAACA;AAED;IAQCC,mBAAaA,OAAsBA;QAAtBC,uBAAsBA,GAAtBA,cAAsBA;QAClCA,IAAIA,CAACA,OAAOA,GAAGA,OAAOA,CAACA;QAEvBA,IAAIA,CAACA,QAAQA,GAAGA,IAAIA,GAAGA,EAAyBA,CAACA;QAEjDA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,aAAcA,CAACA,CAACA,CAACA;YACvDA,IAAIA,sBAAsBA,GAAyBA,IAAIA,CAACA,OAAOA,CAACA,aAAaA,CAACA,SAASA,CAACA,eAAeA,CAACA;YACxGA,IAAIA,CAACA,gBAAgBA,GAAGA,IAAIA,eAAeA,CAACA,KAAKA,CAAEA,sBAAsBA,CAACA,kBAAkBA,CAAEA,CAACA;QAChGA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACPA,IAAIA,CAACA,gBAAgBA,GAAGA,IAAIA,eAAeA,CAACA,KAAKA,EAAEA,CAACA;QACrDA,CAACA;IACFA,CAACA;IAhBDD,sBAAIA,sCAAeA;aAAnBA,cAA8CE,MAAMA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA,CAACA,CAACA;;;OAAAF;IAoB7EA,2BAAOA,GAAPA,UAASA,WAAeA;QACvBG,IAAIA,EAAEA,GAAUA,OAAOA,CAACA,OAAOA,CAACA,EAAEA,CAAEA,WAAWA,CAAEA,GAAGA,WAAWA,CAACA,EAAEA,GAAGA,WAAWA,CAACA;QAEjFA,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,SAASA,CAAEA,EAAEA,CAAGA,CAACA;YAACA,MAAMA,CAACA,KAAKA,CAACA;QAEhDA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAQA,CAACA,CAACA,CAACA;YACtBA,IAAIA,OAAOA,GAAUA,IAAIA,CAACA,OAAOA,CAACA,UAAUA,EAAEA,CAACA;YAC/CA,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,UAAUA,CAAEA,EAAEA,CAAEA,IAAIA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,QAAQA,CAAEA,OAAOA,EAAEA,EAAEA,CAAGA,CAACA;gBAACA,MAAMA,CAACA,IAAIA,CAACA;QACzFA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACPA,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,UAAUA,CAAEA,EAAEA,CAAGA,CAACA;gBAACA,MAAMA,CAACA,IAAIA,CAACA;QACjDA,CAACA;QAEDA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,aAAcA,CAACA;YAACA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,aAAaA,CAACA,SAASA,CAACA,OAAOA,CAAEA,EAAEA,CAAEA,CAACA;QAEjHA,MAAMA,CAACA,KAAKA,CAACA;IACdA,CAACA;IAEDH,8BAAUA,GAAVA,UAAYA,EAASA;QACpBI,EAAEA,GAAGA,IAAIA,CAACA,YAAYA,CAAEA,EAAEA,CAAEA,CAACA;QAE7BA,EAAEA,CAAAA,CAAEA,IAAIA,CAACA,QAAQA,CAACA,GAAGA,CAAEA,EAAEA,CAAGA,CAACA;YAACA,MAAMA,CAACA,IAAIA,CAACA;QAE1CA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,aAAcA,CAACA;YAACA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,aAAaA,CAACA,SAASA,CAACA,UAAUA,CAAEA,EAAEA,CAAEA,CAACA;QAEpHA,MAAMA,CAACA,KAAKA,CAACA;IACdA,CAACA;IAEDJ,8BAAUA,GAAVA,UAAYA,EAASA;QACpBK,IAAIA,OAAOA,GAAUA,IAAIA,CAACA,YAAYA,CAAEA,EAAEA,CAAEA,CAACA;QAE7CA,EAAEA,CAAAA,CAAEA,CAAEA,OAAQA,CAACA,CAACA,CAACA;YAChBA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,aAAcA,CAACA;gBAACA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,aAAaA,CAACA,SAASA,CAACA,UAAUA,CAAEA,EAAEA,CAAEA,CAACA;YACpHA,MAAMA,IAAIA,MAAMA,CAACA,oBAAoBA,CAAEA,iDAAiDA,CAAEA,CAACA;QAC5FA,CAACA;QAEDA,IAAIA,OAAqBA,CAACA;QAC1BA,EAAEA,CAAAA,CAAEA,CAAEA,IAAIA,CAACA,QAAQA,CAACA,GAAGA,CAAEA,OAAOA,CAAGA,CAACA,CAACA,CAACA;YACrCA,OAAOA,GAAGA,IAAIA,CAACA,aAAaA,CAAEA,OAAOA,CAAEA,CAACA;YACxCA,IAAIA,CAACA,QAAQA,CAACA,GAAGA,CAAEA,OAAOA,EAAEA,OAAOA,CAAEA,CAACA;QACvCA,CAACA;QAEDA,MAAMA,CAACA,IAAIA,CAACA,QAAQA,CAACA,GAAGA,CAAEA,OAAOA,CAAEA,CAACA;IACrCA,CAACA;IAEDL,uBAAGA,GAAHA,UAAKA,GAAUA,EAAEA,cAAwCA;QAAzDM,iBAgECA;QAhEgBA,8BAAwCA,GAAxCA,mBAAwCA;QACxDA,IAAIA,SAASA,GAAUA,IAAIA,CAACA,YAAYA,CAAEA,GAAGA,CAAEA,CAACA;QAChDA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAQA,CAACA;YAACA,GAAGA,GAAGA,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAAEA,GAAGA,CAAEA,CAACA;QAExDA,EAAEA,CAAAA,CAAEA,IAAIA,CAACA,QAAQA,CAACA,GAAGA,CAAEA,SAASA,CAAGA,CAACA,CAACA,CAACA;YACrCA,IAAIA,OAAOA,GAAiBA,IAAIA,CAACA,UAAUA,CAAEA,GAAGA,CAAEA,CAACA;YACnDA,EAAEA,CAAAA,CAAEA,OAAOA,CAACA,UAAUA,EAAGA,CAACA,CAACA,CAACA;gBAC3BA,MAAMA,CAACA,IAAIA,OAAOA,CAAEA,UAAEA,OAA0EA,EAAEA,MAA8BA;oBAC/HA,OAAOA,CAAEA,CAAQA,OAAOA,EAAEA,IAAIA,CAAEA,CAAEA,CAACA;gBACpCA,CAACA,CAAEA,CAACA;YACLA,CAACA;QACFA,CAACA;QAEDA,EAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,EAAGA,CAACA;YAACA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,iBAAiBA,CAAEA,cAAcA,CAAEA,CAACA;QAEjHA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,CAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAC3EA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,4BAA4BA,CAAEA,GAAGA,CAACA,KAAKA,CAACA,SAASA,EAAEA,cAAcA,CAAEA,CAACA;QAEtFA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAACA,GAAGA,CAAEA,GAAGA,EAAEA,cAAcA,CAAEA,CAACA,IAAIA,CAC1DA,UAAEA,QAA4BA;YAC7BA,IAAIA,YAAYA,GAAUA,KAAKA,CAAEA,QAAQA,CAACA,IAAIA,CAAEA,CAACA;YAEjDA,MAAMA,CAACA,MAAMA,CAAEA,CAAEA,YAAYA,EAAEA,QAAQA,CAAEA,CAAEA,CAACA;QAC7CA,CAACA,CACDA,CAACA,IAAIA,CACLA,UAAEA,EAA4DA;gBAA1DA,cAAcA,UAAEA,QAAQA;YAC3BA,IAAIA,IAAIA,GAAUA,IAAIA,CAACA,QAAQA,CAACA,IAAIA,CAACA,OAAOA,CAAEA,QAAQA,CAAEA,CAACA;YACzDA,EAAEA,CAAAA,CAAEA,IAAIA,KAAKA,IAAKA,CAACA;gBAACA,MAAMA,IAAIA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAAEA,sCAAsCA,EAAEA,QAAQA,CAAEA,CAACA;YAE/GA,IAAIA,YAAYA,GAAwBA,GAAGA,CAACA,QAAQA,CAACA,IAAIA,CAACA,YAAYA,CAAEA,cAAcA,CAAEA,CAACA;YACzFA,IAAIA,WAAWA,GAAsBA,KAAIA,CAACA,cAAcA,CAAEA,YAAYA,EAAEA,QAAQA,CAAEA,CAACA;YAEnFA,IAAIA,iBAAiBA,GAAoBA,GAAGA,CAACA,QAAQA,CAACA,IAAIA,CAACA,oBAAoBA,CAAEA,WAAWA,CAAEA,CAACA;YAC/FA,EAAEA,CAAAA,CAAEA,iBAAiBA,CAACA,MAAMA,GAAGA,CAAEA,CAACA;gBAACA,MAAMA,IAAIA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAAEA,2DAA2DA,EAAEA,QAAQA,CAAEA,CAACA;YACnJA,EAAEA,CAAAA,CAAEA,iBAAiBA,CAACA,MAAMA,KAAKA,CAAEA,CAACA;gBAACA,MAAMA,IAAIA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAAEA,uDAAuDA,EAAEA,QAAQA,CAAEA,CAACA;YAEjJA,IAAIA,gBAAgBA,GAAkBA,iBAAiBA,CAAEA,CAACA,CAAEA,CAACA;YAC7DA,IAAIA,iBAAiBA,GAAoBA,GAAGA,CAACA,QAAQA,CAACA,IAAIA,CAACA,iBAAiBA,CAAEA,WAAWA,CAAEA,CAACA;YAC5FA,IAAIA,sBAAsBA,GAAoBA,GAAGA,CAACA,QAAQA,CAACA,IAAIA,CAACA,oBAAoBA,CAAEA,WAAWA,CAAEA,CAACA;YAEpGA,IAAIA,eAAeA,GAAiBA,KAAIA,CAACA,UAAUA,CAAEA,GAAGA,CAAEA,CAACA;YAC3DA,eAAeA,CAACA,SAASA,GAAGA,IAAIA,CAACA;YAEjCA,IAAIA,QAAQA,GAA2BA,iBAAiBA,CAACA,OAAOA,CAACA,UAAUA,CAAEA,eAAeA,EAAEA,GAAGA,EAAEA,KAAIA,CAAEA,CAACA;YAC1GA,QAAQA,CAACA,KAAKA,GAAGA,IAAIA,CAACA;YAEtBA,IAAIA,SAASA,GAAoBA,EAAEA,CAACA;YACpCA,GAAGA,CAAAA,CAA0BA,UAAiBA,EAAzCA,6BAAoBA,EAApBA,IAA0CA,CAACA;gBAA3CA,IAAIA,gBAAgBA,GAAIA,iBAAiBA,IAArBA;gBACxBA,SAASA,CAACA,IAAIA,CAAEA,QAAQA,CAACA,cAAcA,CAAEA,gBAAgBA,CAAEA,KAAKA,CAAEA,CAAEA,CAAEA,CAACA;aACvEA;YAEDA,IAAIA,cAAcA,GAAyBA,EAAEA,CAACA;YAC9CA,GAAGA,CAAAA,CAA+BA,UAAsBA,EAAnDA,kCAAyBA,EAAzBA,IAAoDA,CAACA;gBAArDA,IAAIA,qBAAqBA,GAAIA,sBAAsBA,IAA1BA;gBAC7BA,cAAcA,CAACA,IAAIA,CAAEA,QAAQA,CAACA,mBAAmBA,CAAEA,qBAAqBA,CAAEA,KAAKA,CAAEA,CAAEA,CAAEA,CAACA;aACtFA;YAEDA,KAAIA,CAACA,OAAOA,CAAEA,gBAAgBA,EAAEA,QAAQA,EAAEA,QAAQA,CAAEA,CAACA;YACrDA,KAAIA,CAACA,OAAOA,CAAEA,iBAAiBA,EAAEA,SAASA,EAAEA,QAAQA,CAAEA,CAACA;YACvDA,KAAIA,CAACA,OAAOA,CAAEA,sBAAsBA,EAAEA,cAAcA,EAAEA,QAAQA,CAAEA,CAACA;YAEjEA,4DAA4DA;YAC5DA,MAAMA,CAACA,CAAEA,QAAQA,EAAEA,QAAQA,CAAEA,CAACA;QAC/BA,CAACA,CACDA,CAACA;IACHA,CAACA;IAGDN,+BAAWA,GAAXA,UAAaA,SAAgBA,EAAEA,mBAAuBA,EAAEA,6BAAsCA,EAAEA,cAAwCA;QAAxIO,iBAoCCA;QApCuDA,6CAAsCA,GAAtCA,kCAAsCA;QAAEA,8BAAwCA,GAAxCA,mBAAwCA;QACvIA,IAAIA,IAAIA,GAAUA,KAAKA,CAACA,QAAQA,CAAEA,mBAAmBA,CAAEA,GAAGA,mBAAmBA,GAAGA,IAAIA,CAACA;QACrFA,IAAIA,aAAaA,GAAkBA,CAAEA,KAAKA,CAACA,QAAQA,CAAEA,mBAAmBA,CAAEA,GAAGA,mBAAmBA,GAAGA,6BAA6BA,CAACA;QACjIA,cAAcA,GAAGA,CAAEA,KAAKA,CAACA,QAAQA,CAAEA,mBAAmBA,CAAEA,GAAGA,6BAA6BA,GAAGA,cAAcA,CAACA;QAE1GA,EAAEA,CAAAA,CAAEA,iBAAiBA,CAACA,OAAOA,CAACA,EAAEA,CAAEA,aAAaA,CAAGA,CAACA;YAACA,MAAMA,CAACA,KAAKA,CAACA,CAACA,CAACA,qBAAqBA,CAAEA,IAAIA,MAAMA,CAACA,oBAAoBA,CAAEA,wDAAwDA,CAAEA,CAAEA,CAACA;QAExLA,EAAEA,CAAAA,CAAEA,aAAaA,CAACA,EAAGA,CAACA,CAACA,CAACA;YACvBA,EAAEA,CAAAA,CAAEA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,QAAQA,CAAEA,SAASA,EAAEA,aAAaA,CAACA,EAAEA,CAAGA,CAACA;gBAACA,MAAMA,CAACA,KAAKA,CAACA,CAACA,CAACA,qBAAqBA,CAAEA,IAAIA,MAAMA,CAACA,oBAAoBA,CAAEA,oEAAoEA,CAAEA,CAAEA,CAACA;QAC9MA,CAACA;QAEDA,EAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,EAAGA,CAACA;YAACA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,iBAAiBA,CAAEA,cAAcA,CAAEA,CAACA;QAEjHA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,CAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAC3EA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,oBAAoBA,CAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAChFA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,4BAA4BA,CAAEA,GAAGA,CAACA,KAAKA,CAACA,SAASA,EAAEA,cAAcA,CAAEA,CAACA;QAEtFA,EAAEA,CAAAA,CAAEA,IAAIA,KAAKA,IAAKA,CAACA;YAACA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,OAAOA,CAAEA,IAAIA,EAAEA,cAAcA,CAAEA,CAACA;QAEtEA,IAAIA,IAAIA,GAAUA,aAAaA,CAACA,MAAMA,CAAEA,IAAIA,EAAEA,IAAIA,CAACA,eAAeA,CAAEA,CAACA;QAErEA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAACA,IAAIA,CAAEA,SAASA,EAAEA,IAAIA,EAAEA,cAAcA,CAAEA,CAACA,IAAIA,CACvEA,UAAEA,QAA4BA;YAC7BA,IAAIA,cAAcA,GAAqBA,QAAQA,CAACA,OAAOA,CAACA,GAAGA,CAAEA,UAAUA,CAAEA,CAACA;YAC1EA,EAAEA,CAAAA,CAAEA,cAAcA,KAAKA,IAAIA,IAAIA,cAAcA,CAACA,MAAMA,CAACA,MAAMA,GAAGA,CAAEA,CAACA;gBAACA,MAAMA,IAAIA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAAEA,4CAA4CA,EAAEA,QAAQA,CAAEA,CAACA;YACnKA,EAAEA,CAAAA,CAAEA,cAAcA,CAACA,MAAMA,CAACA,MAAMA,KAAKA,CAAEA,CAACA;gBAACA,MAAMA,IAAIA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAAEA,sDAAsDA,EAAEA,QAAQA,CAAEA,CAACA;YAEpJA,IAAIA,WAAWA,GAAUA,cAAcA,CAACA,MAAMA,CAACA,CAACA,CAACA,CAACA,QAAQA,EAAEA,CAACA;YAC7DA,IAAIA,OAAOA,GAAiBA,KAAIA,CAACA,UAAUA,CAAEA,WAAWA,CAACA,CAACA;YAE1DA,MAAMA,CAACA;gBACNA,OAAOA;gBACPA,QAAQA;aACRA,CAACA;QACHA,CAACA,CACDA,CAACA;IACHA,CAACA;IAEDP,wBAAIA,GAAJA,UAAMA,iBAAyCA,EAAEA,cAAwCA;QACxFQ,sCAAsCA;QACtCA;;;;UAIEA;QAN8CA,8BAAwCA,GAAxCA,mBAAwCA;QAQxFA,EAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,EAAGA,CAACA;YAACA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,iBAAiBA,CAAEA,cAAcA,CAAEA,CAACA;QAEjHA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,CAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAC3EA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,oBAAoBA,CAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAChFA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,4BAA4BA,CAAEA,GAAGA,CAACA,KAAKA,CAACA,SAASA,EAAEA,cAAcA,CAAEA,CAACA;QACtFA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,gBAAgBA,CAAEA,iBAAiBA,CAACA,KAAKA,EAAEA,cAAcA,CAAEA,CAACA;QAE9EA,IAAIA,IAAIA,GAAUA,iBAAiBA,CAACA,MAAMA,CAAEA,IAAIA,EAAEA,IAAIA,CAACA,eAAeA,CAAEA,CAACA;QAEzEA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAACA,GAAGA,CAAEA,iBAAiBA,CAACA,EAAEA,EAAEA,IAAIA,EAAEA,cAAcA,CAAEA,CAACA,IAAIA,CAAEA,UAAEA,QAA4BA;YACjHA,MAAMA,CAACA,CAAEA,iBAAiBA,EAAEA,QAAQA,CAAEA,CAACA;QACxCA,CAACA,CAACA,CAACA;IACJA,CAACA;IAEDR,0BAAMA,GAANA,UAAQA,iBAAyCA,EAAEA,cAAwCA;QAAxCS,8BAAwCA,GAAxCA,mBAAwCA;QAC1FA,EAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,EAAGA,CAACA;YAACA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,iBAAiBA,CAAEA,cAAcA,CAAEA,CAACA;QAEjHA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,CAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAC3EA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,4BAA4BA,CAAEA,GAAGA,CAACA,KAAKA,CAACA,SAASA,EAAEA,cAAcA,CAAEA,CAACA;QACtFA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,gBAAgBA,CAAEA,iBAAiBA,CAACA,KAAKA,EAAEA,cAAcA,CAAEA,CAACA;QAE9EA,MAAMA,CAACA,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAACA,MAAMA,CAAEA,iBAAiBA,CAACA,EAAEA,EAAEA,iBAAiBA,CAACA,MAAMA,EAAEA,EAAEA,cAAcA,CAAEA,CAACA;IACxGA,CAACA;IAEDT,gCAAYA,GAAZA,UAAcA,MAAaA;QAC1BU,EAAEA,CAAAA,CAAEA,KAAKA,IAAIA,MAAOA,CAACA,CAACA,CAACA;YACtBA,MAAMA,CAACA,IAAIA,CAACA,wCAAwCA,CAAEA,MAAMA,CAAEA,CAACA;QAChEA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACPA,MAAMA,CAACA,IAAIA,CAACA,kCAAkCA,CAAQA,MAAMA,CAAEA,CAACA;QAChEA,CAACA;IACFA,CAACA;IAEDV,sCAAkBA,GAAlBA,UAAoBA,WAAkBA,EAAEA,WAAkBA,EAAEA,cAAwCA;QAAxCW,8BAAwCA,GAAxCA,mBAAwCA;QACnGA,EAAEA,CAAAA,CAAEA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,UAAUA,CAAEA,WAAWA,CAAGA,CAACA,CAACA,CAACA;YAC/CA,EAAEA,CAAAA,CAAEA,CAAEA,IAAIA,CAACA,OAAQA,CAACA;gBAACA,MAAMA,IAAIA,MAAMA,CAACA,oBAAoBA,CAAEA,wDAAwDA,CAAEA,CAACA;YACvHA,WAAWA,GAAGA,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAAEA,WAAWA,CAAEA,CAACA;QACnDA,CAACA;QAEDA,EAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,IAAIA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,eAAeA,EAAGA,CAACA;YAACA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,iBAAiBA,CAAEA,cAAcA,CAAEA,CAACA;QAEjHA,MAAMA,CAACA,MAAMA,CAACA,OAAOA,CAACA,kBAAkBA,CAAEA,WAAWA,EAAEA,WAAWA,EAAEA,cAAcA,CAAEA,CAACA;IACtFA,CAACA;IAEOX,kCAAcA,GAAtBA,UAAwBA,YAAiCA,EAAEA,QAA4BA;QACtFY,EAAEA,CAACA,CAAEA,YAAYA,CAACA,MAAMA,KAAKA,CAAEA,CAACA;YAACA,MAAMA,IAAIA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAAEA,2BAA2BA,EAAEA,QAAQA,CAAEA,CAACA;QACjHA,EAAEA,CAACA,CAAEA,YAAYA,CAACA,MAAMA,GAAGA,CAAEA,CAACA;YAACA,MAAMA,IAAIA,KAAKA,CAAEA,2DAA2DA,CAAEA,CAACA;QAC9GA,MAAMA,CAACA,YAAYA,CAAEA,CAACA,CAAEA,CAACA;IAC1BA,CAACA;IAEOZ,gCAAYA,GAApBA,UAAsBA,GAAUA;QAC/Ba,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,SAASA,CAAEA,GAAGA,CAAGA,CAACA;YAACA,MAAMA,IAAIA,MAAMA,CAACA,oBAAoBA,CAAEA,oCAAoCA,CAAEA,CAACA;QAClHA,sDAAsDA;QACtDA;;UAEEA;QAEFA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAQA,CAACA,CAACA,CAACA;YACtBA,wCAAwCA;YACxCA,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,UAAUA,CAAEA,GAAGA,CAAGA,CAACA,CAACA,CAACA;gBACrCA,IAAIA,OAAOA,GAAUA,IAAIA,CAACA,OAAOA,CAACA,UAAUA,EAAEA,CAACA;gBAC/CA,EAAEA,CAAAA,CAAEA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,QAAQA,CAAEA,OAAOA,EAAEA,GAAGA,CAAGA,CAACA;oBAACA,MAAMA,CAACA,IAAIA,CAACA;gBAE1DA,MAAMA,CAACA,GAAGA,CAACA,SAASA,CAAEA,OAAOA,CAACA,MAAMA,CAAEA,CAACA;YACxCA,CAACA;YAACA,IAAIA,CAACA,CAACA;gBACPA,MAAMA,CAACA,GAAGA,CAACA;YACZA,CAACA;QACFA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACPA,EAAEA,CAAAA,CAAEA,GAAGA,CAACA,GAAGA,CAACA,IAAIA,CAACA,UAAUA,CAAEA,GAAGA,CAAGA,CAACA;gBAACA,MAAMA,IAAIA,MAAMA,CAACA,oBAAoBA,CAAEA,wDAAwDA,CAAEA,CAACA;YACvIA,MAAMA,CAACA,GAAGA,CAACA;QACZA,CAACA;IACFA,CAACA;IAEOb,iCAAaA,GAArBA,UAAuBA,OAAcA;QAArCc,iBAaCA;QAZAA,IAAIA,EAAEA,GAAUA,CAACA,CAAEA,IAAIA,CAACA,OAAOA,GAAGA,IAAIA,CAACA,OAAOA,CAACA,OAAOA,CAAEA,OAAOA,CAAEA,GAAGA,OAAOA,CAACA;QAC5EA,IAAIA,OAAOA,GAAiBA,OAAOA,CAACA,OAAOA,CAACA,MAAMA,CAAEA,EAAEA,CAAEA,CAACA;QACzDA,MAAMA,CAACA,cAAcA,CAAEA,OAAOA,EAAEA,SAASA,EAAEA;YAC1CA,QAAQA,EAAEA,KAAKA;YACfA,UAAUA,EAAEA,KAAKA;YACjBA,YAAYA,EAAEA,IAAIA;YAClBA,KAAKA,EAAEA;gBACNA,MAAMA,CAACA,KAAIA,CAACA,GAAGA,CAAEA,EAAEA,CAAEA,CAACA;YACvBA,CAACA;SACDA,CAACA,CAACA;QAEHA,MAAMA,CAACA,OAAOA,CAACA;IAChBA,CAACA;IAIOd,2BAAOA,GAAfA,UAAiBA,uBAA2BA,EAAEA,qBAAyBA,EAAEA,cAA8BA;QACtGe,EAAEA,CAAAA,CAAEA,CAAEA,KAAKA,CAACA,OAAOA,CAAEA,uBAAuBA,CAAGA,CAACA;YAACA,MAAMA,CAACA,IAAIA,CAACA,aAAaA,CAAEA,uBAAuBA,EAAEA,qBAAqBA,EAAEA,cAAcA,CAAEA,CAACA;QAE7IA,IAAIA,eAAeA,GAAYA,uBAAuBA,CAACA;QACvDA,IAAIA,aAAaA,GAAYA,CAACA,CAAEA,qBAAqBA,GAAGA,qBAAqBA,GAAGA,EAAEA,CAACA;QACnFA,GAAGA,CAAAA,CAAEA,GAAGA,CAACA,CAACA,GAAUA,CAACA,EAAEA,QAAMA,GAAUA,eAAeA,CAACA,MAAMA,EAAEA,CAACA,GAAGA,QAAMA,EAAEA,CAACA,EAAEA,EAAGA,CAACA;YACjFA,IAAIA,cAAcA,GAAUA,eAAeA,CAAEA,CAACA,CAAEA,CAACA;YACjDA,IAAIA,YAAYA,GAAUA,aAAaA,CAAEA,CAACA,CAAEA,GAAGA,CAACA,CAAEA,aAAaA,CAAEA,CAACA,CAAEA,GAAGA,aAAaA,CAAEA,CAACA,CAAEA,GAAGA,EAAEA,CAACA;YAE/FA,IAAIA,CAACA,aAAaA,CAAEA,cAAcA,EAAEA,YAAYA,EAAEA,cAAcA,CAAEA,CAACA;QACpEA,CAACA;QAEDA,MAAMA,CAACA,aAAaA,CAACA;IACtBA,CAACA;IAEOf,iCAAaA,GAArBA,UAAuBA,cAAqBA,EAAEA,YAAmBA,EAAEA,cAA8BA;QAChGgB,IAAIA,cAAcA,GAAqCA,IAAIA,CAACA,wCAAwCA,CAAEA,cAAcA,CAAEA,CAACA;QAEvHA,MAAMA,CAACA,IAAIA,CAACA,eAAeA,CAACA,OAAOA,CAAEA,cAAcA,EAAEA,YAAYA,EAAEA,cAAcA,EAAEA,cAAcA,CAAEA,CAACA;IACrGA,CAACA;IAEOhB,4DAAwCA,GAAhDA,UAAkDA,cAAqBA;QACtEiB,IAAIA,KAAKA,GAAYA,IAAIA,CAACA,sBAAsBA,CAAEA,cAAcA,CAAEA,CAACA;QAEnEA,MAAMA,CAACA,IAAIA,CAACA,uBAAuBA,CAAEA,KAAKA,CAAEA,CAACA;IAC9CA,CAACA;IAEOjB,sDAAkCA,GAA1CA,UAA4CA,QAAuBA;QAClEkB,IAAIA,KAAKA,GAAYA,IAAIA,CAACA,gBAAgBA,CAAEA,QAAQA,CAAEA,CAACA;QAEvDA,MAAMA,CAACA,IAAIA,CAACA,uBAAuBA,CAAEA,KAAKA,CAAEA,CAACA;IAC9CA,CAACA;IAEOlB,2CAAuBA,GAA/BA,UAAiCA,WAAoBA;QACpDmB,IAAIA,cAAgDA,CAACA;QACrDA,EAAEA,CAAAA,CAAEA,CAACA,CAAEA,IAAIA,CAACA,OAAQA,CAACA,CAACA,CAACA;YACtBA,IAAIA,0BAA0BA,GAAuCA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,eAAeA,EAAEA,CAAEA,CAACA;YACxGA,GAAGA,CAAAA,CAAcA,UAAWA,EAAvBA,uBAAQA,EAARA,IAAwBA,CAACA;gBAAzBA,IAAIA,IAAIA,GAAIA,WAAWA,IAAfA;gBACZA,EAAEA,CAAAA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,eAAeA,CAAEA,IAAIA,CAAGA,CAACA;oBAACA,0BAA0BA,CAACA,IAAIA,CAAEA,IAAIA,CAACA,OAAOA,CAACA,eAAeA,CAAEA,IAAIA,CAAEA,CAAEA,CAACA;aACnHA;YAEDA,EAAEA,CAAAA,CAAEA,0BAA0BA,CAACA,MAAMA,GAAGA,CAAEA,CAACA,CAACA,CAACA;gBAC5CA,cAAcA,GAAGA,YAAYA,CAACA,QAAQA,CAACA,4BAA4BA,CAAEA,0BAA0BA,CAAEA,CAACA;YACnGA,CAACA;YAACA,IAAIA,CAACA,CAACA;gBACPA,cAAcA,GAAGA,0BAA0BA,CAAEA,CAACA,CAAEA,CAACA;YAClDA,CAACA;QACFA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACPA,cAAcA,GAAGA,IAAIA,YAAYA,CAACA,oBAAoBA,EAAEA,CAACA;QAC1DA,CAACA;QAEDA,MAAMA,CAACA,cAAcA,CAACA;IACvBA,CAACA;IAEOnB,0CAAsBA,GAA9BA,UAAgCA,cAAqBA;QACpDoB,EAAEA,CAAAA,CAAEA,CAAEA,cAAcA,CAAEA,OAAOA,CAAGA,CAACA;YAACA,MAAMA,CAACA,EAAEA,CAACA;QAE5CA,MAAMA,CAACA,cAAcA,CAAEA,OAAOA,CAAEA,CAACA;IAClCA,CAACA;IAEOpB,oCAAgBA,GAAxBA,UAA0BA,QAAuBA;QAChDqB,EAAEA,CAAAA,CAAEA,CAAEA,QAAQA,CAACA,KAAMA,CAACA;YAACA,MAAMA,CAACA,EAAEA,CAACA;QACjCA,MAAMA,CAACA,QAAQA,CAACA,KAAKA,CAACA;IACvBA,CAACA;IACFrB,gBAACA;AAADA,CA5UA,AA4UCA,IAAA;AAED;kBAAe,SAAS,CAAC","file":"Documents.js","sourcesContent":["/// <reference path=\"../typings/tsd.d.ts\" />\n\nimport * as jsonld from \"jsonld\";\n\nimport Committer from \"./Committer\";\nimport * as Errors from \"./Errors\";\nimport * as HTTP from \"./HTTP\";\nimport Context from \"./Context\";\nimport * as RDF from \"./RDF\";\nimport * as Utils from \"./Utils\";\n\nimport * as Document from \"./Document\";\nimport * as Fragment from \"./Fragment\";\nimport * as JSONLDConverter from \"./JSONLDConverter\";\nimport * as PersistedDocument from \"./PersistedDocument\";\nimport * as Pointer from \"./Pointer\";\nimport * as NamedFragment from \"./NamedFragment\";\nimport * as NS from \"./NS\";\nimport * as ObjectSchema from \"./ObjectSchema\";\nimport * as LDP from \"./NS/LDP\";\nimport * as Resource from \"./Resource\";\nimport * as SPARQL from \"./SPARQL\";\n\nfunction parse( input:string ):any {\n\ttry {\n\t\treturn JSON.parse( input );\n\t} catch ( error ) {\n\t\t// TODO: Handle SyntaxError\n\t\tthrow error;\n\t}\n}\n\nfunction expand( [ result, response ]:[ Object, HTTP.Response.Class ], options?:jsonld.ExpandOptions ):Promise<[ Object, HTTP.Response.Class ]> {\n\treturn new Promise( ( resolve:( result:Object ) => void, reject:( error:any ) => void ) => {\n\t\tjsonld.expand( result, options, function ( error:any, expanded:Object ):void {\n\t\t\tif ( error ) {\n\t\t\t\t// TODO: Handle jsonld.expand error\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\tresult = expanded;\n\t\t\tresolve( [ result, response ] );\n\t\t} );\n\t} );\n}\n\nclass Documents implements Pointer.Library, Pointer.Validator, ObjectSchema.Resolver {\n\t_jsonldConverter:JSONLDConverter.Class;\n\n\tget jsonldConverter():JSONLDConverter.Class { return this._jsonldConverter; }\n\n\tprivate context:Context;\n\tprivate pointers:Map<string, Pointer.Class>;\n\n\tconstructor( context:Context = null ) {\n\t\tthis.context = context;\n\n\t\tthis.pointers = new Map<string, Pointer.Class>();\n\n\t\tif( !! this.context && !! this.context.parentContext ) {\n\t\t\tlet contextJSONLDConverter:JSONLDConverter.Class = this.context.parentContext.Documents.jsonldConverter;\n\t\t\tthis._jsonldConverter = new JSONLDConverter.Class( contextJSONLDConverter.literalSerializers );\n\t\t} else {\n\t\t\tthis._jsonldConverter = new JSONLDConverter.Class();\n\t\t}\n\t}\n\n\tinScope( pointer:Pointer.Class ):boolean;\n\tinScope( id:string ):boolean;\n\tinScope( idOrPointer:any ):boolean {\n\t\tlet id:string = Pointer.Factory.is( idOrPointer ) ? idOrPointer.id : idOrPointer;\n\n\t\tif( RDF.URI.Util.isBNodeID( id ) ) return false;\n\n\t\tif( !! this.context ) {\n\t\t\tlet baseURI:string = this.context.getBaseURI();\n\t\t\tif( RDF.URI.Util.isAbsolute( id ) && RDF.URI.Util.isBaseOf( baseURI, id ) ) return true;\n\t\t} else {\n\t\t\tif( RDF.URI.Util.isAbsolute( id ) ) return true;\n\t\t}\n\n\t\tif( !! this.context && !! this.context.parentContext ) return this.context.parentContext.Documents.inScope( id );\n\n\t\treturn false;\n\t}\n\n\thasPointer( id:string ):boolean {\n\t\tid = this.getPointerID( id );\n\n\t\tif( this.pointers.has( id ) ) return true;\n\n\t\tif( !! this.context && !! this.context.parentContext ) return this.context.parentContext.Documents.hasPointer( id );\n\n\t\treturn false;\n\t}\n\n\tgetPointer( id:string ):Pointer.Class {\n\t\tlet localID:string = this.getPointerID( id );\n\n\t\tif( ! localID ) {\n\t\t\tif( !! this.context && !! this.context.parentContext ) return this.context.parentContext.Documents.getPointer( id );\n\t\t\tthrow new Errors.IllegalArgumentError( \"The pointer id is not supported by this module.\" );\n\t\t}\n\n\t\tlet pointer:Pointer.Class;\n\t\tif( ! this.pointers.has( localID ) ) {\n\t\t\tpointer = this.createPointer( localID );\n\t\t\tthis.pointers.set( localID, pointer );\n\t\t}\n\n\t\treturn this.pointers.get( localID );\n\t}\n\n\tget( uri:string, requestOptions:HTTP.Request.Options = {} ):Promise<[ PersistedDocument.Class, HTTP.Response.Class ]> {\n\t\tlet pointerID:string = this.getPointerID( uri );\n\t\tif( !! this.context ) uri = this.context.resolve( uri );\n\n\t\tif( this.pointers.has( pointerID ) ) {\n\t\t\tlet pointer:Pointer.Class = this.getPointer( uri );\n\t\t\tif( pointer.isResolved() ) {\n\t\t\t\treturn new Promise( ( resolve:( result:[ PersistedDocument.Class, HTTP.Response.Class ]) => void, reject:( error:Error ) => void ) => {\n\t\t\t\t\tresolve( [ <any> pointer, null ] );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.RDFSource, requestOptions );\n\n\t\treturn HTTP.Request.Service.get( uri, requestOptions ).then(\n\t\t\t( response:HTTP.Response.Class ) => {\n\t\t\t\tlet parsedObject:Object = parse( response.data );\n\n\t\t\t\treturn expand( [ parsedObject, response ] );\n\t\t\t}\n\t\t).then(\n\t\t\t( [ expandedResult, response ]:[ Object, HTTP.Response.Class ] ) => {\n\t\t\t\tlet etag:string = HTTP.Response.Util.getETag( response );\n\t\t\t\tif( etag === null ) throw new HTTP.Errors.BadResponseError( \"The response doesn't contain an ETag\", response );\n\n\t\t\t\tlet rdfDocuments:RDF.Document.Class[] = RDF.Document.Util.getDocuments( expandedResult );\n\t\t\t\tlet rdfDocument:RDF.Document.Class = this.getRDFDocument( rdfDocuments, response );\n\n\t\t\t\tlet documentResources:RDF.Node.Class[] = RDF.Document.Util.getDocumentResources( rdfDocument );\n\t\t\t\tif( documentResources.length > 1 ) throw new HTTP.Errors.BadResponseError( \"The RDFDocument contains more than one document resource.\", response );\n\t\t\t\tif( documentResources.length === 0 ) throw new HTTP.Errors.BadResponseError( \"The RDFDocument doesn\\'t contain a document resource.\", response );\n\n\t\t\t\tlet documentResource:RDF.Node.Class = documentResources[ 0 ];\n\t\t\t\tlet fragmentResources:RDF.Node.Class[] = RDF.Document.Util.getBNodeResources( rdfDocument );\n\t\t\t\tlet namedFragmentResources:RDF.Node.Class[] = RDF.Document.Util.getFragmentResources( rdfDocument );\n\n\t\t\t\tlet documentPointer:Pointer.Class = this.getPointer( uri );\n\t\t\t\tdocumentPointer._resolved = true;\n\n\t\t\t\tlet document:PersistedDocument.Class = PersistedDocument.Factory.createFrom( documentPointer, uri, this );\n\t\t\t\tdocument._etag = etag;\n\n\t\t\t\tlet fragments:Fragment.Class[] = [];\n\t\t\t\tfor( let fragmentResource of fragmentResources ) {\n\t\t\t\t\tfragments.push( document.createFragment( fragmentResource[ \"@id\" ] ) );\n\t\t\t\t}\n\n\t\t\t\tlet namedFragments:NamedFragment.Class[] = [];\n\t\t\t\tfor( let namedFragmentResource of namedFragmentResources ) {\n\t\t\t\t\tnamedFragments.push( document.createNamedFragment( namedFragmentResource[ \"@id\" ] ) );\n\t\t\t\t}\n\n\t\t\t\tthis.compact( documentResource, document, document );\n\t\t\t\tthis.compact( fragmentResources, fragments, document );\n\t\t\t\tthis.compact( namedFragmentResources, namedFragments, document );\n\n\t\t\t\t// TODO: Decorate additional behavior (container, app, etc.)\n\t\t\t\treturn [ document, response ];\n\t\t\t}\n\t\t);\n\t}\n\tcreateChild( parentURI:string, slug:string, childDocument:Document.Class, requestOptions?:HTTP.Request.Options ):Promise<[ Pointer.Class, HTTP.Response.Class ]>;\n\tcreateChild( parentURI:string, childDocument:Document.Class, requestOptions?:HTTP.Request.Options ):Promise<[ Pointer.Class, HTTP.Response.Class ]>;\n\tcreateChild( parentURI:string, slugOrChildDocument:any, childDocumentOrRequestOptions:any = {}, requestOptions:HTTP.Request.Options = {} ):Promise<[ Pointer.Class, HTTP.Response.Class ]> {\n\t\tlet slug:string = Utils.isString( slugOrChildDocument ) ? slugOrChildDocument : null;\n\t\tlet childDocument:Document.Class = ! Utils.isString( slugOrChildDocument ) ? slugOrChildDocument : childDocumentOrRequestOptions;\n\t\trequestOptions = ! Utils.isString( slugOrChildDocument ) ? childDocumentOrRequestOptions : requestOptions;\n\n\t\tif( PersistedDocument.Factory.is( childDocument ) ) return Utils.P.createRejectedPromise( new Errors.IllegalArgumentError( \"The childDocument provided has been already persisted.\" ) );\n\n\t\tif( childDocument.id ) {\n\t\t\tif( ! RDF.URI.Util.isBaseOf( parentURI, childDocument.id ) ) return Utils.P.createRejectedPromise( new Errors.IllegalArgumentError( \"The childDocument's URI is not relative to the parentURI specified\" ) );\n\t\t}\n\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setContentTypeHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.Container, requestOptions );\n\n\t\tif( slug !== null ) HTTP.Request.Util.setSlug( slug, requestOptions );\n\n\t\tlet body:string = childDocument.toJSON( this, this.jsonldConverter );\n\n\t\treturn HTTP.Request.Service.post( parentURI, body, requestOptions ).then(\n\t\t\t( response:HTTP.Response.Class ) => {\n\t\t\t\tlet locationHeader:HTTP.Header.Class = response.headers.get( \"Location\" );\n\t\t\t\tif( locationHeader === null || locationHeader.values.length < 1 ) throw new HTTP.Errors.BadResponseError( \"The response is missing a Location header.\", response );\n\t\t\t\tif( locationHeader.values.length !== 1 ) throw new HTTP.Errors.BadResponseError( \"The response contains more than one Location header.\", response );\n\n\t\t\t\tlet locationURI:string = locationHeader.values[0].toString();\n\t\t\t\tlet pointer:Pointer.Class = this.getPointer( locationURI);\n\n\t\t\t\treturn [\n\t\t\t\t\tpointer,\n\t\t\t\t\tresponse,\n\t\t\t\t];\n\t\t\t}\n\t\t);\n\t}\n\n\tsave( persistedDocument:PersistedDocument.Class, requestOptions:HTTP.Request.Options = {} ):Promise<[ PersistedDocument.Class, HTTP.Response.Class ]> {\n\t\t// TODO: Check if the document isDirty\n\t\t/*\n\t\tif( ! persistedDocument.isDirty() ) return new Promise<HTTP.Response.Class>( ( resolve:( result:HTTP.Response.Class ) => void ) => {\n\t\t\tresolve( null );\n\t\t});\n\t\t*/\n\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setContentTypeHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.RDFSource, requestOptions );\n\t\tHTTP.Request.Util.setIfMatchHeader( persistedDocument._etag, requestOptions );\n\n\t\tlet body:string = persistedDocument.toJSON( this, this.jsonldConverter );\n\n\t\treturn HTTP.Request.Service.put( persistedDocument.id, body, requestOptions ).then( ( response:HTTP.Response.Class ) => {\n\t\t\treturn [ persistedDocument, response ];\n\t\t});\n\t}\n\n\tdelete( persistedDocument:PersistedDocument.Class, requestOptions:HTTP.Request.Options = {} ):Promise<HTTP.Response.Class> {\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\tHTTP.Request.Util.setAcceptHeader( \"application/ld+json\", requestOptions );\n\t\tHTTP.Request.Util.setPreferredInteractionModel( LDP.Class.RDFSource, requestOptions );\n\t\tHTTP.Request.Util.setIfMatchHeader( persistedDocument._etag, requestOptions );\n\n\t\treturn HTTP.Request.Service.delete( persistedDocument.id, persistedDocument.toJSON(), requestOptions );\n\t}\n\n\tgetSchemaFor( object:Object ):ObjectSchema.DigestedObjectSchema {\n\t\tif( \"@id\" in object ) {\n\t\t\treturn this.getDigestedObjectSchemaForExpandedObject( object );\n\t\t} else {\n\t\t\treturn this.getDigestedObjectSchemaForDocument( <any> object );\n\t\t}\n\t}\n\n\texecuteSELECTQuery( documentURI:string, selectQuery:string, requestOptions:HTTP.Request.Options = {} ):Promise<[ SPARQL.Results.Class, HTTP.Response.Class ]> {\n\t\tif( ! RDF.URI.Util.isAbsolute( documentURI ) ) {\n\t\t\tif( ! this.context ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\tdocumentURI = this.context.resolve( documentURI );\n\t\t}\n\n\t\tif ( this.context && this.context.Auth.isAuthenticated() ) this.context.Auth.addAuthentication( requestOptions );\n\n\t\treturn SPARQL.Service.executeSELECTQuery( documentURI, selectQuery, requestOptions );\n\t}\n\n\tprivate getRDFDocument( rdfDocuments:RDF.Document.Class[], response:HTTP.Response.Class ):RDF.Document.Class {\n\t\tif ( rdfDocuments.length === 0 ) throw new HTTP.Errors.BadResponseError( \"No document was returned.\", response );\n\t\tif ( rdfDocuments.length > 1 ) throw new Error( \"Unsupported: Multiple graphs are currently not supported.\" );\n\t\treturn rdfDocuments[ 0 ];\n\t}\n\n\tprivate getPointerID( uri:string ):string {\n\t\tif( RDF.URI.Util.isBNodeID( uri ) ) throw new Errors.IllegalArgumentError( \"BNodes cannot be fetched directly.\" );\n\t\t// TODO: Make named fragments independently resolvable\n\t\t/*\n\t\t\tif( RDF.URI.Util.hasFragment( uri ) ) throw new Errors.IllegalArgumentError( \"Fragment URI's cannot be fetched directly.\" );\n\t\t*/\n\n\t\tif( !! this.context ) {\n\t\t\t// TODO: Check this, it may be incorrect\n\t\t\tif( RDF.URI.Util.isRelative( uri ) ) {\n\t\t\t\tlet baseURI:string = this.context.getBaseURI();\n\t\t\t\tif( ! RDF.URI.Util.isBaseOf( baseURI, uri ) ) return null;\n\n\t\t\t\treturn uri.substring( baseURI.length );\n\t\t\t} else {\n\t\t\t\treturn uri;\n\t\t\t}\n\t\t} else {\n\t\t\tif( RDF.URI.Util.isRelative( uri ) ) throw new Errors.IllegalArgumentError( \"This Documents instance doesn't support relative URIs.\" );\n\t\t\treturn uri;\n\t\t}\n\t}\n\n\tprivate createPointer( localID:string ):Pointer.Class {\n\t\tlet id:string = !! this.context ? this.context.resolve( localID ) : localID;\n\t\tlet pointer:Pointer.Class = Pointer.Factory.create( id );\n\t\tObject.defineProperty( pointer, \"resolve\", {\n\t\t\twritable: false,\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: ():Promise<[ PersistedDocument.Class, HTTP.Response.Class ]> => {\n\t\t\t\treturn this.get( id );\n\t\t\t},\n\t\t});\n\n\t\treturn pointer;\n\t}\n\n\tprivate compact( expandedObjects:Object[], targetObjects:Object[], pointerLibrary:Pointer.Library ):Object[];\n\tprivate compact( expandedObject:Object, targetObject:Object, pointerLibrary:Pointer.Library ):Object;\n\tprivate compact( expandedObjectOrObjects:any, targetObjectOrObjects:any, pointerLibrary:Pointer.Library ):any {\n\t\tif( ! Utils.isArray( expandedObjectOrObjects ) ) return this.compactSingle( expandedObjectOrObjects, targetObjectOrObjects, pointerLibrary );\n\n\t\tlet expandedObjects:Object[] = expandedObjectOrObjects;\n\t\tlet targetObjects:Object[] = !! targetObjectOrObjects ? targetObjectOrObjects : [];\n\t\tfor( let i:number = 0, length:number = expandedObjects.length; i < length; i++ ) {\n\t\t\tlet expandedObject:Object = expandedObjects[ i ];\n\t\t\tlet targetObject:Object = targetObjects[ i ] = !! targetObjects[ i ] ? targetObjects[ i ] : {};\n\n\t\t\tthis.compactSingle( expandedObject, targetObject, pointerLibrary );\n\t\t}\n\n\t\treturn targetObjects;\n\t}\n\n\tprivate compactSingle( expandedObject:Object, targetObject:Object, pointerLibrary:Pointer.Library ):Object {\n\t\tlet digestedSchema:ObjectSchema.DigestedObjectSchema = this.getDigestedObjectSchemaForExpandedObject( expandedObject );\n\n\t\treturn this.jsonldConverter.compact( expandedObject, targetObject, digestedSchema, pointerLibrary );\n\t}\n\n\tprivate getDigestedObjectSchemaForExpandedObject( expandedObject:Object ):ObjectSchema.DigestedObjectSchema {\n\t\tlet types:string[] = this.getExpandedObjectTypes( expandedObject );\n\n\t\treturn this.getDigestedObjectSchema( types );\n\t}\n\n\tprivate getDigestedObjectSchemaForDocument( document:Document.Class ):ObjectSchema.DigestedObjectSchema {\n\t\tlet types:string[] = this.getDocumentTypes( document );\n\n\t\treturn this.getDigestedObjectSchema( types );\n\t}\n\n\tprivate getDigestedObjectSchema( objectTypes:string[] ):ObjectSchema.DigestedObjectSchema {\n\t\tlet digestedSchema:ObjectSchema.DigestedObjectSchema;\n\t\tif( !! this.context ) {\n\t\t\tlet typesDigestedObjectSchemas:ObjectSchema.DigestedObjectSchema[] = [ this.context.getObjectSchema() ];\n\t\t\tfor( let type of objectTypes ) {\n\t\t\t\tif( this.context.getObjectSchema( type ) ) typesDigestedObjectSchemas.push( this.context.getObjectSchema( type ) );\n\t\t\t}\n\n\t\t\tif( typesDigestedObjectSchemas.length > 1 ) {\n\t\t\t\tdigestedSchema = ObjectSchema.Digester.combineDigestedObjectSchemas( typesDigestedObjectSchemas );\n\t\t\t} else {\n\t\t\t\tdigestedSchema = typesDigestedObjectSchemas[ 0 ];\n\t\t\t}\n\t\t} else {\n\t\t\tdigestedSchema = new ObjectSchema.DigestedObjectSchema();\n\t\t}\n\n\t\treturn digestedSchema;\n\t}\n\n\tprivate getExpandedObjectTypes( expandedObject:Object ):string[] {\n\t\tif( ! expandedObject[ \"@type\" ] ) return [];\n\n\t\treturn expandedObject[ \"@type\" ];\n\t}\n\n\tprivate getDocumentTypes( document:Document.Class ):string[] {\n\t\tif( ! document.types ) return [];\n\t\treturn document.types;\n\t}\n}\n\nexport default Documents;\n"],"sourceRoot":"/source/"}