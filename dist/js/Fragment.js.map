{"version":3,"sources":["Fragment.ts"],"names":["externalAnonymousFragmentFilter","Factory","Factory.constructor","Factory.hasClassProperties","Factory.from","Factory.singleFrom","Factory.injectBehavior","Util","Util.constructor","Util.generateID"],"mappings":"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","file":"Fragment.js","sourcesContent":["import * as Document from \"./Document\";\nimport * as Errors from \"./Errors\";\nimport * as RDF from \"./RDF\";\nimport * as Utils from \"./Utils\";\n\nexport interface Class extends RDF.Resource.Class {\n\tdocument:Document.Class;\n}\n\nfunction externalAnonymousFragmentFilter( propertyURI:string, value:(RDF.Node.Class | RDF.Literal.Class) ):void {\n\tif( ! RDF.Node.Factory.is( value ) ) return;\n\tif( ! RDF.URI.Util.isBNodeID( value[ \"@id\" ] ) ) return;\n\n\tif( ! ( \"document\" in value ) ) throw new Errors.IllegalArgumentError( \"The resource provided doesn't belong to a document.\" );\n\n\tlet fragment:Class = <any> value;\n\n\tif( this.document !== fragment.document ) throw new Errors.IllegalArgumentError( \"The anonymous fragment provided belongs to another document. To reference it from another document it needs to be named.\" );\n}\n\nexport class Factory {\n\thasClassProperties( resource:RDF.Resource.Class ):boolean {\n\t\treturn (\n\t\t\tUtils.hasPropertyDefined( resource, \"document\" )\n\t\t);\n\t}\n\n\tfrom<T extends Object>( nodes:T[], document:Document.Class ):( T & Class )[];\n\tfrom<T extends Object>( node:T, document:Document.Class ):( T & Class );\n\tfrom( nodeOrNodes:any, document:Document.Class ):any {\n\t\tif( ! Utils.isArray( nodeOrNodes ) ) return this.singleFrom( nodeOrNodes, document );\n\n\t\tfor( let node of nodeOrNodes ) {\n\t\t\tthis.singleFrom( node, document );\n\t\t}\n\n\t\treturn <any> nodeOrNodes;\n\t}\n\n\tprotected singleFrom<T extends Object>( node:T, document:Document.Class ):( T & Class ) {\n\t\tlet resource:( T & RDF.Resource.Class ) = RDF.Resource.factory.from( node );\n\n\t\tif ( ! this.hasClassProperties( resource ) ) this.injectBehavior( resource, document );\n\n\t\treturn <any> node;\n\t}\n\n\tprotected injectBehavior<T extends RDF.Resource.Class>( object:T, document:Document.Class ):( T & Class ) {\n\t\tif( this.hasClassProperties( object ) ) return <any> object;\n\n\t\tobject._propertyAddedCallbacks.push( externalAnonymousFragmentFilter );\n\n\t\tObject.defineProperties( object, {\n\t\t\t\"document\": {\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\tvalue: document,\n\t\t\t},\n\t\t} );\n\n\t\treturn <any> object;\n\t}\n}\n\nexport var factory:Factory = new Factory();\n\nexport class Util {\n\tstatic generateID():string {\n\t\treturn \"_:\" + Utils.UUID.generate();\n\t}\n}\n\nexport default Class;\n"],"sourceRoot":"/source/"}