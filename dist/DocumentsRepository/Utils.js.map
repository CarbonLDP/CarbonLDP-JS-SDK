{"version":3,"sources":["DocumentsRepository/Utils.ts"],"names":[],"mappings":";;AAEA,gEAA+D;AAI/D,uDAAsD;AAEtD,sDAAqD;AAErD,8CAA6C;AAE7C,4CAA8C;AAG9C,kCAAiC;AAIjC,kCAAoC;AAGpC,yBAA+C,QAA0B,EAAE,GAAe,EAAE,IAAgB;IAC3G,IAAM,IAAI,GAAU,gBAAQ,CAAE,GAAG,CAAE,CAAC,CAAC;QACpC,SAAG,CAAC,OAAO,CAAE,QAAQ,CAAC,GAAG,EAAE,GAAG,CAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC;IAEjD,IAAM,KAAK,GAAS,CAAE,gBAAQ,CAAE,GAAG,CAAE,CAAC,CAAC;QACtC,KAAK,CAAC,IAAI,CAAE,IAAI,CAAE,CAAC,CAAC;QACpB,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAE,IAAI,EAAE,CAAC,CAAE,CAAC;IAEvC,MAAM,CAAC,EAAE,IAAI,MAAA,EAAE,KAAK,OAAA,EAAE,CAAC;AACxB,CAAC;AATD,0CASC;AAED,8BAAoD,QAA0B,EAAE,SAAgC,EAAE,IAAgB;IACjI,IAAM,SAAS,GAAqB,iBAAO,CAAC,EAAE,CAAE,SAAS,CAAE,CAAC,CAAC;QAC5D,SAAS,CAAC,CAAC,CAAC,QAAQ,CAAC;IAEtB,IAAM,KAAK,GAAS,CAAE,iBAAO,CAAC,EAAE,CAAE,SAAS,CAAE,CAAC,CAAC;QAC9C,KAAK,CAAC,IAAI,CAAE,IAAI,CAAE,CAAC,CAAC;QACpB,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAE,IAAI,EAAE,CAAC,CAAE,CAAC;IAEvC,MAAM,CAAC,EAAE,SAAS,WAAA,EAAE,KAAK,OAAA,EAAE,CAAC;AAC7B,CAAC;AATD,oDASC;AAGD,mCAAsD,QAA0B;IAC/E,MAAM,CAAC,UAAE,KAAuB;QAC/B,EAAE,CAAA,CAAE,CAAE,CAAC,UAAU,IAAI,KAAK,CAAE,CAAC;YAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAE,KAAK,CAAE,CAAC;QAC7D,EAAE,CAAA,CAAE,CAAE,KAAK,CAAC,QAAQ,CAAC,IAAK,CAAC;YAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAE,KAAK,CAAE,CAAC;QAE3D,MAAM,CAAC,IAAI,2BAAY,EAAE;aACvB,KAAK,CAAE,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAE;aAC5B,IAAI,CAAE,UAAE,QAAkB;YAC1B,IAAM,SAAS,GAAa,sBAAW,CAAC,YAAY,CAAE,QAAQ,CAAE,CAAC;YACjE,IAAM,aAAa,GAAiB,6BAAa,CAAC,cAAc,CAAE,QAAQ,EAAE,SAAS,CAAE,CAAC;YAExF,IAAM,cAAc,GAAmB,aAAa;iBAClD,WAAW,CAAE,IAAI,CAAE;iBACnB,MAAM,CAAE,6BAAa,CAAC,EAAE,CAAE,CAAC;YAE7B,EAAE,CAAA,CAAE,cAAc,CAAC,MAAM,KAAK,CAAE,CAAC;gBAChC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAE,KAAK,CAAE,CAAC;YAEhC,IAAM,aAAa,GAAiB,MAAM,CAAC,MAAM,CAAE,KAAK,EAAE,cAAc,CAAE,CAAC,CAAE,CAAE,CAAC;YAChF,KAAK,CAAC,OAAO,GAAG,6BAAa,CAAC,UAAU,CAAE,aAAa,CAAE,CAAC;YAE1D,MAAM,CAAC,OAAO,CAAC,MAAM,CAAE,KAAK,CAAE,CAAC;QAChC,CAAC,EAAE;YACF,MAAM,CAAC,OAAO,CAAC,MAAM,CAAE,KAAK,CAAE,CAAC;QAChC,CAAC,CAAE,CAAC;IACN,CAAC,CAAC;AACH,CAAC;AA1BD,8DA0BC","file":"Utils.js","sourcesContent":["import { DocumentsRegistry } from \"../DocumentsRegistry/DocumentsRegistry\";\n\nimport { FreeResources } from \"../FreeResources/FreeResources\";\n\nimport { HTTPError } from \"../HTTP/Errors/HTTPError\";\n\nimport { JSONLDParser } from \"../JSONLD/JSONLDParser\";\n\nimport { ErrorResponse } from \"../LDP/ErrorResponse\";\n\nimport { Pointer } from \"../Pointer/Pointer\";\n\nimport { RDFDocument } from \"../RDF/Document\";\nimport { RDFNode } from \"../RDF/Node\";\n\nimport { URI } from \"../RDF/URI\";\n\nimport { ResolvablePointer } from \"../Repository/ResolvablePointer\";\n\nimport { isString } from \"../Utils\";\n\n\nexport function _parseURIParams<T>( this:void, resource:ResolvablePointer, uri?:string | T, args?:IArguments ):{ _uri:string, _args:any[] } {\n\tconst _uri:string = isString( uri ) ?\n\t\tURI.resolve( resource.$id, uri ) : resource.$id;\n\n\tconst _args:any[] = ! isString( uri ) ?\n\t\tArray.from( args ) :\n\t\tArray.prototype.slice.call( args, 1 );\n\n\treturn { _uri, _args };\n}\n\nexport function _parseResourceParams<T>( this:void, resource:ResolvablePointer, $resource?:ResolvablePointer | T, args?:IArguments ):{ _resource:ResolvablePointer, _args:any[] } {\n\tconst _resource:ResolvablePointer = Pointer.is( $resource ) ?\n\t\t$resource : resource;\n\n\tconst _args:any[] = ! Pointer.is( $resource ) ?\n\t\tArray.from( args ) :\n\t\tArray.prototype.slice.call( args, 1 );\n\n\treturn { _resource, _args };\n}\n\n\nexport function _getErrorResponseParserFn( this:void, registry:DocumentsRegistry ):( error:HTTPError | Error ) => Promise<never> {\n\treturn ( error:HTTPError | Error ) => {\n\t\tif( ! (\"response\" in error) ) return Promise.reject( error );\n\t\tif( ! error.response.data ) return Promise.reject( error );\n\n\t\treturn new JSONLDParser()\n\t\t\t.parse( error.response.data )\n\t\t\t.then( ( rdfNodes:RDFNode[] ) => {\n\t\t\t\tconst freeNodes:RDFNode[] = RDFDocument.getFreeNodes( rdfNodes );\n\t\t\t\tconst freeResources:FreeResources = FreeResources.parseFreeNodes( registry, freeNodes );\n\n\t\t\t\tconst errorResponses:ErrorResponse[] = freeResources\n\t\t\t\t\t.getPointers( true )\n\t\t\t\t\t.filter( ErrorResponse.is );\n\n\t\t\t\tif( errorResponses.length === 0 )\n\t\t\t\t\treturn Promise.reject( error );\n\n\t\t\t\tconst errorResponse:ErrorResponse = Object.assign( error, errorResponses[ 0 ] );\n\t\t\t\terror.message = ErrorResponse.getMessage( errorResponse );\n\n\t\t\t\treturn Promise.reject( error );\n\t\t\t}, () => {\n\t\t\t\treturn Promise.reject( error );\n\t\t\t} );\n\t};\n}\n"]}