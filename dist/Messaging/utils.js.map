{"version":3,"sources":["Messaging/Utils.ts"],"names":[],"mappings":";;AAEA,uEAAsE;AACtE,iEAAgE;AAChE,kCAAiC;AACjC,qCAA6C;AAE7C,8BAAsC,OAAe;IACpD,EAAE,CAAA,CAAE,CAAE,CAAE,OAAO,IAAK,OAAqB,CAAC,SAAS,YAAY,0BAAgB,CAAG,CAAC;QAClF,MAAM,IAAI,qCAAiB,CAAE,yDAAyD,CAAE,CAAC;AAC3F,CAAC;AAHD,oDAGC;AAED,2BAAmC,KAAY;IAC9C,EAAE,CAAA,CAAE,CAAE,4GAA4G,CAAC,IAAI,CAAE,KAAK,CAAG,CAAC;QAAC,MAAM,IAAI,2CAAoB,CAAE,2BAAyB,KAAK,mBAAgB,CAAE,CAAC;AACrN,CAAC;AAFD,8CAEC;AAED,yBAAiC,UAAiB,EAAE,OAAc;IACjE,EAAE,CAAA,CAAE,CAAE,SAAG,CAAC,QAAQ,CAAE,OAAO,EAAE,UAAU,CAAG,CAAC;QAAC,MAAM,IAAI,2CAAoB,CAAE,2BAAyB,UAAU,mDAAgD,CAAE,CAAC;IAElK,EAAE,CAAA,CAAE,UAAU,KAAK,GAAI,CAAC;QAAC,MAAM,CAAC,EAAE,CAAC;IACnC,UAAU,GAAG,SAAG,CAAC,cAAc,CAAE,UAAU,EAAE,OAAO,CAAE,CAAC;IACvD,UAAU,GAAG,UAAU,CAAC,SAAS,CAAE,CAAE,UAAU,CAAC,UAAU,CAAE,GAAG,CAAE,EAAE,UAAU,CAAC,MAAM,GAAG,CAAE,UAAU,CAAC,QAAQ,CAAE,GAAG,CAAE,CAAE,CAAC;IAEtH,MAAM,CAAC,UAAU;SACf,KAAK,CAAE,GAAG,CAAE;SACZ,GAAG,CAAE,UAAA,IAAI;QACT,EAAE,CAAA,CAAE,IAAI,KAAK,IAAK,CAAC;YAAC,MAAM,CAAC,GAAG,CAAC;QAC/B,MAAM,CAAC,kBAAkB,CAAE,IAAI,CAAE;aAC/B,OAAO,CAAE,KAAK,EAAE,GAAG,CAAE,CAAC;IACzB,CAAC,CAAE,CAAC,IAAI,CAAE,GAAG,CAAE,CACd;AACH,CAAC;AAfD,0CAeC;AAED,2BAAmC,KAAY,EAAE,UAAiB,EAAE,OAAc;IACjF,iBAAiB,CAAE,KAAK,CAAE,CAAC;IAE3B,UAAU,GAAG,eAAe,CAAE,UAAU,EAAE,OAAO,CAAE,CAAC;IACpD,MAAM,CAAC,YAAW,KAAK,IAAK,UAAU,CAAC,CAAC,CAAC,GAAG,GAAG,UAAU,CAAC,CAAC,CAAC,UAAU,CAAG,CAAC;AAC3E,CAAC;AALD,8CAKC","file":"Utils.js","sourcesContent":["import { CarbonLDP } from \"../CarbonLDP\";\nimport { Context } from \"../Context\";\nimport { IllegalArgumentError } from \"../Errors/IllegalArgumentError\";\nimport { IllegalStateError } from \"../Errors/IllegalStateError\";\nimport { URI } from \"../RDF/URI\";\nimport { MessagingService } from \"./Service\";\n\nexport function validateEventContext( context:Context ):void {\n\tif( ! ( context && (context as CarbonLDP).messaging instanceof MessagingService ) )\n\t\tthrow new IllegalStateError( \"This instance does not support messaging subscriptions.\" );\n}\n\nexport function validateEventType( event:string ):void {\n\tif( ! /(access-point|child|\\*)\\.(created|\\*)|(document|\\*)\\.(modified|deleted|\\*)|(member|\\*)\\.(added|removed|\\*)/.test( event ) ) throw new IllegalArgumentError( `Provided event type \"${ event }\" is invalid.` );\n}\n\nexport function parseURIPattern( uriPattern:string, baseURI:string ):string {\n\tif( ! URI.isBaseOf( baseURI, uriPattern ) ) throw new IllegalArgumentError( `Provided uriPattern \"${ uriPattern }\" is an invalid for your Carbon LDP instance.` );\n\n\tif( uriPattern === \"/\" ) return \"\";\n\turiPattern = URI.getRelativeURI( uriPattern, baseURI );\n\turiPattern = uriPattern.substring( + uriPattern.startsWith( \"/\" ), uriPattern.length - + uriPattern.endsWith( \"/\" ) );\n\n\treturn uriPattern\n\t\t.split( \"/\" )\n\t\t.map( slug => {\n\t\t\tif( slug === \"**\" ) return \"#\";\n\t\t\treturn encodeURIComponent( slug )\n\t\t\t\t.replace( /\\./g, \"^\" );\n\t\t} ).join( \".\" )\n\t\t;\n}\n\nexport function createDestination( event:string, uriPattern:string, baseURI:string ):string {\n\tvalidateEventType( event );\n\n\turiPattern = parseURIPattern( uriPattern, baseURI );\n\treturn `/topic/${ event }${ uriPattern ? \".\" + uriPattern : uriPattern }`;\n}\n"]}