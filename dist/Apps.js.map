{"version":3,"sources":["Apps.ts"],"names":[],"mappings":"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","file":"Apps.js","sourcesContent":["import AppContext from \"./App/Context\";\nimport * as Document from \"./Document\";\nimport Context from \"./Context\";\nimport * as Response from \"./HTTP/Response\";\nimport * as Pointer from \"./Pointer\";\nimport * as RDF from \"./RDF\";\nimport * as Utils from \"./Utils\";\nimport * as App from \"./App\";\nimport * as PersistedApp from \"./PersistedApp\";\nimport * as Errors from \"./Errors\";\n\nexport class Class {\n\tprivate context:Context;\n\n\tconstructor( context:Context ) {\n\t\tthis.context = context;\n\t}\n\n\tgetContext( uri:string ):Promise<AppContext>;\n\tgetContext( pointer:Pointer.Class ):Promise<AppContext>;\n\tgetContext( pointerOrURI:any ):Promise<AppContext> {\n\t\tlet pointer:Pointer.Class = ! Utils.isString( pointerOrURI ) ? pointerOrURI : null;\n\n\t\tif( ! pointer ) {\n\t\t\tlet appsContainerURI:string = this.getAppsContainerURI();\n\t\t\tlet uri:string = Utils.isString( pointerOrURI ) ? pointerOrURI : null;\n\n\t\t\tif( ! uri ) return Promise.reject<AppContext>( new Errors.IllegalArgumentError( \"The application's URI cannot be null\" ) );\n\n\t\t\tif ( RDF.URI.Util.isRelative( uri ) ) {\n\t\t\t\tif ( ! Utils.S.startsWith( uri, appsContainerURI ) ) uri = RDF.URI.Util.resolve( appsContainerURI, uri );\n\t\t\t\turi = this.context.resolve( uri );\n\t\t\t}\n\n\t\t\tpointer = this.context.documents.getPointer( uri );\n\t\t}\n\n\t\treturn pointer.resolve().then( ( [ app, response ]:[ Document.Class, Response.Class ] ) => {\n\t\t\tif ( ! PersistedApp.Factory.is( app ) )\n\t\t\t\treturn Promise.reject<AppContext>( new Errors.IllegalArgumentError( \"The resource fetched is not a cs:Application.\" ) );\n\n\t\t\treturn new AppContext( this.context, <PersistedApp.Class> app );\n\t\t});\n\t}\n\n\tgetAllContexts():Promise<AppContext[]> {\n\t\treturn this.context.documents.getMembers( this.getAppsContainerURI(), false ).then(\n\t\t\t( [ members, response ]:[ Pointer.Class[], Response.Class ] ) => {\n\t\t\t\treturn Pointer.Util.resolveAll( members );\n\t\t\t}\n\t\t).then(\n\t\t\t( [ members, responses ]:[ Pointer.Class[], Response.Class[] ] ) => {\n\t\t\t\treturn members.map( ( member:Pointer.Class ) => new AppContext( this.context, <any> member ) );\n\t\t\t}\n\t\t);\n\t}\n\n\tcreate( appDocument:App.Class ):Promise<[ Pointer.Class, Response.Class]>;\n\tcreate( slug:string, appDocument:App.Class ):Promise<[ Pointer.Class, Response.Class]>;\n\tcreate( slugOrApp:any, appDocument?:App.Class ):Promise<[ Pointer.Class, Response.Class]> {\n\t\tlet appsContainerURI:string = this.context.resolve( this.getAppsContainerURI() );\n\t\tlet slug:string = Utils.isString( slugOrApp ) ? slugOrApp : null;\n\t\tappDocument = appDocument || slugOrApp;\n\n\t\tif ( ! App.Factory.is( appDocument ) ) return Promise.reject<any>( new Errors.IllegalArgumentError( \"The Document is not a `Carbon.App.Class` object.\" ) );\n\n\t\treturn this.context.documents.createChild( appsContainerURI, slug, appDocument );\n\t}\n\n\tprivate getAppsContainerURI():string {\n\t\tif ( ! this.context.hasSetting( \"platform.apps.container\" ) ) throw new Errors.IllegalStateError( \"The apps container URI hasn't been set.\" );\n\t\treturn this.context.getSetting( \"platform.apps.container\" );\n\t}\n}\n\nexport default Class;\n"],"sourceRoot":"/source/"}