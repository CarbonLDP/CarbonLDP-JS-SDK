{"version":3,"sources":["Auth/Users.ts"],"names":[],"mappings":"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","file":"Users.js","sourcesContent":["import { Context } from \"../Context\";\nimport { promiseMethod } from \"../Utils\";\nimport * as Errors from \"../Errors\";\nimport * as HTTP from \"./../HTTP\";\nimport { Pointer } from \"./../Pointer\";\nimport * as URI from \"./../RDF/URI\";\nimport * as Credentials from \"./Credentials\";\nimport * as PersistedCredentials from \"./PersistedCredentials\";\nimport * as PersistedUser from \"./PersistedUser\";\n\nexport class Class {\n\tprivate context:Context;\n\n\tconstructor( context:Context ) {\n\t\tthis.context = context;\n\t}\n\n\tregister( email:string, password:string, enabled?:boolean ):Promise<[ PersistedUser.Class, HTTP.Response.Class ]> {\n\t\tconst credentials:Credentials.Class = Credentials.Factory.create( email, password );\n\t\tcredentials.enabled = enabled;\n\t\treturn promiseMethod( () => {\n\t\t\tconst containerURI:string = this.getCredentialsContainerURI();\n\t\t\treturn this.context.documents.createChildAndRetrieve<PersistedCredentials.Class>( containerURI, credentials as any );\n\t\t} ).then<[ PersistedUser.Class, HTTP.Response.Class ]>( ( [ persistedCredentials, response ] ) => {\n\t\t\treturn [ persistedCredentials.user, response ];\n\t\t} );\n\t}\n\n\tget( userURI:string, requestOptions?:HTTP.Request.Options ):Promise<[ PersistedUser.Class, HTTP.Response.Class ]> {\n\t\treturn new Promise( resolve =>\n\t\t\tresolve( this.context.documents.get( this.resolveURI( userURI ), requestOptions ) )\n\t\t);\n\t}\n\n\tenableCredentials( userURI:string, requestOptions?:HTTP.Request.Options ):Promise<[ PersistedUser.Class, HTTP.Response.Class[] ]> {\n\t\treturn this.changeEnabledStatus( userURI, true, requestOptions );\n\t}\n\n\tdisableCredentials( userURI:string, requestOptions?:HTTP.Request.Options ):Promise<[ PersistedUser.Class, HTTP.Response.Class[] ]> {\n\t\treturn this.changeEnabledStatus( userURI, false, requestOptions );\n\t}\n\n\tdelete( userURI:string, requestOptions?:HTTP.Request.Options ):Promise<HTTP.Response.Class> {\n\t\treturn new Promise( resolve =>\n\t\t\tresolve( this.context.documents.delete( this.resolveURI( userURI ), requestOptions ) )\n\t\t);\n\t}\n\n\tprivate changeEnabledStatus( userURI:string, value:boolean, requestOptions?:HTTP.Request.Options ):Promise<[ PersistedUser.Class, HTTP.Response.Class[] ]> {\n\t\treturn Promise.resolve().then( () => {\n\t\t\tconst absoluteUserURI:string = this.resolveURI( userURI );\n\t\t\tconst userPointer:Pointer = this.context.documents.getPointer( absoluteUserURI );\n\t\t\tconst persistedUser:PersistedUser.Class = PersistedUser.Factory.decorate( userPointer, this.context.documents );\n\n\t\t\tif( value ) return persistedUser.enableCredentials( requestOptions );\n\t\t\treturn persistedUser.disableCredentials( requestOptions );\n\t\t} );\n\t}\n\n\tprivate resolveURI( relativeURI:string ):string {\n\t\tconst usersContainer:string = this.getContainerURI();\n\t\tconst absoluteRoleURI:string = URI.Util.resolve( usersContainer, relativeURI );\n\t\tif( ! absoluteRoleURI.startsWith( usersContainer ) ) throw new Errors.IllegalArgumentError( `The provided URI \"${ relativeURI }\" isn't a valid Carbon LDP user.` );\n\n\t\treturn absoluteRoleURI;\n\t}\n\n\tprivate getContainerURI():string {\n\t\treturn this.context._resolvePath( \"users\" );\n\t}\n\n\tprivate getCredentialsContainerURI():string {\n\t\treturn this.context._resolvePath( \"system.credentials\" );\n\t}\n}\n\nexport default Class;\n"]}