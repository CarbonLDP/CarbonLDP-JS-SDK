{"version":3,"sources":["Auth/Agents.ts"],"names":[],"mappings":"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","file":"Auth/Agents.js","sourcesContent":["import * as Agent from \"./Agent\";\nimport Context from \"./../Context\";\nimport * as Errors from \"./../Errors\";\nimport * as HTTP from \"./../HTTP\";\nimport * as PersistedAgent from \"./PersistedAgent\";\nimport * as Pointer from \"./../Pointer\";\nimport * as URI from \"./../RDF/URI\";\nimport * as Utils from \"./../Utils\";\n\nexport class Class {\n\tprivate context:Context;\n\n\tconstructor( context:Context ) {\n\t\tthis.context = context;\n\t}\n\n\tregister( agentDocument:Agent.Class ):Promise<[ Pointer.Class, HTTP.Response.Class]>;\n\tregister( slug:string, agentDocument:Agent.Class ):Promise<[ Pointer.Class, HTTP.Response.Class]>;\n\tregister( slugOrAgent:any, agentDocument?:Agent.Class ):Promise<[ Pointer.Class, HTTP.Response.Class]> {\n\t\treturn this.resolveURI( \"\" ).then( ( containerURI:string ) => {\n\t\t\tlet slug:string = Utils.isString( slugOrAgent ) ? slugOrAgent : null;\n\t\t\tagentDocument = agentDocument || slugOrAgent;\n\n\t\t\tif( ! Agent.Factory.is( agentDocument ) ) throw new Errors.IllegalArgumentError( \"The Document is not a cs:Agent object.\" );\n\n\t\t\treturn slug ? this.context.documents.createChild( containerURI, slug, agentDocument ) : this.context.documents.createChild( containerURI, agentDocument );\n\t\t} );\n\t}\n\n\tget( agentURI:string, requestOptions?:HTTP.Request.Options ):Promise<[ PersistedAgent.Class, HTTP.Response.Class ]> {\n\t\treturn this.resolveURI( agentURI ).then( ( uri:string ) => {\n\t\t\treturn this.context.documents.get( uri, requestOptions );\n\t\t} );\n\t}\n\n\tenable( agentURI:string, requestOptions?:HTTP.Request.Options ):Promise<[ PersistedAgent.Class, [ HTTP.Response.Class, HTTP.Response.Class ] ]> {\n\t\treturn this.changeEnabledStatus( agentURI, true, requestOptions );\n\t}\n\n\tdisable( agentURI:string, requestOptions?:HTTP.Request.Options ):Promise<[ PersistedAgent.Class, [ HTTP.Response.Class, HTTP.Response.Class ] ]> {\n\t\treturn this.changeEnabledStatus( agentURI, false, requestOptions );\n\t}\n\n\tdelete( agentURI:string, requestOptions?:HTTP.Request.Options ):Promise<HTTP.Response.Class> {\n\t\treturn this.resolveURI( agentURI ).then( uri => {\n\t\t\treturn this.context.documents.delete( uri, requestOptions );\n\t\t} );\n\t}\n\n\tprivate changeEnabledStatus( agentURI:string, value:boolean, requestOptions?:HTTP.Request.Options ):Promise<[ PersistedAgent.Class, [ HTTP.Response.Class, HTTP.Response.Class ] ]> {\n\t\tlet getResponse:HTTP.Response.Class;\n\t\treturn this.get( agentURI, requestOptions ).then( ( [ agent, response ]:[ PersistedAgent.Class, HTTP.Response.Class ] ) => {\n\t\t\tgetResponse = response;\n\t\t\tagent.enabled = value;\n\t\t\treturn agent.save();\n\t\t} ).then( ( [ agent, response ]:[ PersistedAgent.Class, HTTP.Response.Class ] ) => {\n\t\t\treturn [ agent, [ getResponse, response ] ];\n\t\t} );\n\t}\n\n\tprivate resolveURI( agentURI:string ):Promise<string> {\n\t\treturn new Promise<string>( ( resolve:( uri:string ) => void ) => {\n\t\t\tlet containerURI:string = this.context.resolve( this.getContainerURI() );\n\t\t\tlet uri:string = URI.Util.resolve( containerURI, agentURI );\n\n\t\t\tif( ! URI.Util.isBaseOf( containerURI, uri ) ) throw new Errors.IllegalArgumentError( \"The URI provided is not a valid agent of the current context.\" );\n\n\t\t\tresolve( uri );\n\t\t} );\n\t}\n\n\tprivate getContainerURI():string {\n\t\tif( ! this.context.hasSetting( \"platform.agents.container\" ) ) throw new Errors.IllegalStateError( \"The agents container URI hasn't been set.\" );\n\t\treturn this.context.getSetting( \"platform.agents.container\" );\n\t}\n}\n\nexport default Class;\n"],"sourceRoot":"/source/"}