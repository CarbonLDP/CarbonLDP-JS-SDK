{"version":3,"sources":["Auth/PersistedUser.ts"],"names":[],"mappings":";;AAEA,4EAA2E;AAC3E,kCAGkB;AAClB,+BAA8B;AAyBjB,QAAA,aAAa,GAAwB;IACjD,WAAW,EAAX,UAAa,KAAS;QACrB,MAAM,CAAC,gBAAQ,CAAE,KAAK,CAAE;eACpB,mBAAW,CAAE,KAAK,EAAE,QAAQ,CAAE;eAC9B,mBAAW,CAAE,KAAK,EAAE,SAAS,CAAE,CACjC;IACH,CAAC;IAED,EAAE,EAAF,UAAI,KAAS;QACZ,MAAM,CAAC,qBAAa,CAAC,WAAW,CAAE,KAAK,CAAE;eACrC,WAAI,CAAC,WAAW,CAAE,KAAK,CAAE;eACzB,uDAA0B,CAAC,EAAE,CAAE,KAAK,CAAE,CACxC;IACH,CAAC;IAED,QAAQ,EAAR,UAA4B,MAAQ,EAAE,SAAmB;QACxD,EAAE,CAAA,CAAE,qBAAa,CAAC,WAAW,CAAE,MAAM,CAAG,CAAC;YAAC,MAAM,CAAC,MAAM,CAAC;QAExD,WAAI,CAAC,QAAQ,CAAE,MAAM,CAAE,CAAC;QACxB,uDAA0B,CAAC,QAAQ,CAAE,MAAM,EAAE,SAAS,CAAE,CAAC;QAEzD,MAAM,CAAC,MAAM,CAAC,gBAAgB,CAAE,MAAM,EAAE;YACvC,QAAQ,EAAE;gBACT,YAAY,EAAE,IAAI;gBAClB,QAAQ,EAAE,IAAI;gBACd,KAAK,EAAE,MAAM;aACb;YACD,SAAS,EAAE;gBACV,YAAY,EAAE,IAAI;gBAClB,QAAQ,EAAE,IAAI;gBACd,KAAK,EAAE,OAAO;aACd;SACD,CAAE,CAAC;IACL,CAAC;CACD,CAAC;AAGF,gBAA4C,cAA8B;IACzE,MAAM,CAAC,kBAAkB,CAAE,IAAI,EAAE,SAAS,EAAE,cAAc,CAAE,CAAC;AAC9D,CAAC;AAFD,wBAEC;AAED,iBAA6C,cAA8B;IAC1E,MAAM,CAAC,kBAAkB,CAAE,IAAI,EAAE,UAAU,EAAE,cAAc,CAAE,CAAC;AAC/D,CAAC;AAFD,0BAEC;AAED,4BAA6B,IAAkB,EAAE,IAA2B,EAAE,cAA8B;IAC3G,MAAM,CAAC,IAAI;SACT,OAAO,EAAE;SACT,IAAI,CAAE;QACN,IAAI,CAAE,IAAI,CAAE,GAAG,IAAI,CAAC;QAEpB,IAAM,OAAO,GAA0B,IAAI,KAAK,SAAS,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS,CAAC;QACnF,OAAO,IAAI,CAAE,OAAO,CAAE,CAAC;QAEvB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAE,cAAc,CAAE,CAAC;IACpC,CAAC,CAAE,CACF;AACH,CAAC","file":"PersistedUser.js","sourcesContent":["import { Documents } from \"../Documents\";\nimport { RequestOptions } from \"../HTTP\";\nimport { PersistedProtectedDocument } from \"../PersistedProtectedDocument\";\nimport {\n\thasFunction,\n\tisObject,\n} from \"../Utils\";\nimport { User } from \"./User\";\nimport { UsernameAndPasswordCredentials } from \"./UsernameAndPasswordCredentials\";\n\n\nexport interface PersistedUser extends PersistedProtectedDocument {\n\tname?:string;\n\tenabled?:boolean;\n\tdisabled?:boolean;\n\tcredentials?:UsernameAndPasswordCredentials;\n\n\tenable( requestOptions?:RequestOptions ):Promise<PersistedUser>;\n\n\tdisable( requestOptions?:RequestOptions ):Promise<PersistedUser>;\n}\n\n\nexport interface PersistedUserFactory {\n\tisDecorated( value:any ):value is PersistedUser;\n\n\tis( value:any ):value is PersistedUser;\n\n\n\tdecorate<T extends object>( object:T, documents:Documents ):PersistedUser & T;\n}\n\nexport const PersistedUser:PersistedUserFactory = {\n\tisDecorated( value:any ):value is PersistedUser {\n\t\treturn isObject( value )\n\t\t\t&& hasFunction( value, \"enable\" )\n\t\t\t&& hasFunction( value, \"disable\" )\n\t\t\t;\n\t},\n\n\tis( value:any ):value is PersistedUser {\n\t\treturn PersistedUser.isDecorated( value )\n\t\t\t&& User.isDecorated( value )\n\t\t\t&& PersistedProtectedDocument.is( value )\n\t\t\t;\n\t},\n\n\tdecorate<T extends object>( object:T, documents:Documents ):PersistedUser & T {\n\t\tif( PersistedUser.isDecorated( object ) ) return object;\n\n\t\tUser.decorate( object );\n\t\tPersistedProtectedDocument.decorate( object, documents );\n\n\t\treturn Object.defineProperties( object, {\n\t\t\t\"enable\": {\n\t\t\t\tconfigurable: true,\n\t\t\t\twritable: true,\n\t\t\t\tvalue: enable,\n\t\t\t},\n\t\t\t\"disable\": {\n\t\t\t\tconfigurable: true,\n\t\t\t\twritable: true,\n\t\t\t\tvalue: disable,\n\t\t\t},\n\t\t} );\n\t},\n};\n\n\nexport function enable( this:PersistedUser, requestOptions?:RequestOptions ):Promise<PersistedUser> {\n\treturn changeAvailability( this, \"enabled\", requestOptions );\n}\n\nexport function disable( this:PersistedUser, requestOptions?:RequestOptions ):Promise<PersistedUser> {\n\treturn changeAvailability( this, \"disabled\", requestOptions );\n}\n\nfunction changeAvailability( user:PersistedUser, flag:\"enabled\" | \"disabled\", requestOptions?:RequestOptions ):Promise<PersistedUser> {\n\treturn user\n\t\t.resolve()\n\t\t.then( () => {\n\t\t\tuser[ flag ] = true;\n\n\t\t\tconst reverse:\"disabled\" | \"enabled\" = flag === \"enabled\" ? \"disabled\" : \"enabled\";\n\t\t\tdelete user[ reverse ];\n\n\t\t\treturn user.save( requestOptions );\n\t\t} )\n\t\t;\n}\n"]}