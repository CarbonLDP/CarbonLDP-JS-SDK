{"version":3,"sources":["Auth/PersistedUser.ts"],"names":[],"mappings":";;AAGA,4EAA2E;AAC3E,kCAIkB;AAClB,+BAA8B;AAU9B,gBAAoC,cAA8B;IACjE,MAAM,CAAC,kBAAkB,CAAE,IAAI,EAAE,SAAS,EAAE,cAAc,CAAE,CAAC;AAC9D,CAAC;AAFD,wBAEC;AAED,iBAAqC,cAA8B;IAClE,MAAM,CAAC,kBAAkB,CAAE,IAAI,EAAE,UAAU,EAAE,cAAc,CAAE,CAAC;AAC/D,CAAC;AAFD,0BAEC;AAED,4BAA6B,IAAU,EAAE,IAA2B,EAAE,cAA8B;IACnG,MAAM,CAAC,IAAI;SACT,OAAO,EAAE;SACT,IAAI,CAAE;QACN,IAAI,CAAE,IAAI,CAAE,GAAG,IAAI,CAAC;QAEpB,IAAM,OAAO,GAA0B,IAAI,KAAK,SAAS,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS,CAAC;QACnF,OAAO,IAAI,CAAE,OAAO,CAAE,CAAC;QAEvB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAE,cAAc,CAAE,CAAC;IACpC,CAAC,CAAE,CACF;AACH,CAAC;AAGD;IAAA;IAqCA,CAAC;IApCO,0BAAkB,GAAzB,UAA2B,MAAa;QACvC,MAAM,CAAC,gBAAQ,CAAE,MAAM,CAAE;eACrB,mBAAW,CAAE,MAAM,EAAE,QAAQ,CAAE;eAC/B,mBAAW,CAAE,MAAM,EAAE,SAAS,CAAE,CAClC;IACH,CAAC;IAEM,UAAE,GAAT,UAAW,MAAa;QACvB,MAAM,CAAC,OAAO,CAAC,kBAAkB,CAAE,MAAM,CAAE;eACvC,WAAI,CAAC,WAAW,CAAE,MAAM,CAAE;eAC1B,uDAA0B,CAAC,EAAE,CAAE,MAAM,CAAE,CACzC;IACH,CAAC;IAEM,gBAAQ,GAAf,UAAmC,MAAQ,EAAE,SAAmB;QAC/D,EAAE,CAAA,CAAE,OAAO,CAAC,kBAAkB,CAAE,MAAM,CAAG,CAAC;YAAC,MAAM,CAAC,MAAM,CAAC;QAEzD,WAAI,CAAC,QAAQ,CAAE,MAAM,CAAE,CAAC;QACxB,uDAA0B,CAAC,QAAQ,CAAE,MAAM,EAAE,SAAS,CAAE,CAAC;QAEzD,IAAM,aAAa,GAAa,MAAM,CAAC,gBAAgB,CAAE,MAAM,EAAE;YAChE,QAAQ,EAAE;gBACT,YAAY,EAAE,IAAI;gBAClB,QAAQ,EAAE,IAAI;gBACd,KAAK,EAAE,MAAM;aACb;YACD,SAAS,EAAE;gBACV,YAAY,EAAE,IAAI;gBAClB,QAAQ,EAAE,IAAI;gBACd,KAAK,EAAE,OAAO;aACd;SACD,CAAE,CAAC;QAEJ,MAAM,CAAC,aAAa,CAAC;IACtB,CAAC;IAEF,cAAC;AAAD,CArCA,AAqCC,IAAA;AArCY,0BAAO","file":"PersistedUser.js","sourcesContent":["import { Document } from \"../Document\";\nimport { Documents } from \"../Documents\";\nimport { RequestOptions } from \"../HTTP\";\nimport { PersistedProtectedDocument } from \"../PersistedProtectedDocument\";\nimport {\n\thasFunction,\n\tisObject,\n\tMinus,\n} from \"../Utils\";\nimport { User } from \"./User\";\n\n\nexport interface Class extends Minus<User, Document>, PersistedProtectedDocument {\n\tenable( requestOptions?:RequestOptions ):Promise<Class>;\n\n\tdisable( requestOptions?:RequestOptions ):Promise<Class>;\n}\n\n\nexport function enable( this:Class, requestOptions?:RequestOptions ):Promise<Class> {\n\treturn changeAvailability( this, \"enabled\", requestOptions );\n}\n\nexport function disable( this:Class, requestOptions?:RequestOptions ):Promise<Class> {\n\treturn changeAvailability( this, \"disabled\", requestOptions );\n}\n\nfunction changeAvailability( user:Class, flag:\"enabled\" | \"disabled\", requestOptions?:RequestOptions ):Promise<Class> {\n\treturn user\n\t\t.resolve()\n\t\t.then( () => {\n\t\t\tuser[ flag ] = true;\n\n\t\t\tconst reverse:\"disabled\" | \"enabled\" = flag === \"enabled\" ? \"disabled\" : \"enabled\";\n\t\t\tdelete user[ reverse ];\n\n\t\t\treturn user.save( requestOptions );\n\t\t} )\n\t\t;\n}\n\n\nexport class Factory {\n\tstatic hasClassProperties( object:object ):object is Class {\n\t\treturn isObject( object )\n\t\t\t&& hasFunction( object, \"enable\" )\n\t\t\t&& hasFunction( object, \"disable\" )\n\t\t\t;\n\t}\n\n\tstatic is( object:object ):object is Class {\n\t\treturn Factory.hasClassProperties( object )\n\t\t\t&& User.isDecorated( object )\n\t\t\t&& PersistedProtectedDocument.is( object )\n\t\t\t;\n\t}\n\n\tstatic decorate<T extends object>( object:T, documents:Documents ):Class & T {\n\t\tif( Factory.hasClassProperties( object ) ) return object;\n\n\t\tUser.decorate( object );\n\t\tPersistedProtectedDocument.decorate( object, documents );\n\n\t\tconst persistedUser:T & Class = Object.defineProperties( object, {\n\t\t\t\"enable\": {\n\t\t\t\tconfigurable: true,\n\t\t\t\twritable: true,\n\t\t\t\tvalue: enable,\n\t\t\t},\n\t\t\t\"disable\": {\n\t\t\t\tconfigurable: true,\n\t\t\t\twritable: true,\n\t\t\t\tvalue: disable,\n\t\t\t},\n\t\t} );\n\n\t\treturn persistedUser;\n\t}\n\n}\n\nexport default Class;\n"]}