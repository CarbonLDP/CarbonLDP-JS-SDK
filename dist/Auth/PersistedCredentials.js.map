{"version":3,"sources":["Auth/PersistedCredentials.ts"],"names":[],"mappings":";;;;;;;;;AAGA,0FAA8E;AAC9E,gDAAoC;AACpC,6DAAiD;AAYjD;IAAA;IAoCA,CAAC;IAnCO,0BAAkB,GAAzB,UAA2B,MAAa;QACvC,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAE,MAAM,CAAE;eAC3B,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,QAAQ,CAAE;eACrC,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,SAAS,CAAE,CACxC;IACH,CAAC;IAEM,gBAAQ,GAAf,UAAmC,iBAAmB,EAAE,SAAmB;QAC1E,IAAM,oBAAoB,GAAyB,iBAAiB,CAAC;QACrE,EAAE,CAAA,CAAE,OAAO,CAAC,kBAAkB,CAAE,iBAAiB,CAAG,CAAC;YAAC,MAAM,CAAC,oBAAoB,CAAC;QAElF,0BAA0B,CAAC,OAAO,CAAC,QAAQ,CAAE,oBAAoB,EAAE,SAAS,CAAE,CAAC;QAE/E,MAAM,CAAC,gBAAgB,CAAE,oBAAoB,EAAE;YAC9C,QAAQ,EAAE;gBACT,QAAQ,EAAE,KAAK;gBACf,UAAU,EAAE,KAAK;gBACjB,YAAY,EAAE,IAAI;gBAClB,KAAK,EAAE,aAAa,CAAC,IAAI,CAAE,oBAAoB,EAAE,IAAI,CAAE;aACvD;YACD,SAAS,EAAE;gBACV,QAAQ,EAAE,KAAK;gBACf,UAAU,EAAE,KAAK;gBACjB,YAAY,EAAE,IAAI;gBAClB,KAAK,EAAE,aAAa,CAAC,IAAI,CAAE,oBAAoB,EAAE,KAAK,CAAE;aACxD;SACD,CAAE,CAAC;QAEJ,EAAE,CAAA,CAAE,oBAAoB,CAAC,IAAK,CAAC,CAAC,CAAC;YAChC,aAAa,CAAC,OAAO,CAAC,QAAQ,CAAE,oBAAoB,CAAC,IAAI,EAAE,SAAS,CAAE,CAAC;YACvE,oBAAoB,CAAC,IAAI,CAAC,WAAW,GAAG,oBAAoB,CAAC;QAC9D,CAAC;QAED,MAAM,CAAC,oBAAoB,CAAC;IAC7B,CAAC;IACF,cAAC;AAAD,CApCA,AAoCC,IAAA;AApCY,0BAAO;AAsCpB,uBAAoC,OAAe,EAAE,cAAoC;IAAzF,iBAaC;IAZA,IAAM,SAAS,GAAc,EAAE,CAAC;IAChC,IAAM,OAAO,GAAgC,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAO,EAAE,CAAE,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;IAC7G,MAAM,CAAC,OAAO,CAAC,IAAI,CAAE,UAAE,EAA0B;YAAxB,oBAAY,EAAE,gBAAQ;QAC9C,EAAE,CAAA,CAAE,QAAS,CAAC;YAAC,SAAS,CAAC,IAAI,CAAE,QAAQ,CAAE,CAAC;QAE1C,KAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,MAAM,CAAC,KAAI,CAAC,IAAI,CAAE,cAAc,CAAE,CAAC;IACpC,CAAC,CAAE,CAAC,IAAI,CAAyB,UAAE,EAA0B;YAAxB,oBAAY,EAAE,gBAAQ;QAC1D,EAAE,CAAA,CAAE,QAAS,CAAC;YAAC,SAAS,CAAC,IAAI,CAAE,QAAQ,CAAE,CAAC;QAE1C,MAAM,CAAC,CAAE,KAAI,EAAE,SAAS,CAAE,CAAC;IAC5B,CAAC,CAAE,CAAC;AACL,CAAC","file":"PersistedCredentials.js","sourcesContent":["import * as HTTP from \"../HTTP\";\nimport { Response } from \"../HTTP/Response\";\nimport { Documents } from \"./../Documents\";\nimport * as PersistedProtectedDocument from \"./../PersistedProtectedDocument\";\nimport * as Utils from \"./../Utils\";\nimport * as PersistedUser from \"./PersistedUser\";\n\nexport interface Class extends PersistedProtectedDocument.Class {\n\temail?:string;\n\tpassword?:string;\n\tenabled?:boolean;\n\tuser?:PersistedUser.Class;\n\n\tenable( requestOptions?:HTTP.Request.Options ):Promise<[ Class, Response[] ]>;\n\tdisable( requestOptions?:HTTP.Request.Options ):Promise<[ Class, Response[] ]>;\n}\n\nexport class Factory {\n\tstatic hasClassProperties( object:object ):boolean {\n\t\treturn Utils.isObject( object )\n\t\t\t&& Utils.hasFunction( object, \"enable\" )\n\t\t\t&& Utils.hasFunction( object, \"disable\" )\n\t\t\t;\n\t}\n\n\tstatic decorate<T extends object>( persistedDocument:T, documents:Documents ):T & Class {\n\t\tconst persistedCredentials:T & Class = <T & Class> persistedDocument;\n\t\tif( Factory.hasClassProperties( persistedDocument ) ) return persistedCredentials;\n\n\t\tPersistedProtectedDocument.Factory.decorate( persistedCredentials, documents );\n\n\t\tObject.defineProperties( persistedCredentials, {\n\t\t\t\"enable\": {\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: changeEnabled.bind( persistedCredentials, true ),\n\t\t\t},\n\t\t\t\"disable\": {\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: changeEnabled.bind( persistedCredentials, false ),\n\t\t\t},\n\t\t} );\n\n\t\tif( persistedCredentials.user ) {\n\t\t\tPersistedUser.Factory.decorate( persistedCredentials.user, documents );\n\t\t\tpersistedCredentials.user.credentials = persistedCredentials;\n\t\t}\n\n\t\treturn persistedCredentials;\n\t}\n}\n\nfunction changeEnabled( this:Class, enabled:boolean, requestOptions?:HTTP.Request.Options ):Promise<[ Class, Response[] ]> {\n\tconst responses:Response[] = [];\n\tconst promise:Promise<[ Class, Response ]> = this.isResolved() ? Promise.resolve<any>( [] ) : this.resolve();\n\treturn promise.then( ( [ _credentials, response ] ) => {\n\t\tif( response ) responses.push( response );\n\n\t\tthis.enabled = enabled;\n\t\treturn this.save( requestOptions );\n\t} ).then<[ Class, Response[] ]>( ( [ _credentials, response ] ) => {\n\t\tif( response ) responses.push( response );\n\n\t\treturn [ this, responses ];\n\t} );\n}\n\nexport default Class;\n"]}