{"version":3,"sources":["Auth/ACL.ts"],"names":[],"mappings":";AACA,qCAAiC,gCAAgC,CAAC,CAAA;AAClE,IAAY,EAAE,WAAM,SAAS,CAAC,CAAA;AAE9B,IAAY,iBAAiB,WAAM,wBAAwB,CAAC,CAAA;AAC5D,IAAY,OAAO,WAAM,cAAc,CAAC,CAAA;AACxC,IAAY,KAAK,WAAM,YAAY,CAAC,CAAA;AAEvB,iBAAS,GAAU,EAAE,CAAC,EAAE,CAAC,KAAK,CAAC,iBAAiB,CAAC;AAEjD,cAAM,GAAsB;IACxC,sBAAsB,EAAE;QACvB,KAAK,EAAE,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,kBAAkB;QACzC,OAAO,EAAE,KAAK;QACd,YAAY,EAAE,MAAM;KACpB;IACD,UAAU,EAAE;QACX,KAAK,EAAE,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,QAAQ;QAC/B,OAAO,EAAE,KAAK;KACd;IACD,oBAAoB,EAAE;QACrB,KAAK,EAAE,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,gBAAgB;QACvC,OAAO,EAAE,KAAK;QACd,YAAY,EAAE,MAAM;KACpB;CACD,CAAC;AAkCF;IAAA;IA2EA,CAAC;IAzEO,0BAAkB,GAAzB,UAA2B,MAAa;QACvC,MAAM,CAAC,KAAK,CAAC,kBAAkB,CAAE,MAAM,EAAE,UAAU,CAAE;eACjD,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,OAAO,CAAE;eACpC,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,MAAM,CAAE;eACnC,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,2BAA2B,CAAE;eACxD,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,QAAQ,CAAE;eACrC,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,QAAQ,CAAE;eACrC,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,qBAAqB,CAAE;eAClD,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,QAAQ,CAAE;eACrC,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,wBAAwB,CAAE,CAAC;IAC3D,CAAC;IAEM,gBAAQ,GAAf,UAAoD,QAAU;QAC7D,EAAE,CAAC,CAAE,CAAE,iBAAiB,CAAC,OAAO,CAAC,EAAE,CAAE,QAAQ,CAAG,CAAC;YAAC,MAAM,IAAI,8BAAoB,CAAE,kDAAkD,CAAE,CAAC;QAEvI,IAAI,GAAG,GAAmB,QAAQ,CAAC;QAEnC,EAAE,CAAC,CAAE,OAAO,CAAC,kBAAkB,CAAE,GAAG,CAAG,CAAC;YAAC,MAAM,CAAC,GAAG,CAAC;QAEpD,MAAM,CAAC,gBAAgB,CAAE,GAAG,EAAE;YAC7B,OAAO,EAAE;gBACR,QAAQ,EAAE,IAAI;gBACd,UAAU,EAAE,KAAK;gBACjB,YAAY,EAAE,IAAI;gBAClB,KAAK,EAAE,KAAK;aACZ;YACD,MAAM,EAAE;gBACP,QAAQ,EAAE,IAAI;gBACd,UAAU,EAAE,KAAK;gBACjB,YAAY,EAAE,IAAI;gBAClB,KAAK,EAAE,IAAI;aACX;YACD,2BAA2B,EAAE;gBAC5B,QAAQ,EAAE,IAAI;gBACd,UAAU,EAAE,KAAK;gBACjB,YAAY,EAAE,IAAI;gBAClB,KAAK,EAAE,yBAAyB;aAChC;YACD,QAAQ,EAAE;gBACT,QAAQ,EAAE,IAAI;gBACd,UAAU,EAAE,KAAK;gBACjB,YAAY,EAAE,IAAI;gBAClB,KAAK,EAAE,MAAM;aACb;YACD,QAAQ,EAAE;gBACT,QAAQ,EAAE,IAAI;gBACd,UAAU,EAAE,KAAK;gBACjB,YAAY,EAAE,IAAI;gBAClB,KAAK,EAAE,MAAM;aACb;YACD,qBAAqB,EAAE;gBACtB,QAAQ,EAAE,IAAI;gBACd,UAAU,EAAE,KAAK;gBACjB,YAAY,EAAE,IAAI;gBAClB,KAAK,EAAE,mBAAmB;aAC1B;YACD,QAAQ,EAAE;gBACT,QAAQ,EAAE,IAAI;gBACd,UAAU,EAAE,KAAK;gBACjB,YAAY,EAAE,IAAI;gBAClB,KAAK,EAAE,MAAM;aACb;YACD,wBAAwB,EAAE;gBACzB,QAAQ,EAAE,IAAI;gBACd,UAAU,EAAE,KAAK;gBACjB,YAAY,EAAE,IAAI;gBAClB,KAAK,EAAE,sBAAsB;aAC7B;SACD,CAAE,CAAC;QAEJ,MAAM,CAAC,GAAG,CAAC;IACZ,CAAC;IAEF,cAAC;AAAD,CA3EA,AA2EC,IAAA;AA3EY,eAAO,UA2EnB,CAAA;AAED,sBAAuB,OAA8B;IACpD,IAAI,IAAI,GAAS,IAAI,CAAC;IACtB,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAE,OAAO,CAAE,GAAmB,OAAO,GAAG,IAAI,CAAC,UAAU,CAAW,OAAO,CAAE,CAAC;AACtG,CAAC;AAED,uBAAwB,QAA4D;IAApF,iBAGC;IAFA,IAAI,aAAa,GAA8B,KAAK,CAAC,OAAO,CAAE,QAAQ,CAAE,GAAgC,QAAQ,GAAG,CAA2B,QAAQ,CAAE,CAAC;IACzJ,MAAM,CAAC,aAAa,CAAC,GAAG,CAAE,UAAE,OAA8B,IAAM,OAAA,YAAY,CAAC,IAAI,CAAE,KAAI,EAAE,OAAO,CAAE,EAAlC,CAAkC,CAAC,CAAC;AACrG,CAAC;AAED,mBAAoB,QAAgB,EAAE,OAAqB,EAAE,YAA0B,EAAE,WAA2B,EAAE,IAAgB;IACrI,IAAI,WAAW,GAAe,IAAI,CAAC,MAAM,CAAE,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,IAAI,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAE,OAAO,CAAE,KAAK,CAAC,CAAC,IAAI,GAAG,CAAC,QAAQ,KAAK,QAAQ,EAAhG,CAAgG,CAAE,CAAC;IAErJ,IAAI,GAAa,CAAC;IAClB,EAAE,CAAC,CAAE,WAAW,CAAC,MAAM,KAAK,CAAE,CAAC,CAAC,CAAC;QAChC,GAAG,GAAwB,IAAK,CAAC,cAAc,EAAE,CAAC;QAClD,GAAG,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACxB,GAAG,CAAC,QAAQ,GAAG,CAAE,OAAO,CAAE,CAAC;QAC3B,GAAG,CAAC,aAAa,GAAG,YAAY,CAAC;QACjC,GAAG,CAAC,WAAW,GAAG,EAAE,CAAC;QACrB,IAAI,CAAC,IAAI,CAAE,GAAG,CAAE,CAAC;IAClB,CAAC;IAAC,IAAI,CAAC,CAAC;QACP,GAAG,GAAG,WAAW,CAAE,CAAC,CAAE,CAAC;IACxB,CAAC;IAED,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAE,GAAG,CAAC,WAAW,EAAE,WAAW,CAAE,CAAC;IAC3D,MAAM,CAAC,GAAG,CAAC;AACZ,CAAC;AACD,oBAAqB,QAAgB,EAAE,QAA4D,EAAE,aAAoC,EAAE,WAA+D,EAAE,IAAgB;IAC3N,IAAI,eAAe,GAAmB,aAAa,CAAC,IAAI,CAAE,IAAI,EAAE,QAAQ,CAAE,CAAC;IAC3E,IAAI,mBAAmB,GAAiB,YAAY,CAAC,IAAI,CAAE,IAAI,EAAE,aAAa,CAAE,CAAC;IACjF,IAAI,kBAAkB,GAAmB,aAAa,CAAC,IAAI,CAAE,IAAI,EAAE,WAAW,CAAE,CAAC;IAEjF,GAAG,CAAA,CAAiB,UAAe,EAAf,mCAAe,EAAf,6BAAe,EAAf,IAAgB,CAAC;QAAhC,IAAI,OAAO,wBAAA;QACf,qBAAqB,CAAC,IAAI,CAAE,IAAI,EAAE,OAAO,EAAE,kBAAkB,EAAE,IAAI,CAAE,CAAC;QACtE,SAAS,CAAC,IAAI,CAAE,IAAI,EAAE,QAAQ,EAAE,OAAO,EAAE,mBAAmB,EAAE,kBAAkB,EAAE,IAAI,CAAE,CAAC;KACzF;AACF,CAAC;AAKD,eAAgB,QAA4D,EAAE,aAAoC,EAAE,WAA+D;IAClL,IAAI,IAAI,GAAS,IAAI,CAAC;IACtB,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,oBAAoB,IAAI,EAAE,CAAC;IAC5D,UAAU,CAAC,IAAI,CAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,aAAa,EAAE,WAAW,EAAE,IAAI,CAAC,oBAAoB,CAAE,CAAC;AAChG,CAAC;AAKD,cAAe,QAA4D,EAAE,aAAoC,EAAE,WAA+D;IACjL,IAAI,IAAI,GAAS,IAAI,CAAC;IACtB,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,oBAAoB,IAAI,EAAE,CAAC;IAC5D,UAAU,CAAC,IAAI,CAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAE,aAAa,EAAE,WAAW,EAAE,IAAI,CAAC,oBAAoB,CAAE,CAAC;AACjG,CAAC;AAKD,mCAAoC,QAAgB,EAAE,QAA4D,EAAE,aAAoC,EAAE,WAAgE;IACzN,IAAI,IAAI,GAAS,IAAI,CAAC;IACtB,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,kBAAkB,IAAI,EAAE,CAAC;IACxD,UAAU,CAAC,IAAI,CAAE,IAAI,EAAE,QAAQ,EAAE,QAAQ,EAAE,aAAa,EAAE,WAAW,EAAE,IAAI,CAAC,kBAAkB,CAAE,CAAC;AAClG,CAAC;AAED,sBAAuB,OAAqB,EAAE,UAAwB,EAAE,IAAgB;IACvF,IAAI,WAAW,GAAe,IAAI,CAAC,MAAM,CAAE,UAAA,GAAG,IAAK,OAAA,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAE,OAAO,CAAE,KAAK,CAAC,CAAC,EAAtC,CAAsC,CAAE,CAAC;IAE5F,GAAG,CAAC,CAAa,UAAW,EAAX,2BAAW,EAAX,yBAAW,EAAX,IAAY,CAAC;QAAxB,IAAI,GAAG,oBAAA;QACZ,EAAE,CAAC,CAAE,GAAG,CAAC,WAAW,CAAC,OAAO,CAAE,UAAU,CAAE,KAAK,CAAC,CAAE,CAAC;YAClD,MAAM,CAAC,GAAG,CAAC,QAAQ,CAAC;KACrB;IACD,MAAM,CAAC,IAAI,CAAC;AACb,CAAC;AACD,qBAAsB,OAA8B,EAAE,UAAkC,EAAE,IAAgB;IACzG,EAAE,CAAC,CAAE,CAAE,IAAK,CAAC;QAAC,MAAM,CAAC,IAAI,CAAC;IAE1B,IAAI,cAAc,GAAiB,YAAY,CAAC,IAAI,CAAE,IAAI,EAAE,OAAO,CAAE,CAAC;IACtE,IAAI,iBAAiB,GAAiB,YAAY,CAAC,IAAI,CAAE,IAAI,EAAE,UAAU,CAAE,CAAC;IAE5E,MAAM,CAAC,YAAY,CAAE,cAAc,EAAE,iBAAiB,EAAE,IAAI,CAAE,CAAC;AAChE,CAAC;AACD,gBAAiB,OAA8B,EAAE,UAAkC;IAClF,IAAI,IAAI,GAAS,IAAI,CAAC;IACtB,MAAM,CAAC,WAAW,CAAC,IAAI,CAAE,IAAI,EAAE,OAAO,EAAE,UAAU,EAAE,IAAI,CAAC,oBAAoB,CAAE,CAAC;AACjF,CAAC;AACD,gBAAiB,OAA8B,EAAE,UAAkC;IAClF,IAAI,IAAI,GAAS,IAAI,CAAC;IACtB,IAAI,QAAQ,GAAW,WAAW,CAAC,IAAI,CAAE,IAAI,EAAE,OAAO,EAAE,UAAU,EAAE,IAAI,CAAC,oBAAoB,CAAE,CAAC;IAChG,MAAM,CAAC,QAAQ,KAAK,IAAI,GAAG,IAAI,GAAG,CAAE,QAAQ,CAAC;AAC9C,CAAC;AACD,6BAA8B,OAA8B,EAAE,UAAkC;IAC/F,IAAI,IAAI,GAAS,IAAI,CAAC;IACtB,MAAM,CAAC,WAAW,CAAC,IAAI,CAAE,IAAI,EAAE,OAAO,EAAE,UAAU,EAAE,IAAI,CAAC,kBAAkB,CAAE,CAAC;AAC/E,CAAC;AAED,+BAAgC,OAAqB,EAAE,WAA2B,EAAE,IAAgB;IACnG,EAAE,CAAC,CAAE,CAAE,IAAK,CAAC;QAAC,MAAM,CAAC;IAErB,IAAI,IAAI,GAAiB,IAAI,CAAC;IAC9B,IAAI,WAAW,GAAe,IAAI,CAAC,oBAAoB,KAAK,IAAI,GAAG,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,oBAAoB,CAAC;IAEvH,IAAI,WAAW,GAAe,IAAI,CAAC,MAAM,CAAE,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAE,OAAO,CAAE,KAAK,CAAC,CAAC,EAAtC,CAAsC,CAAE,CAAC;IAC3F,GAAG,CAAC,CAAa,UAAW,EAAX,2BAAW,EAAX,yBAAW,EAAX,IAAY,CAAC;QAAxB,IAAI,GAAG,oBAAA;QACZ,EAAE,CAAC,CAAE,WAAW,IAAI,WAAW,CAAC,OAAO,CAAE,GAAG,CAAE,KAAK,CAAC,CAAE,CAAC,CAAC,CAAC;YACxD,IAAI,CAAC,MAAM,CAAE,IAAI,CAAC,OAAO,CAAE,GAAG,CAAE,EAAE,CAAC,CAAE,CAAC;YAEtC,IAAI,MAAM,GAAa,SAAS,CAAC,IAAI,CAAE,IAAI,EAAE,GAAG,CAAC,QAAQ,EAAE,OAAO,EAAE,GAAG,CAAC,aAAa,EAAE,GAAG,CAAC,WAAW,EAAE,IAAI,CAAE,CAAC;YAC/G,WAAW,CAAC,IAAI,CAAE,MAAM,CAAE,CAAC;YAC3B,QAAQ,CAAC;QACV,CAAC;QAED,EAAE,CAAC,CAAE,GAAG,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAE,CAAC,CAAC,CAAC;YAC/B,GAAG,CAAC,QAAQ,CAAC,MAAM,CAAE,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAE,OAAO,CAAE,EAAE,CAAC,CAAE,CAAC;YAE1D,IAAI,MAAM,GAAa,SAAS,CAAC,IAAI,CAAE,IAAI,EAAE,GAAG,CAAC,QAAQ,EAAE,OAAO,EAAE,GAAG,CAAC,aAAa,EAAE,GAAG,CAAC,WAAW,EAAE,IAAI,CAAE,CAAC;YAC/G,WAAW,CAAC,IAAI,CAAE,MAAM,CAAE,CAAC;YAC3B,QAAQ,CAAC;QACV,CAAC;QAED,GAAG,CAAC,CAAoB,UAAW,EAAX,2BAAW,EAAX,yBAAW,EAAX,IAAY,CAAC;YAA/B,IAAI,UAAU,oBAAA;YACnB,IAAI,KAAK,GAAU,GAAG,CAAC,WAAW,CAAC,OAAO,CAAE,UAAU,CAAE,CAAC;YAEzD,EAAE,CAAC,CAAE,KAAK,KAAK,CAAC,CAAE,CAAC;gBAAC,QAAQ,CAAC;YAC7B,GAAG,CAAC,WAAW,CAAC,MAAM,CAAE,KAAK,EAAE,CAAC,CAAE,CAAC;SACnC;QAED,EAAE,CAAC,CAAE,GAAG,CAAC,WAAW,CAAC,MAAM,KAAK,CAAE,CAAC,CAAC,CAAC;YACpC,IAAI,CAAC,MAAM,CAAE,IAAI,CAAC,OAAO,CAAE,GAAG,CAAE,EAAE,CAAC,CAAE,CAAC;YACtC,IAAI,CAAC,cAAc,CAAE,GAAG,CAAE,CAAC;QAC5B,CAAC;KACD;AACF,CAAC;AACD,2BAA4B,OAA8B,EAAE,WAAgE,EAAE,IAAgB;IAC7I,IAAI,cAAc,GAAiB,YAAY,CAAC,IAAI,CAAE,IAAI,EAAE,OAAO,CAAE,CAAC;IACtE,IAAI,kBAAkB,GAAmB,aAAa,CAAC,IAAI,CAAE,IAAI,EAAE,WAAW,CAAE,CAAC;IACjF,qBAAqB,CAAC,IAAI,CAAE,IAAI,EAAE,cAAc,EAAE,kBAAkB,EAAE,IAAI,CAAE,CAAC;AAC9E,CAAC;AAGD,gBAAiB,OAA8B,EAAE,WAA+D;IAC/G,IAAI,IAAI,GAAS,IAAI,CAAC;IACtB,iBAAiB,CAAC,IAAI,CAAE,IAAI,EAAE,OAAO,EAAE,WAAW,EAAE,IAAI,CAAC,oBAAoB,CAAE,CAAC;AACjF,CAAC;AAGD,gCAAiC,OAA8B,EAAE,WAAgE;IAChI,IAAI,IAAI,GAAS,IAAI,CAAC;IACtB,iBAAiB,CAAC,IAAI,CAAE,IAAI,EAAE,OAAO,EAAE,WAAW,EAAE,IAAI,CAAC,kBAAkB,CAAE,CAAC;AAC/E,CAAC","file":"Auth/ACL.js","sourcesContent":["import * as ACE from \"./ACE\";\nimport IllegalArgumentError from \"../Errors/IllegalArgumentError\";\nimport * as NS from \"./../NS\";\nimport * as ObjectSchema from \"./../ObjectSchema\";\nimport * as PersistedDocument from \"./../PersistedDocument\";\nimport * as Pointer from \"./../Pointer\";\nimport * as Utils from \"./../Utils\";\n\nexport const RDF_CLASS:string = NS.CS.Class.AccessControlList;\n\nexport const SCHEMA:ObjectSchema.Class = {\n\t\"accessControlEntries\": {\n\t\t\"@id\": NS.CS.Predicate.accessControlEntry,\n\t\t\"@type\": \"@id\",\n\t\t\"@container\": \"@set\",\n\t},\n\t\"accessTo\": {\n\t\t\"@id\": NS.CS.Predicate.accessTo,\n\t\t\"@type\": \"@id\",\n\t},\n\t\"inheritableEntries\": {\n\t\t\"@id\": NS.CS.Predicate.inheritableEntry,\n\t\t\"@type\": \"@id\",\n\t\t\"@container\": \"@set\",\n\t},\n};\n\nexport interface Class extends PersistedDocument.Class {\n\taccessTo: Pointer.Class;\n\taccessControlEntries?: ACE.Class[];\n\tinheritableEntries?: ACE.Class[];\n\n\t_subjectACEs:Map<string, ACE.Class[]>;\n\n\tgrant( subject:string | Pointer.Class, subjectClass:string | Pointer.Class, permission:string | Pointer.Class ): void;\n\tgrant( subject:string | Pointer.Class, subjectClass:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\n\tgrant( subjects:(string | Pointer.Class)[], subjectClass:string | Pointer.Class, permission:string | Pointer.Class ): void;\n\tgrant( subjects:(string | Pointer.Class)[], subjectClass:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\n\n\tdeny( subject:string | Pointer.Class, subjectClass:string | Pointer.Class, permission:string | Pointer.Class ): void;\n\tdeny( subject:string | Pointer.Class, subjectClass:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\n\tdeny( subjects:(string | Pointer.Class)[], subjectClass:string | Pointer.Class, permission:string | Pointer.Class ): void;\n\tdeny( subjects:(string | Pointer.Class)[], subjectClass:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\n\n\tconfigureChildInheritance( granting:boolean, subject:string | Pointer.Class, subjectClass:string | Pointer.Class, permission:string | Pointer.Class ): void;\n\tconfigureChildInheritance( granting:boolean, subject:string | Pointer.Class, subjectClass:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\n\tconfigureChildInheritance( granting:boolean, subjects:(string | Pointer.Class)[], subjectClass:string | Pointer.Class, permission:string | Pointer.Class ): void;\n\tconfigureChildInheritance( granting:boolean, subjects:(string | Pointer.Class)[], subjectClass:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\n\n\tgrants( subject:string | Pointer.Class, permission: string | Pointer.Class ): boolean;\n\tdenies( subject:string | Pointer.Class, permission: string | Pointer.Class ): boolean;\n\tgetChildInheritance( subject:string | Pointer.Class, permissions: string | Pointer.Class ):boolean;\n\n\tremove( subject:string | Pointer.Class, permission:string | Pointer.Class ): void;\n\tremove( subject:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\n\tremoveChildInheritance( subject:string | Pointer.Class, permission:string | Pointer.Class ): void;\n\tremoveChildInheritance( subject:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\n}\n\nexport class Factory {\n\n\tstatic hasClassProperties( object:Object ):boolean {\n\t\treturn Utils.hasPropertyDefined( object, \"accessTo\" )\n\t\t\t&& Utils.hasFunction( object, \"grant\" )\n\t\t\t&& Utils.hasFunction( object, \"deny\" )\n\t\t\t&& Utils.hasFunction( object, \"configureChildInheritance\" )\n\t\t\t&& Utils.hasFunction( object, \"grants\" )\n\t\t\t&& Utils.hasFunction( object, \"denies\" )\n\t\t\t&& Utils.hasFunction( object, \"getChildInheritance\" )\n\t\t\t&& Utils.hasFunction( object, \"remove\" )\n\t\t\t&& Utils.hasFunction( object, \"removeChildInheritance\" );\n\t}\n\n\tstatic decorate<T extends PersistedDocument.Class>( document:T ):T & Class {\n\t\tif ( ! PersistedDocument.Factory.is( document ) ) throw new IllegalArgumentError( \"The object provided must be a PersistedDocument.\" );\n\n\t\tlet acl:T & Class = <any> document;\n\n\t\tif ( Factory.hasClassProperties( acl ) ) return acl;\n\n\t\tObject.defineProperties( acl, {\n\t\t\t\"grant\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: grant,\n\t\t\t},\n\t\t\t\"deny\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: deny,\n\t\t\t},\n\t\t\t\"configureChildInheritance\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: configureChildInheritance,\n\t\t\t},\n\t\t\t\"grants\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: grants,\n\t\t\t},\n\t\t\t\"denies\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: denies,\n\t\t\t},\n\t\t\t\"getChildInheritance\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: getChildInheritance,\n\t\t\t},\n\t\t\t\"remove\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: remove,\n\t\t\t},\n\t\t\t\"removeChildInheritance\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: removeChildInheritance,\n\t\t\t},\n\t\t} );\n\n\t\treturn acl;\n\t}\n\n}\n\nfunction parsePointer( element:string | Pointer.Class ): Pointer.Class {\n\tlet that:Class = this;\n\treturn Pointer.Factory.is( element ) ? <Pointer.Class> element : that.getPointer( <string> element );\n}\n\nfunction parsePointers( elements:string | Pointer.Class | (string | Pointer.Class)[] ):Pointer.Class[] {\n\tlet elementsArray:(string | Pointer.Class)[] = Utils.isArray( elements ) ? <(string | Pointer.Class)[]> elements : [ <string | Pointer.Class> elements ];\n\treturn elementsArray.map( ( element:string | Pointer.Class ) => parsePointer.call( this, element ));\n}\n\nfunction configACE( granting:boolean, subject:Pointer.Class, subjectClass:Pointer.Class, permissions:Pointer.Class[], aces:ACE.Class[] ):ACE.Class {\n\tlet subjectACEs:ACE.Class[] = aces.filter( ace => ace.subjects.length === 1 && ace.subjects.indexOf( subject ) !== -1 && ace.granting === granting );\n\t\n\tlet ace:ACE.Class;\n\tif ( subjectACEs.length === 0 ) {\n\t\tace = <ACE.Class> (<Class> this).createFragment();\n\t\tace.granting = granting;\n\t\tace.subjects = [ subject ];\n\t\tace.subjectsClass = subjectClass;\n\t\tace.permissions = [];\n\t\taces.push( ace );\n\t} else {\n\t\tace = subjectACEs[ 0 ];\n\t}\n\n\tArray.prototype.push.apply( ace.permissions, permissions );\n\treturn ace;\n}\nfunction configACEs( granting:boolean, subjects:string | Pointer.Class | (string | Pointer.Class)[], subjectsClass:string | Pointer.Class, permissions:string | Pointer.Class | (string | Pointer.Class)[], aces:ACE.Class[] ):void {\n\tlet subjectPointers:Pointer.Class[] = parsePointers.call( this, subjects );\n\tlet subjectClassPointer:Pointer.Class = parsePointer.call( this, subjectsClass );\n\tlet permissionPointers:Pointer.Class[] = parsePointers.call( this, permissions );\n\n\tfor( let subject of subjectPointers ) {\n\t\tremovePermissionsFrom.call( this, subject, permissionPointers, aces );\n\t\tconfigACE.call( this, granting, subject, subjectClassPointer, permissionPointers, aces );\n\t}\n}\nfunction grant( subject:string | Pointer.Class, subjectClass:string | Pointer.Class, permission:string | Pointer.Class ): void;\nfunction grant( subject:string | Pointer.Class, subjectClass:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\nfunction grant( subjects:(string | Pointer.Class)[], subjectClass:string | Pointer.Class, permission:string | Pointer.Class ): void;\nfunction grant( subjects:(string | Pointer.Class)[], subjectClass:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\nfunction grant( subjects:string | Pointer.Class | (string | Pointer.Class)[], subjectsClass:string | Pointer.Class, permissions:string | Pointer.Class | (string | Pointer.Class)[] ): void {\n\tlet that:Class = this;\n\tthat.accessControlEntries = that.accessControlEntries || [];\n\tconfigACEs.call( this, true, subjects, subjectsClass, permissions, that.accessControlEntries );\n}\nfunction deny( subject:string | Pointer.Class, subjectClass:string | Pointer.Class, permission:string | Pointer.Class ): void;\nfunction deny( subject:string | Pointer.Class, subjectClass:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\nfunction deny( subjects:(string | Pointer.Class)[], subjectClass:string | Pointer.Class, permission:string | Pointer.Class ): void;\nfunction deny( subjects:(string | Pointer.Class)[], subjectClass:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\nfunction deny( subjects:string | Pointer.Class | (string | Pointer.Class)[], subjectsClass:string | Pointer.Class, permissions:string | Pointer.Class | (string | Pointer.Class)[] ): void {\n\tlet that:Class = this;\n\tthat.accessControlEntries = that.accessControlEntries || [];\n\tconfigACEs.call( this, false, subjects, subjectsClass, permissions, that.accessControlEntries );\n}\nfunction configureChildInheritance( granting:boolean, subject:string | Pointer.Class, subjectClass:string | Pointer.Class, permission:string | Pointer.Class ): void;\nfunction configureChildInheritance( granting:boolean, subject:string | Pointer.Class, subjectClass:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\nfunction configureChildInheritance( granting:boolean, subjects:(string | Pointer.Class)[], subjectClass:string | Pointer.Class, permission:string | Pointer.Class ): void;\nfunction configureChildInheritance( granting:boolean, subjects:(string | Pointer.Class)[], subjectClass:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\nfunction configureChildInheritance( granting:boolean, subjects:string | Pointer.Class | (string | Pointer.Class)[], subjectsClass:string | Pointer.Class, permissions: string | Pointer.Class | (string | Pointer.Class)[] ): void {\n\tlet that:Class = this;\n\tthat.inheritableEntries = that.inheritableEntries || [];\n\tconfigACEs.call( this, granting, subjects, subjectsClass, permissions, that.inheritableEntries );\n}\n\nfunction grantingFrom( subject:Pointer.Class, permission:Pointer.Class, aces:ACE.Class[] ):boolean {\n\tlet subjectACEs:ACE.Class[] = aces.filter( ace  => ace.subjects.indexOf( subject ) !== -1 );\n\n\tfor ( let ace of subjectACEs ) {\n\t\tif ( ace.permissions.indexOf( permission ) !== -1 )\n\t\t\treturn ace.granting;\n\t}\n\treturn null;\n}\nfunction getGranting( subject:string | Pointer.Class, permission: string | Pointer.Class, aces:ACE.Class[] ):boolean {\n\tif ( ! aces ) return null;\n\n\tlet subjectPointer:Pointer.Class = parsePointer.call( this, subject );\n\tlet permissionPointer:Pointer.Class = parsePointer.call( this, permission );\n\n\treturn grantingFrom( subjectPointer, permissionPointer, aces );\n}\nfunction grants( subject:string | Pointer.Class, permission: string | Pointer.Class ): boolean {\n\tlet that:Class = this;\n\treturn getGranting.call( this, subject, permission, that.accessControlEntries );\n}\nfunction denies( subject:string | Pointer.Class, permission: string | Pointer.Class ): boolean {\n\tlet that:Class = this;\n\tlet granting:boolean = getGranting.call( this, subject, permission, that.accessControlEntries );\n\treturn granting === null ? null : ! granting;\n}\nfunction getChildInheritance( subject:string | Pointer.Class, permission: string | Pointer.Class ):boolean {\n\tlet that:Class = this;\n\treturn getGranting.call( this, subject, permission, that.inheritableEntries );\n}\n\nfunction removePermissionsFrom( subject:Pointer.Class, permissions:Pointer.Class[], aces:ACE.Class[] ):void {\n\tif ( ! aces ) return;\n\n\tlet that:Class = <Class> this;\n\tlet opposedAces:ACE.Class[] = that.accessControlEntries === aces ? that.inheritableEntries : that.accessControlEntries;\n\n\tlet subjectACEs:ACE.Class[] = aces.filter( ace => ace.subjects.indexOf( subject ) !== -1 );\n\tfor ( let ace of subjectACEs ) {\n\t\tif ( opposedAces && opposedAces.indexOf( ace ) !== -1 ) {\n\t\t\taces.splice( aces.indexOf( ace ), 1 );\n\n\t\t\tlet newACE:ACE.Class = configACE.call( this, ace.granting, subject, ace.subjectsClass, ace.permissions, aces );\n\t\t\tsubjectACEs.push( newACE );\n\t\t\tcontinue;\n\t\t}\n\n\t\tif ( ace.subjects.length > 1 ) {\n\t\t\tace.subjects.splice( ace.subjects.indexOf( subject ), 1 );\n\n\t\t\tlet newACE:ACE.Class = configACE.call( this, ace.granting, subject, ace.subjectsClass, ace.permissions, aces );\n\t\t\tsubjectACEs.push( newACE );\n\t\t\tcontinue;\n\t\t}\n\n\t\tfor ( let permission of permissions ) {\n\t\t\tlet index:number = ace.permissions.indexOf( permission );\n\n\t\t\tif ( index === -1 ) continue;\n\t\t\tace.permissions.splice( index, 1 );\n\t\t}\n\n\t\tif ( ace.permissions.length === 0 ) {\n\t\t\taces.splice( aces.indexOf( ace ), 1 );\n\t\t\tthat.removeFragment( ace );\n\t\t}\n\t}\n}\nfunction removePermissions( subject:string | Pointer.Class, permissions: string | Pointer.Class | (string | Pointer.Class)[], aces:ACE.Class[] ):void {\n\tlet subjectPointer:Pointer.Class = parsePointer.call( this, subject );\n\tlet permissionPointers:Pointer.Class[] = parsePointers.call( this, permissions );\n\tremovePermissionsFrom.call( this, subjectPointer, permissionPointers, aces );\n}\nfunction remove( subject:string | Pointer.Class, permission:string | Pointer.Class ): void;\nfunction remove( subject:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\nfunction remove( subject:string | Pointer.Class, permissions:string | Pointer.Class | (string | Pointer.Class)[] ): void {\n\tlet that:Class = this;\n\tremovePermissions.call( this, subject, permissions, that.accessControlEntries );\n}\nfunction removeChildInheritance( subject:string | Pointer.Class, permission:string | Pointer.Class ): void;\nfunction removeChildInheritance( subject:string | Pointer.Class, permissions:(string | Pointer.Class)[] ): void;\nfunction removeChildInheritance( subject:string | Pointer.Class, permissions: string | Pointer.Class | (string | Pointer.Class)[] ): void {\n\tlet that:Class = this;\n\tremovePermissions.call( this, subject, permissions, that.inheritableEntries );\n}\n\nexport default Class;\n"],"sourceRoot":"/source/"}