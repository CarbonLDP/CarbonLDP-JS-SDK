{"version":3,"sources":["Auth/PersistedRole.ts"],"names":[],"mappings":"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","file":"PersistedRole.js","sourcesContent":["import * as Context from \"./../Context\";\nimport * as Documents from \"./../Documents\";\nimport * as Errors from \"./../Errors\";\nimport * as HTTP from \"./../HTTP\";\nimport * as PersistedProtectedDocument from \"./../PersistedProtectedDocument\";\nimport * as Pointer from \"./../Pointer\";\nimport * as RetrievalPreferences from \"./../RetrievalPreferences\";\nimport * as Utils from \"./../Utils\";\nimport * as Role from \"./Role\";\nimport * as Roles from \"./Roles\";\n\nexport interface Class extends PersistedProtectedDocument.Class {\n\t_roles:Roles.Class;\n\n\tname?:string;\n\tdescription?:string;\n\tusers?:Pointer.Class[];\n\n\tcreateChild<T extends Role.Class>( role:T, requestOptions?:HTTP.Request.Options ):Promise<[ T & Class, HTTP.Response.Class ]>;\n\tcreateChild<T extends Role.Class>( role:T, slug?:string, requestOptions?:HTTP.Request.Options ):Promise<[ T & Class, HTTP.Response.Class ]>;\n\n\tlistUsers( requestOptions?:HTTP.Request.Options ):Promise<[ Pointer.Class[], HTTP.Response.Class ]>;\n\n\tgetUsers( requestOptions?:HTTP.Request.Options ):Promise<[ Pointer.Class[], HTTP.Response.Class ]>;\n\tgetUsers( retrievalPreferencesOrRequestOptions?:RetrievalPreferences.Class, requestOptions?:HTTP.Request.Options ):Promise<[ Pointer.Class[], HTTP.Response.Class ]>;\n\n\taddUser( user:Pointer.Class | string, requestOptions?:HTTP.Request.Options ):Promise<HTTP.Response.Class>;\n\taddUsers( users:(Pointer.Class | string)[], requestOptions?:HTTP.Request.Options ):Promise<HTTP.Response.Class>;\n\n\tremoveUser( user:Pointer.Class | string, requestOptions?:HTTP.Request.Options ):Promise<HTTP.Response.Class>;\n\tremoveUsers( users:(Pointer.Class | string)[], requestOptions?:HTTP.Request.Options ):Promise<HTTP.Response.Class>;\n}\n\nexport class Factory {\n\n\tstatic hasClassProperties( object:Object ):boolean {\n\t\treturn Utils.hasPropertyDefined( object, \"_roles\" )\n\t\t\t&& Utils.hasFunction( object, \"createChild\" )\n\t\t\t&& Utils.hasFunction( object, \"listUsers\" )\n\t\t\t&& Utils.hasFunction( object, \"getUsers\" )\n\t\t\t&& Utils.hasFunction( object, \"addUser\" )\n\t\t\t&& Utils.hasFunction( object, \"addUsers\" )\n\t\t\t&& Utils.hasFunction( object, \"removeUser\" )\n\t\t\t&& Utils.hasFunction( object, \"removeUsers\" )\n\t\t\t;\n\t}\n\n\tstatic is( object:Object ):boolean {\n\t\treturn Factory.hasClassProperties( object )\n\t\t\t&& PersistedProtectedDocument.Factory.is( object );\n\t}\n\n\tstatic decorate<T extends object>( object:T, documents:Documents.Class ):T & Class {\n\t\tlet persistedRole:Class & T = <T & Class> object;\n\t\tif( Factory.hasClassProperties( persistedRole ) ) return persistedRole;\n\n\t\tPersistedProtectedDocument.Factory.decorate( persistedRole, documents );\n\n\t\t// TODO: Fix\n\t\tconst context:Context.Class = (documents as any as { context:Context.Class }).context;\n\t\tconst roles:Roles.Class = context ? context.auth.roles : null;\n\n\t\tObject.defineProperties( persistedRole, {\n\t\t\t\"_roles\": {\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: roles,\n\t\t\t},\n\t\t\t\"createChild\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: createChild,\n\t\t\t},\n\t\t\t\"listUsers\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: listUsers,\n\t\t\t},\n\t\t\t\"getUsers\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: getUsers,\n\t\t\t},\n\t\t\t\"addUser\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: addUser,\n\t\t\t},\n\t\t\t\"addUsers\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: addUsers,\n\t\t\t},\n\t\t\t\"removeUser\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: removeUser,\n\t\t\t},\n\t\t\t\"removeUsers\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: removeUsers,\n\t\t\t},\n\t\t} );\n\n\t\treturn persistedRole;\n\t}\n\n}\n\nfunction createChild<T extends Role.Class>( role:T, requestOptions?:HTTP.Request.Options ):Promise<[ T & Class, HTTP.Response.Class ]>;\nfunction createChild<T extends Role.Class>( role:T, slug?:string, requestOptions?:HTTP.Request.Options ):Promise<[ T & Class, HTTP.Response.Class ]>;\nfunction createChild<T extends Role.Class>( this:Class, role:T, slugOrRequestOptions?:any, requestOptions?:HTTP.Request.Options ):Promise<[ T & Class, HTTP.Response.Class ]> {\n\tcheckState( this );\n\treturn this._roles.createChild( this.id, role, slugOrRequestOptions, requestOptions );\n}\n\nfunction listUsers( this:Class, requestOptions?:HTTP.Request.Options ):Promise<[ Pointer.Class[], HTTP.Response.Class ]> {\n\tcheckState( this );\n\treturn this._roles.listUsers( this.id, requestOptions );\n}\n\nfunction getUsers( requestOptions?:HTTP.Request.Options ):Promise<[ Pointer.Class[], HTTP.Response.Class ]>;\nfunction getUsers( this:Class, retrievalPreferencesOrRequestOptions?:RetrievalPreferences.Class, requestOptions?:HTTP.Request.Options ):Promise<[ Pointer.Class[], HTTP.Response.Class ]> {\n\tcheckState( this );\n\treturn this._roles.getUsers( this.id, retrievalPreferencesOrRequestOptions, requestOptions );\n}\n\n\nfunction addUser( this:Class, user:Pointer.Class | string, requestOptions?:HTTP.Request.Options ):Promise<HTTP.Response.Class> {\n\tcheckState( this );\n\treturn this._roles.addUsers( this.id, [ user ], requestOptions );\n}\nfunction addUsers( this:Class, users:(Pointer.Class | string)[], requestOptions?:HTTP.Request.Options ):Promise<HTTP.Response.Class> {\n\tcheckState( this );\n\treturn this._roles.addUsers( this.id, users, requestOptions );\n}\n\nfunction removeUser( this:Class, user:Pointer.Class | string, requestOptions?:HTTP.Request.Options ):Promise<HTTP.Response.Class> {\n\tcheckState( this );\n\treturn this._roles.removeUsers( this.id, [ user ], requestOptions );\n}\nfunction removeUsers( this:Class, users:(Pointer.Class | string)[], requestOptions?:HTTP.Request.Options ):Promise<HTTP.Response.Class> {\n\tcheckState( this );\n\treturn this._roles.removeUsers( this.id, users, requestOptions );\n}\n\nfunction checkState( role:Class ):void {\n\tif( ! role._roles ) throw new Errors.IllegalStateError( \"The context of the current role, does not support roles management.\" );\n}\n\nexport default Class;\n"]}