{"version":3,"sources":["Auth/PersistedRole.ts"],"names":[],"mappings":"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","file":"PersistedRole.js","sourcesContent":["import { Documents } from \"../Documents\";\nimport * as Errors from \"../Errors\";\nimport { RequestOptions } from \"../HTTP/Request\";\nimport { ProtectedDocument } from \"../ProtectedDocument\";\nimport { Pointer } from \"../Pointer\";\nimport { QueryDocumentsBuilder } from \"../SPARQL/QueryDocument\";\nimport * as Utils from \"./../Utils\";\nimport { User } from \"./User\";\nimport { RoleBase } from \"./Role\";\nimport { RolesEndpoint } from \"./RolesEndpoint\";\n\n\nexport interface Class extends ProtectedDocument {\n\tname?:string;\n\tdescription?:string;\n\n\tparent?:Pointer;\n\tchildren?:Pointer[];\n\n\tusers?:Pointer[];\n\n\n\tcreateChild<T extends object>( role:T & RoleBase, slug?:string, requestOptions?:RequestOptions ):Promise<T & Class>;\n\tcreateChild<T extends object>( role:T & RoleBase, requestOptions?:RequestOptions ):Promise<T & Class>;\n\n\tgetUsers<T>( requestOptions?:RequestOptions, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & User)[]>;\n\tgetUsers<T>( queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & User)[]>;\n\n\taddUser( user:Pointer | string, requestOptions?:RequestOptions ):Promise<void>;\n\taddUsers( users:(Pointer | string)[], requestOptions?:RequestOptions ):Promise<void>;\n\n\tremoveUser( user:Pointer | string, requestOptions?:RequestOptions ):Promise<void>;\n\n\tremoveUsers( users:(Pointer | string)[], requestOptions?:RequestOptions ):Promise<void>;\n}\n\nexport class Factory {\n\n\tstatic hasClassProperties( object:object ):object is Class {\n\t\treturn Utils.isObject( object )\n\t\t\t&& Utils.hasFunction( object, \"createChild\" )\n\t\t\t&& Utils.hasFunction( object, \"getUsers\" )\n\t\t\t&& Utils.hasFunction( object, \"addUser\" )\n\t\t\t&& Utils.hasFunction( object, \"addUsers\" )\n\t\t\t&& Utils.hasFunction( object, \"removeUser\" )\n\t\t\t&& Utils.hasFunction( object, \"removeUsers\" )\n\t\t\t;\n\t}\n\n\tstatic is( object:object ):object is Class {\n\t\treturn Factory.hasClassProperties( object )\n\t\t\t&& ProtectedDocument.is( object );\n\t}\n\n\tstatic decorate<T extends object>( object:T, documents:Documents ):T & Class {\n\t\tif( Factory.hasClassProperties( object ) ) return object;\n\n\t\tProtectedDocument.decorate( object, documents );\n\n\t\treturn Object.defineProperties( object, {\n\t\t\t\"createChild\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: createChild,\n\t\t\t},\n\t\t\t\"getUsers\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: getUsers,\n\t\t\t},\n\t\t\t\"addUser\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: addUser,\n\t\t\t},\n\t\t\t\"addUsers\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: addUsers,\n\t\t\t},\n\t\t\t\"removeUser\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: removeUser,\n\t\t\t},\n\t\t\t\"removeUsers\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true,\n\t\t\t\tvalue: removeUsers,\n\t\t\t},\n\t\t} );\n\t}\n\n}\n\nfunction createChild<T extends object>( role:T & RoleBase, requestOptions?:RequestOptions ):Promise<T & Class>;\nfunction createChild<T extends object>( role:T & RoleBase, slug?:string, requestOptions?:RequestOptions ):Promise<T & Class>;\nfunction createChild<T extends object>( this:Class, role:T & RoleBase, slugOrRequestOptions?:any, requestOptions?:RequestOptions ):Promise<T & Class> {\n\treturn getRolesClass( this )\n\t\t.then( roles => {\n\t\t\treturn roles.createChild<T>( this.id, role, slugOrRequestOptions, requestOptions );\n\t\t} );\n}\n\nfunction getUsers<T extends object>( requestOptions?:RequestOptions, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & User)[]>;\nfunction getUsers<T extends object>( queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & User)[]>;\nfunction getUsers<T extends object>( this:Class, queryBuilderFnOrOptions:any, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & User)[]> {\n\treturn getRolesClass( this )\n\t\t.then( roles => {\n\t\t\treturn roles.getUsers<T>( this.id, queryBuilderFnOrOptions, queryBuilderFn );\n\t\t} );\n}\n\nfunction addUser( this:Class, user:Pointer | string, requestOptions?:RequestOptions ):Promise<void> {\n\treturn getRolesClass( this )\n\t\t.then( roles => {\n\t\t\treturn roles.addUser( this.id, user, requestOptions );\n\t\t} );\n}\n\nfunction addUsers( this:Class, users:(Pointer | string)[], requestOptions?:RequestOptions ):Promise<void> {\n\treturn getRolesClass( this )\n\t\t.then( roles => {\n\t\t\treturn roles.addUsers( this.id, users, requestOptions );\n\t\t} );\n}\n\nfunction removeUser( this:Class, user:Pointer | string, requestOptions?:RequestOptions ):Promise<void> {\n\treturn getRolesClass( this )\n\t\t.then( roles => {\n\t\t\treturn roles.removeUser( this.id, user, requestOptions );\n\t\t} );\n}\n\nfunction removeUsers( this:Class, users:(Pointer | string)[], requestOptions?:RequestOptions ):Promise<void> {\n\treturn getRolesClass( this )\n\t\t.then( roles => {\n\t\t\treturn roles.removeUsers( this.id, users, requestOptions );\n\t\t} );\n}\n\nfunction getRolesClass( role:Class ):Promise<RolesEndpoint> {\n\treturn Utils.promiseMethod( () => {\n\t\tif( ! role._documents[ \"context\" ] )\n\t\t\tthrow new Errors.IllegalStateError( \"The context of the role doesn't support roles management.\" );\n\n\t\treturn role._documents[ \"context\" ].auth.roles;\n\t} );\n}\n\nexport default Class;\n"]}