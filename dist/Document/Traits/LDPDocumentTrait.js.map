{"version":3,"sources":["Document/Traits/LDPDocumentTrait.ts"],"names":[],"mappings":"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","file":"LDPDocumentTrait.js","sourcesContent":["import { LDPDocumentsRepositoryTrait } from \"../../DocumentsRepository/Traits/LDPDocumentsRepositoryTrait\";\nimport { _parseURIParams } from \"../../DocumentsRepository/Utils\";\n\nimport { RequestOptions } from \"../../HTTP/Request\";\nimport { ModelDecorator } from \"../../Model/ModelDecorator\";\n\nimport { ModelPrototype } from \"../../Model/ModelPrototype\";\n\nimport { Pointer } from \"../../Pointer/Pointer\";\nimport { URI } from \"../../RDF/URI\";\n\nimport { ResolvablePointer } from \"../../Repository/ResolvablePointer\";\n\nimport { isObject, isString } from \"../../Utils\";\n\nimport { Document } from \"../Document\";\nimport { TransientDocument } from \"../TransientDocument\";\n\n\nexport interface BaseLDPDocumentTrait {\n\t$repository:LDPDocumentsRepositoryTrait;\n}\n\nexport interface LDPDocumentTrait extends TransientDocument, ResolvablePointer {\n\t$repository:LDPDocumentsRepositoryTrait;\n\n\t$create<T extends object>( children:T[], requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\t$create<T extends object>( children:T[], slugs?:string[], requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\t$create<T extends object>( child:T, requestOptions?:RequestOptions ):Promise<T & Document>;\n\t$create<T extends object>( child:T, slug?:string, requestOptions?:RequestOptions ):Promise<T & Document>;\n\t$create<T extends object>( uri:string, children:T[], requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\t$create<T extends object>( uri:string, children:T[], slugs?:string[], requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\t$create<T extends object>( uri:string, child:T, requestOptions?:RequestOptions ):Promise<T & Document>;\n\t$create<T extends object>( uri:string, child:T, slug?:string, requestOptions?:RequestOptions ):Promise<T & Document>;\n\n\t$createAndRetrieve<T extends object>( children:T[], requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\t$createAndRetrieve<T extends object>( children:T[], slugs?:string[], requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\t$createAndRetrieve<T extends object>( child:T, requestOptions?:RequestOptions ):Promise<T & Document>;\n\t$createAndRetrieve<T extends object>( child:T, slug?:string, requestOptions?:RequestOptions ):Promise<T & Document>;\n\t$createAndRetrieve<T extends object>( uri:string, children:T[], requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\t$createAndRetrieve<T extends object>( uri:string, children:T[], slugs?:string[], requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\t$createAndRetrieve<T extends object>( uri:string, child:T, requestOptions?:RequestOptions ):Promise<T & Document>;\n\t$createAndRetrieve<T extends object>( uri:string, child:T, slug?:string, requestOptions?:RequestOptions ):Promise<T & Document>;\n\n\n\t$addMember( member:string | Pointer, requestOptions?:RequestOptions ):Promise<void>;\n\t$addMember( uri:string, member:string | Pointer, requestOptions?:RequestOptions ):Promise<void>;\n\n\t$addMembers( members:(string | Pointer)[], requestOptions?:RequestOptions ):Promise<void>;\n\t$addMembers( uri:string, members:(string | Pointer)[], requestOptions?:RequestOptions ):Promise<void>;\n\n\n\t$removeMember( member:string | Pointer, requestOptions?:RequestOptions ):Promise<void>;\n\t$removeMember( uri:string, member:string | Pointer, requestOptions?:RequestOptions ):Promise<void>;\n\n\t$removeMembers( members?:(string | Pointer)[], requestOptions?:RequestOptions ):Promise<void>;\n\t$removeMembers( requestOptions?:RequestOptions ):Promise<void>;\n\t$removeMembers( uri:string, members?:(string | Pointer)[], requestOptions?:RequestOptions ):Promise<void>;\n\t$removeMembers( uri:string, requestOptions?:RequestOptions ):Promise<void>;\n}\n\n\nfunction __parseMemberParams( this:void, resource:Pointer, args:IArguments ):{ uri:string, params:any[] } {\n\tconst params:any[] = Array.from( args );\n\n\tconst uri:string = isString( params[ 0 ] ) && isString( Pointer.getID( params[ 1 ] ) ) ?\n\t\tURI.resolve( resource.$id, params.shift() ) : resource.$id;\n\n\treturn { uri, params };\n}\n\nexport type LDPDocumentTraitFactory =\n\t& ModelPrototype<LDPDocumentTrait, TransientDocument & ResolvablePointer>\n\t& ModelDecorator<LDPDocumentTrait, BaseLDPDocumentTrait>\n\t;\n\nexport const LDPDocumentTrait:LDPDocumentTraitFactory = {\n\tPROTOTYPE: {\n\t\t$create<T extends object>( this:LDPDocumentTrait, uriOrChildren:string | T | T[], childrenOrSlugsOrRequestOptions?:T | T[] | string | string[] | RequestOptions, slugsOrRequestOptions?:string | string[] | RequestOptions, requestOptions?:RequestOptions ):Promise<(T & Document) | (T & Document)[]> {\n\t\t\tconst { _uri, _args } = _parseURIParams( this, uriOrChildren, arguments );\n\t\t\t// FIXME\n\t\t\t// @ts-ignore\n\t\t\treturn this.$repository.create( _uri, ..._args );\n\t\t},\n\n\t\t$createAndRetrieve<T extends object>( this:LDPDocumentTrait, uriOrChildren?:string | T | T[], childrenOrSlugsOrRequestOptions?:T | T[] | string | string[] | RequestOptions, slugsOrRequestOptions?:string | string[] | RequestOptions, requestOptions:RequestOptions = {} ):Promise<(T & Document) | (T & Document)[]> {\n\t\t\tconst { _uri, _args } = _parseURIParams( this, uriOrChildren, arguments );\n\t\t\t// FIXME\n\t\t\t// @ts-ignore\n\t\t\treturn this.$repository.createAndRetrieve( _uri, ..._args );\n\t\t},\n\n\n\t\t$addMember( this:LDPDocumentTrait, uriOrMember:string | (Pointer | string), memberOrOptions?:(Pointer | string) | RequestOptions, requestOptions?:RequestOptions ):Promise<void> {\n\t\t\tconst { uri, params } = __parseMemberParams( this, arguments );\n\t\t\t// FIXME\n\t\t\t// @ts-ignore\n\t\t\treturn this.$repository.addMember( uri, ...params );\n\t\t},\n\n\t\t$addMembers( this:LDPDocumentTrait, uriOrMembers:string | (Pointer | string)[], membersOrOptions:(Pointer | string)[] | RequestOptions, requestOptions?:RequestOptions ):Promise<void> {\n\t\t\tconst { _uri, _args } = _parseURIParams( this, uriOrMembers, arguments );\n\t\t\t// FIXME\n\t\t\t// @ts-ignore\n\t\t\treturn this.$repository.addMembers( _uri, ..._args );\n\t\t},\n\n\n\t\t$removeMember( this:LDPDocumentTrait, uriOrMember:string | (Pointer | string), memberOrOptions:(Pointer | string) | RequestOptions, requestOptions?:RequestOptions ):Promise<void> {\n\t\t\tconst { uri, params } = __parseMemberParams( this, arguments );\n\t\t\t// FIXME\n\t\t\t// @ts-ignore\n\t\t\treturn this.$repository.removeMember( uri, ...params );\n\t\t},\n\n\t\t$removeMembers( this:LDPDocumentTrait, uriOrMembersOrOptions?:string | (Pointer | string)[] | RequestOptions, membersOrOptions?:(Pointer | string)[] | RequestOptions, requestOptions?:RequestOptions ):Promise<void> {\n\t\t\tconst { _uri, _args } = _parseURIParams( this, uriOrMembersOrOptions, arguments );\n\t\t\treturn this.$repository.removeMembers( _uri, ..._args );\n\t\t},\n\t},\n\n\tisDecorated( object:object ):object is LDPDocumentTrait {\n\t\treturn isObject( object )\n\t\t\t&& ModelDecorator\n\t\t\t\t.hasPropertiesFrom( LDPDocumentTrait.PROTOTYPE, object )\n\t\t\t;\n\t},\n\n\tdecorate<T extends BaseLDPDocumentTrait>( object:T ):T & LDPDocumentTrait {\n\t\tif( LDPDocumentTrait.isDecorated( object ) ) return object;\n\n\t\tconst target:T & TransientDocument & ResolvablePointer = ModelDecorator\n\t\t\t.decorateMultiple( object, TransientDocument, ResolvablePointer );\n\n\t\treturn ModelDecorator\n\t\t\t.definePropertiesFrom( LDPDocumentTrait.PROTOTYPE, target );\n\t},\n};\n"]}