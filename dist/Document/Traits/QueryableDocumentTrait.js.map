{"version":3,"sources":["Document/Traits/QueryableDocumentTrait.ts"],"names":[],"mappings":";;AAEA,yDAAkE;AAIlE,6DAA4D;AAG5D,0EAAyE;AAKzE,uDAAsD;AAiEzC,QAAA,sBAAsB,GAAiC;IACnE,SAAS,EAAE;QACV,YAAY,EAAZ,UAA6D,4BAAyE,EAAE,uBAA4D,EAAE,cAAkC;;YACjO,IAAA,2EAAkF,EAAhF,cAAI,EAAE,gBAAK,CAAsE;YAGzF,OAAO,CAAA,KAAA,IAAI,CAAC,WAAW,CAAA,CAAC,WAAW,YAAE,IAAI,SAAK,KAAK,GAAG;QACvD,CAAC;QAED,WAAW,EAAX,UAA4D,4BAAyE,EAAE,uBAA4D,EAAE,cAAkC;;YAChO,IAAA,2EAAkF,EAAhF,cAAI,EAAE,gBAAK,CAAsE;YAGzF,OAAO,CAAA,KAAA,IAAI,CAAC,WAAW,CAAA,CAAC,UAAU,YAAE,IAAI,SAAK,KAAK,GAAG;QACtD,CAAC;QAGD,aAAa,EAAb,UAA8D,YAAoC,EAAE,cAA8B;;YAC3H,IAAA,2DAAkE,EAAhE,cAAI,EAAE,gBAAK,CAAsD;YAGzE,OAAO,CAAA,KAAA,IAAI,CAAC,WAAW,CAAA,CAAC,YAAY,YAAE,IAAI,SAAK,KAAK,GAAG;QACxD,CAAC;QAED,YAAY,EAAZ,UAA6D,YAAoC,EAAE,cAA8B;;YAC1H,IAAA,2DAAkE,EAAhE,cAAI,EAAE,gBAAK,CAAsD;YAGzE,OAAO,CAAA,KAAA,IAAI,CAAC,WAAW,CAAA,CAAC,WAAW,YAAE,IAAI,SAAK,KAAK,GAAG;QACvD,CAAC;KACD;IAGD,WAAW,EAAX,UAAa,MAAa;QACzB,OAAO,+BAAc;aACnB,iBAAiB,CAAE,8BAAsB,CAAC,SAAS,EAAE,MAAM,CAAE,CAAC;IACjE,CAAC;IAED,QAAQ,EAAR,UAAgD,MAAQ;QACvD,IAAI,8BAAsB,CAAC,WAAW,CAAE,MAAM,CAAE;YAAG,OAAO,MAAM,CAAC;QAGjE,IAAM,MAAM,GAAW,MAAiB,CAAC;QAEzC,IAAM,MAAM,GAAiD,+BAAc;aACzE,gBAAgB,CAAE,MAAM,EAAE,mCAAgB,EAAE,mCAAgB,CAAE,CAAC;QAEjE,OAAO,+BAAc;aACnB,oBAAoB,CAAE,8BAAsB,CAAC,SAAS,EAAE,MAAM,CAAE,CAAC;IACpE,CAAC;CACD,CAAC","file":"QueryableDocumentTrait.js","sourcesContent":["import { QueryableDocumentsRepositoryTrait } from \"../../DocumentsRepository/Traits/QueryableDocumentsRepositoryTrait\";\n\nimport { _parseURIParams } from \"../../DocumentsRepository/Utils\";\n\nimport { GETOptions, RequestOptions } from \"../../HTTP/Request\";\n\nimport { ModelDecorator } from \"../../Model/ModelDecorator\";\nimport { ModelPrototype } from \"../../Model/ModelPrototype\";\n\nimport { QueryablePointer } from \"../../QueryDocuments/QueryablePointer\";\nimport { QueryDocumentBuilder } from \"../../QueryDocuments/QueryDocumentBuilder\";\nimport { QueryDocumentsBuilder } from \"../../QueryDocuments/QueryDocumentsBuilder\";\n\nimport { Document } from \"../Document\";\nimport { LDPDocumentTrait } from \"./LDPDocumentTrait\";\n\n\nexport interface BaseQueryableDocumentTrait {\n\t$repository:QueryableDocumentsRepositoryTrait;\n}\n\nexport interface QueryableDocumentTrait extends LDPDocumentTrait, QueryablePointer {\n\t$repository:QueryableDocumentsRepositoryTrait;\n\n\n\t$get<T extends object>( queryBuilderFn:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & Document>;\n\t$get<T extends object>( requestOptions?:GETOptions, queryBuilderFn?:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & Document>;\n\t$get<T extends object>( uri:string, queryBuilderFn:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & Document>;\n\t$get<T extends object>( uri:string, requestOptions?:GETOptions, queryBuilderFn?:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & Document>;\n\n\t$resolve<T extends object>( queryBuilderFn:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & this & Document>;\n\t$resolve<T extends object>( requestOptions?:GETOptions, queryBuilderFn?:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & this & Document>;\n\t$resolve<T extends object>( document:Document, queryBuilderFn:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & Document>;\n\t$resolve<T extends object>( document:Document, requestOptions?:GETOptions, queryBuilderFn?:( queryBuilder:QueryDocumentBuilder ) => QueryDocumentBuilder ):Promise<T & Document>;\n\n\t$exists( requestOptions?:RequestOptions ):Promise<boolean>;\n\t$exists( uri:string, requestOptions?:RequestOptions ):Promise<boolean>;\n\n\n\t$refresh<T extends object>( requestOptions?:RequestOptions ):Promise<T & this>;\n\t$refresh<T extends object>( document:Document, requestOptions?:RequestOptions ):Promise<T & Document>;\n\n\t$save<T extends object>( requestOptions?:RequestOptions ):Promise<T & this>;\n\t$save<T extends object>( document:Document, requestOptions?:RequestOptions ):Promise<T & Document>;\n\n\t$saveAndRefresh<T extends object>( requestOptions?:RequestOptions ):Promise<T & this>;\n\t$saveAndRefresh<T extends object>( document:Document, requestOptions?:RequestOptions ):Promise<T & Document>;\n\n\n\t$delete( uri:string, requestOptions?:RequestOptions ):Promise<void>;\n\t$delete( requestOptions?:RequestOptions ):Promise<void>;\n\n\n\t$getChildren<T extends object>( requestOptions:RequestOptions, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\t$getChildren<T extends object>( queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\t$getChildren<T extends object>( uri:string, requestOptions:RequestOptions, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\t$getChildren<T extends object>( uri:string, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\n\t$getMembers<T extends object>( requestOptions:RequestOptions, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\t$getMembers<T extends object>( queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\t$getMembers<T extends object>( uri:string, requestOptions:RequestOptions, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\t$getMembers<T extends object>( uri:string, queryBuilderFn?:( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder ):Promise<(T & Document)[]>;\n\n\n\t$listChildren<T extends object>( requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\t$listChildren<T extends object>( uri:string, requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\n\t$listMembers<T extends object>( requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n\t$listMembers<T extends object>( uri:string, requestOptions?:RequestOptions ):Promise<(T & Document)[]>;\n}\n\n\ntype QueryDocsBuilderFn = Function & (( queryBuilder:QueryDocumentsBuilder ) => QueryDocumentsBuilder);\n\nexport type QueryableDocumentTraitFactory =\n\t& ModelPrototype<QueryableDocumentTrait, LDPDocumentTrait & QueryablePointer>\n\t& ModelDecorator<QueryableDocumentTrait, BaseQueryableDocumentTrait>\n\t;\n\nexport const QueryableDocumentTrait:QueryableDocumentTraitFactory = {\n\tPROTOTYPE: {\n\t\t$getChildren<T extends object>( this:QueryableDocumentTrait, uriOrQueryBuilderFnOrOptions:string | QueryDocsBuilderFn | RequestOptions, queryBuilderFnOrOptions?:QueryDocsBuilderFn | RequestOptions, queryBuilderFn?:QueryDocsBuilderFn ):Promise<(T & Document)[]> {\n\t\t\tconst { _uri, _args } = _parseURIParams( this, uriOrQueryBuilderFnOrOptions, arguments );\n\t\t\t// FIXME\n\t\t\t// @ts-ignore\n\t\t\treturn this.$repository.getChildren( _uri, ..._args );\n\t\t},\n\n\t\t$getMembers<T extends object>( this:QueryableDocumentTrait, uriOrQueryBuilderFnOrOptions:string | QueryDocsBuilderFn | RequestOptions, queryBuilderFnOrOptions?:QueryDocsBuilderFn | RequestOptions, queryBuilderFn?:QueryDocsBuilderFn ):Promise<(T & Document)[]> {\n\t\t\tconst { _uri, _args } = _parseURIParams( this, uriOrQueryBuilderFnOrOptions, arguments );\n\t\t\t// FIXME\n\t\t\t// @ts-ignore\n\t\t\treturn this.$repository.getMembers( _uri, ..._args );\n\t\t},\n\n\n\t\t$listChildren<T extends object>( this:QueryableDocumentTrait, uriOrOptions:string | RequestOptions, requestOptions?:RequestOptions ):Promise<(T & Document)[]> {\n\t\t\tconst { _uri, _args } = _parseURIParams( this, uriOrOptions, arguments );\n\t\t\t// FIXME\n\t\t\t// @ts-ignore\n\t\t\treturn this.$repository.listChildren( _uri, ..._args );\n\t\t},\n\n\t\t$listMembers<T extends object>( this:QueryableDocumentTrait, uriOrOptions:string | RequestOptions, requestOptions?:RequestOptions ):Promise<(T & Document)[]> {\n\t\t\tconst { _uri, _args } = _parseURIParams( this, uriOrOptions, arguments );\n\t\t\t// FIXME\n\t\t\t// @ts-ignore\n\t\t\treturn this.$repository.listMembers( _uri, ..._args );\n\t\t},\n\t},\n\n\n\tisDecorated( object:object ):object is QueryableDocumentTrait {\n\t\treturn ModelDecorator\n\t\t\t.hasPropertiesFrom( QueryableDocumentTrait.PROTOTYPE, object );\n\t},\n\n\tdecorate<T extends BaseQueryableDocumentTrait>( object:T ):T & QueryableDocumentTrait {\n\t\tif( QueryableDocumentTrait.isDecorated( object ) ) return object;\n\n\t\ttype ForcedT = T & Pick<QueryableDocumentTrait, \"$get\" | \"$resolve\">;\n\t\tconst forced:ForcedT = object as ForcedT;\n\n\t\tconst target:ForcedT & LDPDocumentTrait & QueryablePointer = ModelDecorator\n\t\t\t.decorateMultiple( forced, LDPDocumentTrait, QueryablePointer );\n\n\t\treturn ModelDecorator\n\t\t\t.definePropertiesFrom( QueryableDocumentTrait.PROTOTYPE, target );\n\t},\n};\n"]}