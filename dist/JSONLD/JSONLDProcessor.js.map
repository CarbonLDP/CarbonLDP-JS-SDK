{"version":3,"sources":["JSONLD/JSONLDProcessor.ts"],"names":[],"mappings":"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","file":"JSONLDProcessor.js","sourcesContent":["import { InvalidJSONLDSyntaxError } from \"../Errors/InvalidJSONLDSyntaxError\";\nimport { NotImplementedError } from \"../Errors/NotImplementedError\";\n\nimport { Header } from \"../HTTP/Header\";\nimport { JSONParser } from \"../HTTP/JSONParser\";\nimport { RequestOptions, RequestService, RequestUtils } from \"../HTTP/Request\";\nimport { Response } from \"../HTTP/Response\";\n\nimport { ContainerType } from \"../ObjectSchema/ContainerType\";\nimport { DigestedObjectSchema } from \"../ObjectSchema/DigestedObjectSchema\";\nimport { DigestedObjectSchemaProperty } from \"../ObjectSchema/DigestedObjectSchemaProperty\";\nimport { ObjectSchemaDigester } from \"../ObjectSchema/ObjectSchemaDigester\";\nimport { PointerType } from \"../ObjectSchema/PointerType\";\n\nimport { RDFList } from \"../RDF/List\";\nimport { URI } from \"../RDF/URI\";\n\nimport * as Utils from \"./../Utils\";\n\n\nconst MAX_CONTEXT_URLS:number = 10;\nconst LINK_HEADER_REL:string = \"http://www.w3.org/ns/json-ld#context\";\n\nexport class JSONLDProcessor {\n\n\tstatic expand( input:object ):Promise<object[]> {\n\t\t// Find and resolve context URLs\n\t\treturn JSONLDProcessor.retrieveContexts( input, <{ [ index:string ]:boolean }> Object.create( null ), \"\" ).then( () => {\n\t\t\t// Expand the document\n\t\t\tlet expanded:any = JSONLDProcessor.process( new DigestedObjectSchema(), input );\n\n\t\t\t// Optimize @graph\n\t\t\tif( Utils.isObject( expanded ) && \"@graph\" in expanded && Object.keys( expanded ).length === 1 ) {\n\t\t\t\texpanded = expanded[ \"@graph\" ];\n\t\t\t} else if( expanded === null ) {\n\t\t\t\texpanded = [];\n\t\t\t}\n\n\t\t\t// Normalize to an array\n\t\t\tif( ! Utils.isArray( expanded ) ) expanded = [ expanded ];\n\n\t\t\treturn expanded;\n\t\t} );\n\t}\n\n\tprivate static getTargetFromLinkHeader( header:Header ):string {\n\t\tlet rLinkHeader:RegExp = /\\s*<([^>]*?)>\\s*(?:;\\s*(.*))?/;\n\t\tfor( let value of header.values ) {\n\t\t\tlet match:string[] = value.toString().match( rLinkHeader );\n\t\t\tif( ! match ) continue;\n\n\t\t\tlet target:string = match[ 1 ];\n\t\t\tlet params:string = match[ 2 ];\n\t\t\tlet rParams:RegExp = /(.*?)=(?:(?:\"([^\"]*?)\")|([^\"]*?))\\s*(?:(?:;\\s*)|$)/g;\n\n\t\t\tlet result:{ [ key:string ]:string } = {};\n\t\t\twhile( true ) {\n\t\t\t\tmatch = rParams.exec( params );\n\t\t\t\tif( ! match ) break;\n\n\t\t\t\tresult[ match[ 1 ] ] = (match[ 2 ] === undefined) ? match[ 3 ] : match[ 2 ];\n\t\t\t}\n\t\t\tif( result[ \"rel\" ] === LINK_HEADER_REL ) return target;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate static findContextURLs( input:Object, contexts:{ [ index:string ]:Object }, base:string, replace:boolean = false ):boolean {\n\t\tlet previousContexts:number = Object.keys( contexts ).length;\n\n\t\tif( Utils.isArray( input ) ) {\n\t\t\tfor( let element of (<Array<Object>> input) ) {\n\t\t\t\tJSONLDProcessor.findContextURLs( element, contexts, base );\n\t\t\t}\n\t\t} else if( Utils.isPlainObject( input ) ) {\n\t\t\tfor( let key in input ) {\n\t\t\t\tif( \"@context\" !== key ) {\n\t\t\t\t\tJSONLDProcessor.findContextURLs( input[ key ], contexts, base );\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet urlOrArrayOrContext:string | Array<string | Object> | Object = input[ key ];\n\t\t\t\tif( Utils.isArray( urlOrArrayOrContext ) ) {\n\t\t\t\t\tlet contextArray:Array<string | Object> = <Array<string | Object>> urlOrArrayOrContext;\n\t\t\t\t\tfor( let index:number = 0, length:number = contextArray.length; index < length; ++ index ) {\n\t\t\t\t\t\tlet urlOrContext:string | Object = contextArray[ index ];\n\t\t\t\t\t\tif( ! Utils.isString( urlOrContext ) ) continue;\n\n\t\t\t\t\t\tlet url:string = <string> urlOrContext;\n\t\t\t\t\t\turl = URI.resolve( base, url );\n\t\t\t\t\t\tif( replace ) {\n\t\t\t\t\t\t\tif( Utils.isArray( contexts[ url ] ) ) {\n\t\t\t\t\t\t\t\tArray.prototype.splice.apply( contextArray, [ index, 1 ].concat( <any> contexts[ url ] ) );\n\t\t\t\t\t\t\t\tindex += (<Array<any>> contexts[ url ]).length - 1;\n\t\t\t\t\t\t\t\tlength = contextArray.length;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcontextArray[ index ] = contexts[ url ];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if( ! (url in contexts) ) {\n\t\t\t\t\t\t\tcontexts[ url ] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if( Utils.isString( urlOrArrayOrContext ) ) {\n\t\t\t\t\tlet url:string = <string> urlOrArrayOrContext;\n\t\t\t\t\turl = URI.resolve( base, url );\n\t\t\t\t\tif( replace ) {\n\t\t\t\t\t\tinput[ key ] = contexts[ url ];\n\t\t\t\t\t} else if( ! (url in contexts) ) {\n\t\t\t\t\t\tcontexts[ url ] = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn previousContexts < Object.keys( contexts ).length;\n\t}\n\n\tprivate static retrieveContexts( input:Object, contextsRequested:{ [ index:string ]:boolean }, base:string ):Promise<void> {\n\t\tif( Object.keys( contextsRequested ).length > MAX_CONTEXT_URLS ) return Promise.reject<void>( new InvalidJSONLDSyntaxError( \"Maximum number of @context URLs exceeded.\" ) );\n\n\t\tlet contextToResolved:{ [ index:string ]:Object } = Object.create( null );\n\t\tif( ! JSONLDProcessor.findContextURLs( input, contextToResolved, base ) ) return Promise.resolve();\n\n\t\tfunction resolved( url:string, promise:Promise<[ any, Response ]> ):Promise<void> {\n\t\t\treturn promise.then( ( [ object, response ]:[ any, Response ] ) => {\n\t\t\t\tlet _contextsRequested:{ [ index:string ]:boolean } = Utils.ObjectUtils.clone<{ [ index:string ]:boolean }>( contextsRequested );\n\t\t\t\t_contextsRequested[ url ] = true;\n\n\t\t\t\tlet contextWrapper:Object = { \"@context\": {} };\n\n\t\t\t\tlet header:Header = response.getHeader( \"Content-Type\" );\n\t\t\t\tif( ! Utils.StringUtils.contains( header.toString(), \"application/ld+json\" ) ) {\n\t\t\t\t\theader = response.getHeader( \"Link\" );\n\t\t\t\t\tlet link:string;\n\t\t\t\t\tif( ! ! header ) link = JSONLDProcessor.getTargetFromLinkHeader( header );\n\t\t\t\t\tif( ! ! link ) contextWrapper[ \"@context\" ] = link;\n\t\t\t\t} else {\n\t\t\t\t\tcontextWrapper[ \"@context\" ] = (\"@context\" in object) ? object[ \"@context\" ] : {};\n\t\t\t\t}\n\t\t\t\tcontextToResolved[ url ] = contextWrapper[ \"@context\" ];\n\n\t\t\t\treturn JSONLDProcessor.retrieveContexts( contextWrapper, _contextsRequested, url );\n\t\t\t} );\n\t\t}\n\n\t\tlet promises:Promise<void>[] = [];\n\t\tfor( let url in contextToResolved ) {\n\t\t\tif( url in contextsRequested ) return Promise.reject<void>( new InvalidJSONLDSyntaxError( \"Cyclical @context URLs detected.\" ) );\n\n\t\t\tlet requestOptions:RequestOptions = { sendCredentialsOnCORS: false };\n\t\t\tRequestUtils.setAcceptHeader( \"application/ld+json, application/json\", requestOptions );\n\n\t\t\tlet promise:Promise<[ any, Response ]> = RequestService\n\t\t\t\t.get( url, requestOptions, new JSONParser() )\n\t\t\t\t.catch( ( response:Response ) =>\n\t\t\t\t\tPromise.reject( new InvalidJSONLDSyntaxError( `Unable to resolve context from \"${ url }\". Status code: ${ response.status }` ) )\n\t\t\t\t);\n\t\t\tpromises.push( resolved( url, promise ) );\n\t\t}\n\n\t\treturn Promise.all<void>( promises ).then( () => {\n\t\t\tJSONLDProcessor.findContextURLs( input, contextToResolved, base, true );\n\t\t} );\n\t}\n\n\tprivate static isKeyword( value:string ):boolean {\n\t\tif( ! Utils.isString( value ) ) return false;\n\n\t\tswitch( value ) {\n\t\t\tcase \"@base\":\n\t\t\tcase \"@context\":\n\t\t\tcase \"@container\":\n\t\t\tcase \"@default\":\n\t\t\tcase \"@embed\":\n\t\t\tcase \"@explicit\":\n\t\t\tcase \"@graph\":\n\t\t\tcase \"@id\":\n\t\t\tcase \"@index\":\n\t\t\tcase \"@language\":\n\t\t\tcase \"@list\":\n\t\t\tcase \"@omitDefault\":\n\t\t\tcase \"@preserve\":\n\t\t\tcase \"@requireAll\":\n\t\t\tcase \"@reverse\":\n\t\t\tcase \"@set\":\n\t\t\tcase \"@type\":\n\t\t\tcase \"@value\":\n\t\t\tcase \"@vocab\":\n\t\t\t\treturn true;\n\n\t\t\tdefault:\n\t\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate static isValidType( value:any ):boolean {\n\t\tif( Utils.isString( value ) ) return true;\n\n\t\tif( ! Utils.isArray( value ) ) return false;\n\n\t\tfor( let element of (<Array<any>> value) ) {\n\t\t\tif( ! Utils.isString( element ) ) return false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate static expandURI( schema:DigestedObjectSchema, uri:string, relativeTo?:{ vocab?:boolean, base?:boolean } ):string {\n\t\tif( JSONLDProcessor.isKeyword( uri ) ) return uri;\n\t\treturn schema.resolveURI( uri, relativeTo );\n\t}\n\n\tprivate static expandLanguageMap( languageMap:any ):any {\n\t\tlet expandedLanguage:Array<Object> = [];\n\n\t\tlet keys:string[] = Object.keys( languageMap ).sort();\n\t\tfor( let key of keys ) {\n\t\t\tlet values:Array<any> = languageMap[ key ];\n\t\t\tif( ! Utils.isArray( values ) ) values = [ values ];\n\n\t\t\tfor( let item of values ) {\n\t\t\t\tif( item === null ) continue;\n\t\t\t\tif( ! Utils.isString( item ) ) throw new InvalidJSONLDSyntaxError( \"Language map values must be strings.\" );\n\n\t\t\t\texpandedLanguage.push( {\n\t\t\t\t\t\"@value\": item,\n\t\t\t\t\t\"@language\": key.toLowerCase(),\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t\treturn expandedLanguage;\n\t}\n\n\tprivate static getContainer( context:DigestedObjectSchema, property:string ):ContainerType {\n\t\tif( context.properties.has( property ) ) return context.properties.get( property ).containerType;\n\t\treturn void 0;\n\t}\n\n\tprivate static expandValue( context:DigestedObjectSchema, value:any, propertyName:string ):any {\n\t\tif( Utils.isNull( value ) || ! Utils.isDefined( value ) ) return null;\n\n\t\tif( propertyName === \"@id\" ) {\n\t\t\treturn JSONLDProcessor.expandURI( context, value, { base: true } );\n\t\t} else if( propertyName === \"@type\" ) {\n\t\t\treturn JSONLDProcessor.expandURI( context, value, { vocab: true, base: true } );\n\t\t}\n\n\t\tlet definition:DigestedObjectSchemaProperty = new DigestedObjectSchemaProperty();\n\t\tif( context.properties.has( propertyName ) ) definition = context.properties.get( propertyName );\n\n\t\tif( definition.literal === false || (propertyName === \"@graph\" && Utils.isString( value )) ) {\n\t\t\tlet options:{ base:boolean, vocab?:boolean } = { base: true };\n\t\t\tif( definition.pointerType === PointerType.VOCAB ) options.vocab = true;\n\n\t\t\treturn { \"@id\": JSONLDProcessor.expandURI( context, value, options ) };\n\t\t}\n\n\t\tif( JSONLDProcessor.isKeyword( propertyName ) ) return value;\n\n\t\tlet expandedValue:Object = {};\n\t\tif( definition.literalType ) {\n\t\t\texpandedValue[ \"@type\" ] = context.resolveURI( definition.literalType, { vocab: true, base: true } );\n\t\t} else if( Utils.isString( value ) ) {\n\t\t\tlet language:string = Utils.isDefined( definition.language ) ? definition.language : context.language;\n\t\t\tif( language !== null ) expandedValue[ \"@language\" ] = language;\n\t\t}\n\n\t\t// Normalize to string unknowns types\n\t\tif( [ \"boolean\", \"number\", \"string\" ].indexOf( typeof value ) === - 1 ) value = value.toString();\n\t\texpandedValue[ \"@value\" ] = value;\n\n\t\treturn expandedValue;\n\t}\n\n\tprivate static process( context:DigestedObjectSchema, element:Object, activeProperty?:string, insideList?:boolean ):Object {\n\t\tif( Utils.isNull( element ) || ! Utils.isDefined( element ) ) return null;\n\n\t\t// Expand an element according to the context\n\t\tif( ! Utils.isArray( element ) && ! Utils.isObject( element ) ) {\n\t\t\tif( ! insideList && (activeProperty === null || activeProperty === \"@graph\") ) return null;\n\t\t\treturn JSONLDProcessor.expandValue( context, element, activeProperty );\n\t\t}\n\n\t\t// Recursively expand the array\n\t\tif( Utils.isArray( element ) ) {\n\t\t\tlet container:ContainerType = JSONLDProcessor.getContainer( context, activeProperty );\n\t\t\tinsideList = insideList || container === ContainerType.LIST;\n\n\t\t\tconst expanded:object[] = [];\n\t\t\tfor( let item of element as any[] ) {\n\t\t\t\tlet expandedItem:any = JSONLDProcessor.process( context, item, activeProperty );\n\t\t\t\tif( expandedItem === null ) continue;\n\n\t\t\t\tif( insideList && (Utils.isArray( expandedItem ) || RDFList.is( expandedItem )) ) throw new InvalidJSONLDSyntaxError( \"Lists of lists are not permitted.\" );\n\n\t\t\t\tif( ! Utils.isArray( expandedItem ) ) expandedItem = [ expandedItem ];\n\t\t\t\texpanded.push( ...expandedItem );\n\t\t\t}\n\t\t\treturn expanded;\n\t\t}\n\n\t\t// Expand current context\n\t\tif( \"@context\" in element ) {\n\t\t\tcontext = ObjectSchemaDigester\n\t\t\t\t.combineDigestedObjectSchemas( [\n\t\t\t\t\tcontext,\n\t\t\t\t\tObjectSchemaDigester.digestSchema( element[ \"@context\" ] ),\n\t\t\t\t] );\n\t\t}\n\n\t\t// Recursively expand the object\n\t\tlet expandedElement:Object = {};\n\t\tlet keys:string[] = Object.keys( element );\n\t\tfor( let key of keys ) {\n\t\t\tif( key === \"@context\" ) continue;\n\n\t\t\tlet uri:string = JSONLDProcessor.expandURI( context, key, { vocab: true } );\n\t\t\tif( ! uri || ! (URI.isAbsolute( uri ) || URI.isBNodeID( uri ) || JSONLDProcessor.isKeyword( uri )) ) continue;\n\n\t\t\tlet value:any = element[ key ];\n\n\t\t\t// Validate value\n\t\t\tif( JSONLDProcessor.isKeyword( uri ) ) {\n\t\t\t\tif( uri === \"@id\" && ! Utils.isString( value ) ) throw new InvalidJSONLDSyntaxError( `\"@id\" value must a string.` );\n\t\t\t\tif( uri === \"@type\" && ! JSONLDProcessor.isValidType( value ) ) throw new InvalidJSONLDSyntaxError( `\"@type\" value must a string, an array of strings.` );\n\t\t\t\tif( uri === \"@graph\" && ! (Utils.isObject( value ) || Utils.isArray( value )) ) throw new InvalidJSONLDSyntaxError( `\"@graph\" value must not be an object or an array.` );\n\t\t\t\tif( uri === \"@value\" && (Utils.isObject( value ) || Utils.isArray( value )) ) throw new InvalidJSONLDSyntaxError( `\"@value\" value must not be an object or an array.` );\n\t\t\t\tif( uri === \"@language\" ) {\n\t\t\t\t\tif( value === null ) continue;\n\t\t\t\t\tif( ! Utils.isString( value ) ) throw new InvalidJSONLDSyntaxError( `\"@language\" value must be a string.` );\n\t\t\t\t\tvalue = (<string> value).toLowerCase();\n\t\t\t\t}\n\n\t\t\t\tif( uri === \"@index\" && ! Utils.isString( value ) ) throw new InvalidJSONLDSyntaxError( `\"@index\" value must be a string.` );\n\t\t\t\tif( uri === \"@reverse\" && ! Utils.isObject( value ) ) throw new InvalidJSONLDSyntaxError( `\"@reverse\" value must be an object.` );\n\t\t\t\t// TODO: Not supported\n\t\t\t\tif( uri === \"@index\" || uri === \"@reverse\" ) throw new NotImplementedError( `The SDK does not support \"@index\" and \"@reverse\" tags.` );\n\t\t\t}\n\n\t\t\tlet expandedValue:any;\n\t\t\tlet container:ContainerType = JSONLDProcessor.getContainer( context, key );\n\t\t\tif( container === ContainerType.LANGUAGE && Utils.isObject( value ) ) {\n\t\t\t\texpandedValue = JSONLDProcessor.expandLanguageMap( value );\n\t\t\t} else {\n\t\t\t\tlet nextActiveProperty:string = key;\n\n\t\t\t\tlet isList:boolean = uri === \"@list\";\n\t\t\t\tif( isList || uri === \"@set\" ) {\n\t\t\t\t\tnextActiveProperty = activeProperty;\n\t\t\t\t\tif( isList && activeProperty === \"@graph\" ) nextActiveProperty = null;\n\t\t\t\t}\n\n\t\t\t\texpandedValue = JSONLDProcessor.process( context, value, nextActiveProperty, isList );\n\t\t\t}\n\n\t\t\t// Drop null values if is not a \"@value\" property\n\t\t\tif( expandedValue === null && uri !== \"@value\" ) continue;\n\n\t\t\tif( uri !== \"@list\" && ! RDFList.is( expandedValue ) && container === ContainerType.LIST ) {\n\t\t\t\tif( ! Utils.isArray( expandedValue ) ) expandedValue = [ expandedValue ];\n\t\t\t\texpandedValue = { \"@list\": expandedValue };\n\t\t\t}\n\n\t\t\tlet useArray:boolean = [ \"@type\", \"@id\", \"@value\", \"@language\" ].indexOf( uri ) === - 1;\n\t\t\tJSONLDProcessor.addValue( expandedElement, uri, expandedValue, { propertyIsArray: useArray } );\n\t\t}\n\n\t\tif( \"@value\" in expandedElement ) {\n\t\t\tif( expandedElement[ \"@value\" ] === null ) expandedElement = null;\n\t\t} else if( \"@type\" in expandedElement ) {\n\t\t\tif( ! Utils.isArray( expandedElement[ \"@type\" ] ) ) expandedElement[ \"@type\" ] = [ expandedElement[ \"@type\" ] ];\n\t\t} else if( \"@set\" in expandedElement ) {\n\t\t\texpandedElement = expandedElement[ \"@set\" ];\n\t\t}\n\n\t\treturn expandedElement;\n\t}\n\n\tprivate static addValue( element:Object, propertyName:string, value:any, options:{ propertyIsArray:boolean } ):void {\n\t\tif( Utils.isArray( value ) ) {\n\t\t\tlet values:Array<any> = value;\n\t\t\tif( values.length === 0 && options.propertyIsArray && ! Utils.hasProperty( element, propertyName ) ) element[ propertyName ] = [];\n\t\t\tfor( let item of values ) {\n\t\t\t\tJSONLDProcessor.addValue( element, propertyName, item, options );\n\t\t\t}\n\n\t\t} else if( propertyName in element ) {\n\t\t\tif( ! JSONLDProcessor.hasValue( element, propertyName, value ) ) {\n\t\t\t\tlet items:Array<any> = element[ propertyName ];\n\t\t\t\tif( ! Utils.isArray( items ) ) items = element[ propertyName ] = [ items ];\n\t\t\t\titems.push( value );\n\t\t\t}\n\t\t} else {\n\t\t\telement[ propertyName ] = options.propertyIsArray ? [ value ] : value;\n\t\t}\n\t}\n\n\tprivate static hasProperty( element:Object, propertyName:string ):boolean {\n\t\tif( propertyName in element ) {\n\t\t\tlet item:any = element[ propertyName ];\n\t\t\treturn ! Utils.isArray( item ) || (<Array<any>> item).length > 0;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate static compareValues( value1:any, value2:any ):boolean {\n\t\tif( value1 === value2 ) return true;\n\n\t\tif( Utils.isObject( value1 ) && Utils.isObject( value2 ) ) {\n\n\t\t\tif( \"@value\" in value1\n\t\t\t\t&& value1[ \"@value\" ] === value2[ \"@value\" ]\n\t\t\t\t&& value1[ \"@type\" ] === value2[ \"@type\" ]\n\t\t\t\t&& value1[ \"@language\" ] === value2[ \"@language\" ]\n\t\t\t\t&& value1[ \"@index\" ] === value2[ \"@index\" ] )\n\t\t\t\treturn true;\n\n\t\t\tif( \"@id\" in value1 )\n\t\t\t\treturn value1[ \"@id\" ] === value2[ \"@id\" ];\n\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate static hasValue( element:Object, propertyName:string, value:any ):boolean {\n\t\tif( JSONLDProcessor.hasProperty( element, propertyName ) ) {\n\t\t\tlet item:any = element[ propertyName ];\n\t\t\tlet isList:boolean = RDFList.is( item );\n\n\t\t\tif( isList || Utils.isArray( item ) ) {\n\t\t\t\tlet items:any[] = isList ? item[ \"@list\" ] : item;\n\n\t\t\t\tfor( let entry of items ) {\n\t\t\t\t\tif( JSONLDProcessor.compareValues( entry, value ) ) return true;\n\t\t\t\t}\n\t\t\t} else if( ! Utils.isArray( value ) ) {\n\t\t\t\treturn JSONLDProcessor.compareValues( item, value );\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n}\n"]}