{"version":3,"sources":["RetrievalPreferences.ts"],"names":[],"mappings":"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","file":"RetrievalPreferences.js","sourcesContent":["import IllegalArgumentError from \"./Errors/IllegalArgumentError\";\nimport * as ObjectSchema from \"./ObjectSchema\";\nimport * as XSD from \"./NS/XSD\";\nimport * as URI from \"./RDF/URI\";\nimport * as Utils from \"./Utils\";\n\nexport interface Class {\n\torderBy?:OrderByProperty[];\n\tlimit?:number;\n\toffset?:number;\n}\n\nconst allowedTypes:string[] = [ \"numeric\", \"string\", \"boolean\", \"dateTime\" ];\n\nexport interface OrderByProperty {\n\t\"@id\":string;\n\t\"@type\"?:\"numeric\" | \"string\" | \"boolean\" | \"dateTime\";\n\t\"@language\"?:string;\n}\n\n\nexport class Factory {\n\tstatic is( object:Object ):boolean {\n\t\treturn Utils.hasPropertyDefined( object, \"orderBy\" )\n\t\t\t|| Utils.hasPropertyDefined( object, \"limit\" )\n\t\t\t|| Utils.hasPropertyDefined( object, \"offset\" );\n\t}\n}\n\nexport class Util {\n\n\tstatic stringifyRetrievalPreferences( retrievalPreferences:Class, digestedSchema?:ObjectSchema.DigestedObjectSchema ):string {\n\t\tlet stringPreferences:string = \"\";\n\n\t\tif( \"limit\" in retrievalPreferences ) {\n\t\t\tstringPreferences += `limit=${ retrievalPreferences.limit }`;\n\t\t}\n\n\t\tif( \"offset\" in retrievalPreferences ) {\n\t\t\tstringPreferences += `${ stringPreferences ? \"&\" : \"\" }offset=${ retrievalPreferences.offset }`;\n\t\t}\n\n\t\tif( \"orderBy\" in retrievalPreferences && retrievalPreferences.orderBy.length > 0 ) {\n\t\t\tstringPreferences += `${ stringPreferences ? \"&\" : \"\" }orderBy=`;\n\t\t\tlet stringOrders:string[] = [];\n\n\t\t\tfor( let orderBy of retrievalPreferences.orderBy ) {\n\t\t\t\tlet stringOrder:string = \"\";\n\n\t\t\t\tif( \"@id\" in orderBy ) {\n\t\t\t\t\tlet id:string = orderBy[ \"@id\" ];\n\t\t\t\t\tlet descending:boolean = false;\n\t\t\t\t\tif( id.startsWith( \"-\" ) ) {\n\t\t\t\t\t\tdescending = true;\n\t\t\t\t\t\tid = id.substr( 1 );\n\t\t\t\t\t}\n\n\t\t\t\t\tif( ! ! digestedSchema && URI.Util.isRelative( id ) ) {\n\t\t\t\t\t\tid = ObjectSchema.Digester.resolvePrefixedURI( new URI.Class( id ), digestedSchema ).stringValue;\n\t\t\t\t\t\tif( ! ! digestedSchema.vocab ) id = URI.Util.resolve( digestedSchema.vocab, id );\n\t\t\t\t\t}\n\n\t\t\t\t\tstringOrder += `${ descending ? \"-\" : \"\" }<${ encodeURI( id ).replace( \"#\", \"%23\" ) }>`;\n\t\t\t\t}\n\n\t\t\t\tif( \"@type\" in orderBy ) {\n\t\t\t\t\tif( ! stringOrder ) throw new IllegalArgumentError( \"The @id property is missing in OrderBy property.\" );\n\n\t\t\t\t\tlet type:string = orderBy[ \"@type\" ];\n\t\t\t\t\tif( allowedTypes.indexOf( type ) === - 1 ) throw new IllegalArgumentError( \"The @type value specified is not valid.\" );\n\n\t\t\t\t\tif( type !== \"numeric\" ) type = `<${ encodeURI( XSD.DataType[ type ] ).replace( \"#\", \"%23\" ) }>`;\n\t\t\t\t\tstringOrder += `;${ type }`;\n\t\t\t\t}\n\n\t\t\t\tif( \"@language\" in orderBy ) {\n\t\t\t\t\tif( ! stringOrder ) throw new IllegalArgumentError( \"The @id property is missing in OrderBy property.\" );\n\t\t\t\t\tstringOrder += `;${ orderBy[ \"@language\" ] }`;\n\t\t\t\t}\n\n\t\t\t\tstringOrders.push( stringOrder );\n\t\t\t}\n\n\t\t\tstringPreferences += stringOrders.join( \",\" );\n\t\t}\n\n\t\treturn stringPreferences ? \"?\" + stringPreferences : stringPreferences;\n\t}\n\n}\n\nexport default Class;\n"],"sourceRoot":"/source/"}