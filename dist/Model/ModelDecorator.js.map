{"version":3,"sources":["Model/ModelDecorator.ts"],"names":[],"mappings":";;AAAA,kCAAmD;AAuBtC,QAAA,cAAc,GAAyB;IACnD,iBAAiB,EAAjB,UAAmB,SAAgB,EAAE,MAAa;QACjD,MAAM,CAAC,MAAM;aACX,IAAI,CAAE,SAAS,CAAE;aACjB,KAAK,CAAE,UAAA,GAAG;YACV,IAAM,UAAU,GAAsB,MAAM;iBAC1C,wBAAwB,CAAE,SAAS,EAAE,GAAG,CAAE,CAAC;YAE7C,EAAE,CAAA,CAAE,UAAU,CAAC,KAAK,IAAI,kBAAU,CAAE,UAAU,CAAC,KAAK,CAAG,CAAC;gBACvD,MAAM,CAAC,mBAAW,CAAE,MAAM,EAAE,GAAG,CAAE,CAAC;YAEnC,MAAM,CAAC,MAAM,CAAC,cAAc,CAAE,GAAG,CAAE,IAAI,CAAE,MAAM,CAAC,oBAAoB,CAAE,GAAG,CAAE,CAAC;QAC7E,CAAC,CAAE,CACF;IACH,CAAC;IAED,oBAAoB,EAApB,UAA0D,SAAW,EAAE,MAAQ;QAC9E,MAAM;aACJ,IAAI,CAAE,SAAS,CAAE;aACjB,OAAO,CAAE,UAAA,GAAG;YACZ,IAAM,UAAU,GAAsB,MAAM;iBAC1C,wBAAwB,CAAE,SAAS,EAAE,GAAG,CAAE,CAAC;YAE7C,IAAM,UAAU,GAAsB;gBACrC,UAAU,EAAE,KAAK;gBACjB,YAAY,EAAE,IAAI;aAClB,CAAC;YAEF,EAAE,CAAA,CAAE,kBAAU,CAAE,UAAU,CAAC,KAAK,CAAG,CAAC,CAAC,CAAC;gBACrC,UAAU,CAAC,QAAQ,GAAG,KAAK,CAAC;gBAC5B,UAAU,CAAC,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC;YACrC,CAAC;YAAC,IAAI,CAAC,EAAE,CAAA,CAAE,CAAE,UAAU,CAAC,GAAI,CAAC,CAAC,CAAC;gBAC9B,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC;gBAC3B,UAAU,CAAC,KAAK,GAAG,MAAM,CAAC,cAAc,CAAE,GAAG,CAAE,CAAC,CAAC;oBAChD,MAAM,CAAE,GAAG,CAAE,CAAC,CAAC,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;oBAC/B,UAAU,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,KAAK,CAAC;YACvC,CAAC;YAAC,IAAI,CAAC,CAAC;gBACP,UAAU,CAAC,GAAG,GAAG,UAAU,CAAC,GAAG,CAAC;gBAChC,UAAU,CAAC,GAAG,GAAG,UAAU,CAAC,GAAG,CAAC;YACjC,CAAC;YAED,MAAM,CAAC,cAAc,CAAE,MAAM,EAAE,GAAG,EAAE,UAAU,CAAE,CAAC;QAClD,CAAC,CAAE,CACH;QAED,MAAM,CAAC,MAAe,CAAC;IACxB,CAAC;IAED,gBAAgB,EAAhB,UAAsD,MAAQ;QAAE,gBAA6B;aAA7B,UAA6B,EAA7B,qBAA6B,EAA7B,IAA6B;YAA7B,+BAA6B;;QAC5F,MAAM,CAAC,OAAO,CAAE,UAAA,KAAK,IAAI,OAAA,KAAK,CAAC,QAAQ,CAAE,MAAM,CAAE,EAAxB,CAAwB,CAAE,CAAC;QACpD,MAAM,CAAC,MAAe,CAAC;IACxB,CAAC;CACD,CAAC","file":"ModelDecorator.js","sourcesContent":["import { hasFunction, isFunction } from \"../Utils\";\n\n\nexport interface ModelDecorator<MODEL extends object, BASE extends object = object> {\n\tisDecorated( object:object ):object is MODEL;\n\n\tdecorate<W extends object>( object:W & BASE ):W & MODEL;\n}\n\n\nexport interface ModelDecoratorFactory {\n\thasPropertiesFrom<P extends object, O extends object>( prototype:P, object:O ):boolean;\n\n\tdefinePropertiesFrom<P extends object, O extends object>( prototype:P, object:O ):O & P;\n\n\tdecorateMultiple<O extends B1, M1 extends object, B1 extends object>( object:O, model1:ModelDecorator<M1, B1> ):O & M1;\n\tdecorateMultiple<O extends B1 & B2, M1 extends object, B1 extends object, M2 extends object, B2 extends object>( object:O, model1:ModelDecorator<M1, B1>, model2:ModelDecorator<M2, B2> ):O & M1 & M2;\n\tdecorateMultiple<O extends B1 & B2 & B3, M1 extends object, B1 extends object, M2 extends object, B2 extends object, M3 extends object, B3 extends object>( object:O, model1:ModelDecorator<M1, B1>, model2:ModelDecorator<M2, B2>, model3:ModelDecorator<M3, B3> ):O & M1 & M2 & M3;\n\tdecorateMultiple<O extends B1 & B2 & B3 & B4, M1 extends object, B1 extends object, M2 extends object, B2 extends object, M3 extends object, B3 extends object, M4 extends object, B4 extends object>( object:O, model1:ModelDecorator<M1, B1>, model2:ModelDecorator<M2, B2>, model3:ModelDecorator<M3, B3>, model4:ModelDecorator<M4, B4> ):O & M1 & M2 & M3 & M4;\n\tdecorateMultiple<O extends B1 & B2 & B3 & B4 & B5, M1 extends object, B1 extends object, M2 extends object, B2 extends object, M3 extends object, B3 extends object, M4 extends object, B4 extends object, M5 extends object, B5 extends object>( object:O, model1:ModelDecorator<M1, B1>, model2:ModelDecorator<M2, B2>, model3:ModelDecorator<M3, B3>, model4:ModelDecorator<M4, B4>, model5:ModelDecorator<M5, B5> ):O & M1 & M2 & M3 & M4 & M5;\n\tdecorateMultiple<O extends B1 & B2 & B3 & B4 & B5 & B6, M1 extends object, B1 extends object, M2 extends object, B2 extends object, M3 extends object, B3 extends object, M4 extends object, B4 extends object, M5 extends object, B5 extends object, M6 extends object, B6 extends object>( object:O, model1:ModelDecorator<M1, B1>, model2:ModelDecorator<M2, B2>, model3:ModelDecorator<M3, B3>, model4:ModelDecorator<M4, B4>, model5:ModelDecorator<M5, B5>, model6:ModelDecorator<M6, B6> ):O & M1 & M2 & M3 & M4 & M5 & M6;\n}\n\nexport const ModelDecorator:ModelDecoratorFactory = {\n\thasPropertiesFrom( prototype:object, object:object ):boolean {\n\t\treturn Object\n\t\t\t.keys( prototype )\n\t\t\t.every( key => {\n\t\t\t\tconst definition:PropertyDescriptor = Object\n\t\t\t\t\t.getOwnPropertyDescriptor( prototype, key );\n\n\t\t\t\tif( definition.value && isFunction( definition.value ) )\n\t\t\t\t\treturn hasFunction( object, key );\n\n\t\t\t\treturn object.hasOwnProperty( key ) && ! object.propertyIsEnumerable( key );\n\t\t\t} )\n\t\t\t;\n\t},\n\n\tdefinePropertiesFrom<P extends object, O extends object>( prototype:P, object:O ):O & P {\n\t\tObject\n\t\t\t.keys( prototype )\n\t\t\t.forEach( key => {\n\t\t\t\tconst definition:PropertyDescriptor = Object\n\t\t\t\t\t.getOwnPropertyDescriptor( prototype, key );\n\n\t\t\t\tconst descriptor:PropertyDescriptor = {\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t};\n\n\t\t\t\tif( isFunction( definition.value ) ) {\n\t\t\t\t\tdescriptor.writable = false;\n\t\t\t\t\tdescriptor.value = definition.value;\n\t\t\t\t} else if( ! definition.set ) {\n\t\t\t\t\tdescriptor.writable = true;\n\t\t\t\t\tdescriptor.value = object.hasOwnProperty( key ) ?\n\t\t\t\t\t\tobject[ key ] : definition.get ?\n\t\t\t\t\t\t\tdefinition.get() : definition.value;\n\t\t\t\t} else {\n\t\t\t\t\tdescriptor.get = definition.get;\n\t\t\t\t\tdescriptor.set = definition.set;\n\t\t\t\t}\n\n\t\t\t\tObject.defineProperty( object, key, descriptor );\n\t\t\t} )\n\t\t;\n\n\t\treturn object as P & O;\n\t},\n\n\tdecorateMultiple<O extends object, M extends object>( object:O, ...models:ModelDecorator<M>[] ):O & M {\n\t\tmodels.forEach( model => model.decorate( object ) );\n\t\treturn object as O & M;\n\t},\n};\n"]}