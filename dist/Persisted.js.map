{"version":3,"sources":["Persisted.ts"],"names":[],"mappings":";AACA,IAAY,KAAK,WAAM,SAAS,CAAC,CAAA;AAEjC;IAKC;QACC,IAAI,CAAC,GAAG,GAAG,IAAI,GAAG,EAA6B,CAAC;QAChD,IAAI,CAAC,GAAG,GAAG,IAAI,GAAG,EAA6B,CAAC;QAChD,IAAI,CAAC,MAAM,GAAG,IAAI,GAAG,EAA6B,CAAC;IACpD,CAAC;IACF,oBAAC;AAAD,CAVA,AAUC,IAAA;AAmEA,qBAAa,iBAnEb;AAED,IAAK,gBAIJ;AAJD,WAAK,gBAAgB;IACpB,qDAAG,CAAA;IACH,qDAAG,CAAA;IACH,2DAAM,CAAA;AACP,CAAC,EAJI,gBAAgB,KAAhB,gBAAgB,QAIpB;AA8DA,wBAAgB,oBA9DhB;AASD;IACC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;AACpB,CAAC;AAED;IAAA;IA6CA,CAAC;IA5CO,UAAE,GAAT,UAAW,MAAa;QACvB,MAAM,CAAC,CACN,KAAK,CAAC,kBAAkB,CAAE,MAAM,EAAE,QAAQ,CAAE;YAC5C,KAAK,CAAC,kBAAkB,CAAE,MAAM,EAAE,gBAAgB,CAAE;YACpD,KAAK,CAAC,WAAW,CAAE,MAAM,EAAE,SAAS,CAAE,CACtC,CAAC;IACH,CAAC;IAIM,YAAI,GAAX,UAAa,eAAmB;QAC/B,IAAI,OAAO,GAAY,KAAK,CAAC,OAAO,CAAE,eAAe,CAAE,GAAa,eAAe,GAAG,CAAU,eAAe,CAAE,CAAC;QAClH,IAAI,MAAM,GAAe,EAAE,CAAC;QAE5B,GAAG,CAAC,CAAE,IAAI,CAAC,GAAU,CAAC,EAAE,QAAM,GAAU,OAAO,CAAC,MAAM,EAAE,CAAC,GAAG,QAAM,EAAE,CAAC,EAAG,EAAG,CAAC;YAC3E,IAAI,KAAK,GAAkB,OAAO,CAAE,CAAC,CAAE,CAAC;YAExC,EAAE,CAAC,CAAE,CAAE,OAAO,CAAC,EAAE,CAAE,KAAK,CAAG,CAAC;gBAAC,OAAO,CAAC,cAAc,CAAE,KAAK,CAAE,CAAC;YAE7D,MAAM,CAAC,IAAI,CAAE,KAAK,CAAE,CAAC;QACtB,CAAC;QAED,EAAE,CAAC,CAAE,KAAK,CAAC,OAAO,CAAE,eAAe,CAAG,CAAC;YAAC,MAAM,CAAC,MAAM,CAAC;QACtD,MAAM,CAAC,MAAM,CAAE,CAAC,CAAE,CAAC;IACpB,CAAC;IAEc,sBAAc,GAA7B,UAA+B,KAAe;QAC7C,MAAM,CAAC,gBAAgB,CAAE,KAAK,EAAE;YAC/B,QAAQ,EAAE;gBACT,QAAQ,EAAE,IAAI;gBACd,UAAU,EAAE,KAAK;gBACjB,KAAK,EAAE,KAAK;aACZ;YACD,gBAAgB,EAAE;gBACjB,QAAQ,EAAE,KAAK;gBACf,UAAU,EAAE,KAAK;gBACjB,KAAK,EAAE,IAAI,aAAa,EAAE;aAC1B;SACD,CAAE,CAAC;QAEJ,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;QAExB,MAAM,CAAC,KAAK,CAAC;IACd,CAAC;IACF,cAAC;AAAD,CA7CA,AA6CC,IAAA;AAMA,eAAO,WANP;AAOC","file":"Persisted.js","sourcesContent":["import * as RDF from \"./RDF\";\nimport * as Utils from \"./Utils\";\n\nclass Modifications {\n\tadd:Map<string, RDF.Value.Class[]>;\n\tset:Map<string, RDF.Value.Class[]>;\n\tdelete:Map<string, RDF.Value.Class[]>;\n\n\tconstructor() {\n\t\tthis.add = new Map<string, RDF.Value.Class[]>();\n\t\tthis.set = new Map<string, RDF.Value.Class[]>();\n\t\tthis.delete = new Map<string, RDF.Value.Class[]>();\n\t}\n}\n\nenum ModificationType {\n\tADD,\n\tSET,\n\tDELETE\n}\n\ninterface Persisted {\n\t_dirty:boolean;\n\t_modifications:Modifications;\n\n\tisDirty():boolean;\n}\n\nfunction isDirty():boolean {\n\treturn this._dirty;\n}\n\nclass Factory {\n\tstatic is( object:Object ):boolean {\n\t\treturn (\n\t\t\tUtils.hasPropertyDefined( object, \"_dirty\" ) &&\n\t\t\tUtils.hasPropertyDefined( object, \"_modifications\" ) &&\n\t\t\tUtils.hasFunction( object, \"isDirty\" )\n\t\t);\n\t}\n\n\tstatic from( object:Object ):Persisted;\n\tstatic from( objects:Object[] ):Persisted[];\n\tstatic from( objectOrObjects:any ):any {\n\t\tlet objects:Object[] = Utils.isArray( objectOrObjects ) ? <Object[]>objectOrObjects : [ <Object>objectOrObjects ];\n\t\tlet values:Persisted[] = [];\n\n\t\tfor ( let i:number = 0, length:number = objects.length; i < length; i ++ ) {\n\t\t\tlet value:Persisted = <any>objects[ i ];\n\n\t\t\tif ( ! Factory.is( value ) ) Factory.injectBehavior( value );\n\n\t\t\tvalues.push( value );\n\t\t}\n\n\t\tif ( Utils.isArray( objectOrObjects ) ) return values;\n\t\treturn values[ 0 ];\n\t}\n\n\tprivate static injectBehavior( value:Persisted ):Persisted {\n\t\tObject.defineProperties( value, {\n\t\t\t\"_dirty\": {\n\t\t\t\twritable: true,\n\t\t\t\tenumerable: false,\n\t\t\t\tvalue: false,\n\t\t\t},\n\t\t\t\"_modifications\": {\n\t\t\t\twritable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\tvalue: new Modifications(),\n\t\t\t},\n\t\t} );\n\n\t\tvalue.isDirty = isDirty;\n\n\t\treturn value;\n\t}\n}\n\nexport {\n\tModifications,\n\tModificationType,\n\tPersisted as Class,\n\tFactory\n};\n"],"sourceRoot":"/source/"}